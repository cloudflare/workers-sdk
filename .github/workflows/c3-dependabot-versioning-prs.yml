name: "C3 - Generate changesets for dependabot PRs"
on:
  pull_request_target:
    branches:
      - main
      - master

jobs:
  generate-changeset:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 2
          ref: ${{ github.head_ref }}
      - name: Install Dependencies
        run: |
          npm install -g esbuild-register
          npm install -g typescript
      - name: Run PoC Script
        run: |
          node -r esbuild-register tools/dependabot/generate-dependabot-pr-changesets.ts ${{ github.event.number }}
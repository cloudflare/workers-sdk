{"version":3,"file":"ResizerWidget.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/ResizerWidget.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport {elementDragStart} from './UIUtils.js';\n\nexport class ResizerWidget extends Common.ObjectWrapper.ObjectWrapper<EventTypes> {\n  private isEnabledInternal: boolean;\n  private elementsInternal: Set<HTMLElement>;\n  private readonly installDragOnMouseDownBound: (event: Event) => false | undefined;\n  private cursorInternal: string;\n  private startX?: number;\n  private startY?: number;\n\n  constructor() {\n    super();\n\n    this.isEnabledInternal = true;\n    this.elementsInternal = new Set();\n    this.installDragOnMouseDownBound = this.installDragOnMouseDown.bind(this);\n    this.cursorInternal = 'nwse-resize';\n  }\n\n  isEnabled(): boolean {\n    return this.isEnabledInternal;\n  }\n\n  setEnabled(enabled: boolean): void {\n    this.isEnabledInternal = enabled;\n    this.updateElementCursors();\n  }\n\n  elements(): Element[] {\n    return [...this.elementsInternal];\n  }\n\n  addElement(element: HTMLElement): void {\n    if (!this.elementsInternal.has(element)) {\n      this.elementsInternal.add(element);\n      element.addEventListener('pointerdown', this.installDragOnMouseDownBound, false);\n      this.updateElementCursor(element);\n    }\n  }\n\n  removeElement(element: HTMLElement): void {\n    if (this.elementsInternal.has(element)) {\n      this.elementsInternal.delete(element);\n      element.removeEventListener('pointerdown', this.installDragOnMouseDownBound, false);\n      element.style.removeProperty('cursor');\n    }\n  }\n\n  updateElementCursors(): void {\n    this.elementsInternal.forEach(this.updateElementCursor.bind(this));\n  }\n\n  private updateElementCursor(element: HTMLElement): void {\n    if (this.isEnabledInternal) {\n      element.style.setProperty('cursor', this.cursor());\n      element.style.setProperty('touch-action', 'none');\n    } else {\n      element.style.removeProperty('cursor');\n      element.style.removeProperty('touch-action');\n    }\n  }\n\n  cursor(): string {\n    return this.cursorInternal;\n  }\n\n  setCursor(cursor: string): void {\n    this.cursorInternal = cursor;\n    this.updateElementCursors();\n  }\n\n  private installDragOnMouseDown(event: Event): false|undefined {\n    const element = (event.target as HTMLElement);\n    // Only handle drags of the nodes specified.\n    if (!this.elementsInternal.has(element)) {\n      return false;\n    }\n    elementDragStart(element, this.dragStart.bind(this), event => {\n      this.drag(event);\n    }, this.dragEnd.bind(this), this.cursor(), event);\n    return undefined;\n  }\n\n  private dragStart(event: MouseEvent): boolean {\n    if (!this.isEnabledInternal) {\n      return false;\n    }\n    this.startX = event.pageX;\n    this.startY = event.pageY;\n    this.sendDragStart(this.startX, this.startY);\n    return true;\n  }\n\n  sendDragStart(x: number, y: number): void {\n    this.dispatchEventToListeners(Events.ResizeStart, {startX: x, currentX: x, startY: y, currentY: y});\n  }\n\n  private drag(event: MouseEvent): boolean {\n    if (!this.isEnabledInternal) {\n      this.dragEnd(event);\n      return true;  // Cancel drag.\n    }\n    this.sendDragMove((this.startX as number), event.pageX, (this.startY as number), event.pageY, event.shiftKey);\n    event.preventDefault();\n    return false;  // Continue drag.\n  }\n\n  sendDragMove(startX: number, currentX: number, startY: number, currentY: number, shiftKey: boolean): void {\n    this.dispatchEventToListeners(\n        Events.ResizeUpdateXY,\n        {startX: startX, currentX: currentX, startY: startY, currentY: currentY, shiftKey: shiftKey});\n  }\n\n  private dragEnd(_event: MouseEvent): void {\n    this.dispatchEventToListeners(Events.ResizeEnd);\n    delete this.startX;\n    delete this.startY;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  ResizeStart = 'ResizeStart',\n  ResizeUpdateXY = 'ResizeUpdateXY',\n  ResizeUpdatePosition = 'ResizeUpdatePosition',\n  ResizeEnd = 'ResizeEnd',\n}\n\nexport interface ResizeStartXYEvent {\n  startX: number;\n  currentX: number;\n  startY: number;\n  currentY: number;\n}\n\nexport interface ResizeStartPositionEvent {\n  startPosition: number;\n  currentPosition: number;\n}\n\nexport interface ResizeUpdateXYEvent {\n  startX: number;\n  currentX: number;\n  startY: number;\n  currentY: number;\n  shiftKey: boolean;\n}\n\nexport interface ResizeUpdatePositionEvent {\n  startPosition: number;\n  currentPosition: number;\n  shiftKey: boolean;\n}\n\nexport type EventTypes = {\n  [Events.ResizeStart]: ResizeStartXYEvent|ResizeStartPositionEvent,\n  [Events.ResizeUpdateXY]: ResizeUpdateXYEvent,\n  [Events.ResizeUpdatePosition]: ResizeUpdatePositionEvent,\n  [Events.ResizeEnd]: void,\n};\n\nexport class SimpleResizerWidget extends ResizerWidget {\n  private isVerticalInternal: boolean;\n  constructor() {\n    super();\n    this.isVerticalInternal = true;\n  }\n\n  isVertical(): boolean {\n    return this.isVerticalInternal;\n  }\n\n  /**\n   * Vertical widget resizes height (along y-axis).\n   */\n  setVertical(vertical: boolean): void {\n    this.isVerticalInternal = vertical;\n    this.updateElementCursors();\n  }\n\n  cursor(): string {\n    return this.isVerticalInternal ? 'ns-resize' : 'ew-resize';\n  }\n\n  sendDragStart(x: number, y: number): void {\n    const position = this.isVerticalInternal ? y : x;\n    this.dispatchEventToListeners(Events.ResizeStart, {startPosition: position, currentPosition: position});\n  }\n\n  sendDragMove(startX: number, currentX: number, startY: number, currentY: number, shiftKey: boolean): void {\n    if (this.isVerticalInternal) {\n      this.dispatchEventToListeners(\n          Events.ResizeUpdatePosition, {startPosition: startY, currentPosition: currentY, shiftKey: shiftKey});\n    } else {\n      this.dispatchEventToListeners(\n          Events.ResizeUpdatePosition, {startPosition: startX, currentPosition: currentX, shiftKey: shiftKey});\n    }\n  }\n}\n"]}
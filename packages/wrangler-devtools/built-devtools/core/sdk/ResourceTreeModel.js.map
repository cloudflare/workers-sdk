{"version":3,"file":"ResourceTreeModel.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/ResourceTreeModel.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA4BG;AAEH,OAAO,KAAK,MAAM,MAAM,qBAAqB,CAAC;AAC9C,OAAO,KAAK,IAAI,MAAM,iBAAiB,CAAC;AACxC,OAAO,KAAK,QAAQ,MAAM,yBAAyB,CAAC;AAKpD,OAAO,EAAC,QAAQ,EAAC,MAAM,eAAe,CAAC;AAEvC,OAAO,EAAC,MAAM,IAAI,oBAAoB,EAAE,cAAc,EAAC,MAAM,qBAAqB,CAAC;AAEnF,OAAO,EAAC,QAAQ,EAAC,MAAM,eAAe,CAAC;AACvC,OAAO,EAAC,gBAAgB,EAAE,YAAY,EAAC,MAAM,mBAAmB,CAAC;AAEjE,OAAO,EAAC,UAAU,EAAC,MAAM,aAAa,CAAC;AACvC,OAAO,EAAC,QAAQ,EAAC,MAAM,eAAe,CAAC;AACvC,OAAO,EAAC,aAAa,EAAC,MAAM,oBAAoB,CAAC;AACjD,OAAO,EAAC,qBAAqB,EAAC,MAAM,4BAA4B,CAAC;AACjE,OAAO,EAAC,iBAAiB,EAAC,MAAM,wBAAwB,CAAC;AAEzD,MAAM,OAAO,iBAAkB,SAAQ,QAAoB;IAChD,KAAK,CAA2B;IAChC,YAAY,CAA8B;IAC1C,sBAAsB,CAAwB;IAC9C,kBAAkB,CAAoB;IACtC,cAAc,CAAiC;IACxD,yBAAyB,CAAU;IACnC,qBAAqB,CAGd;IACP,sBAAsB,CAAS;IAC/B,qBAAqB,CAAU;IAC/B,SAAS,CAAyB;IAClC,qCAAqC,CAAkD;IACvF,uCAAuC,CAAoD;IAE3F,YAAY,MAAc;QACxB,KAAK,CAAC,MAAM,CAAC,CAAC;QAEd,MAAM,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QACpD,IAAI,cAAc,EAAE;YAClB,cAAc,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,eAAe,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;YACpG,cAAc,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,oBAAoB,EAAE,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,CAAC;SAC/G;QACD,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;QAChC,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;QAC1C,KAAK,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;QAChC,IAAI,CAAC,sBAAsB,GAAI,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAA2B,CAAC;QAC7F,IAAI,CAAC,kBAAkB,GAAI,MAAM,CAAC,KAAK,CAAC,iBAAiB,CAAuB,CAAC;QACjF,IAAI,CAAC,qCAAqC,GAAG,IAAI,GAAG,EAA8C,CAAC;QACnG,IAAI,CAAC,uCAAuC,GAAG,IAAI,GAAG,EAAgD,CAAC;QACvG,MAAM,CAAC,sBAAsB,CAAC,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;QAExD,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;QAChC,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;QACvC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,sBAAsB,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;QACnC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QAEtB,KAAK,IAAI,CAAC,KAAK,CAAC,sBAAsB,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;YACpD,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;IACL,CAAC;IAED,MAAM,CAAC,eAAe,CAAC,OAAuB;QAC5C,MAAM,cAAc,GAAG,cAAc,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAC1D,MAAM,iBAAiB,GAAG,cAAc,CAAC,CAAC,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACnG,IAAI,CAAC,iBAAiB,EAAE;YACtB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,iBAAiB,CAAC,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IAChF,CAAC;IAED,MAAM,CAAC,MAAM;QACX,MAAM,MAAM,GAAG,EAAE,CAAC;QAClB,KAAK,MAAM,iBAAiB,IAAI,aAAa,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE;YAClF,MAAM,CAAC,IAAI,CAAC,GAAG,iBAAiB,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,CAAC;SAC3D;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,MAAM,CAAC,cAAc,CAAC,GAAoC;QACxD,KAAK,MAAM,iBAAiB,IAAI,aAAa,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE;YAClF,MAAM,SAAS,GAAG,iBAAiB,CAAC,SAAS,CAAC;YAC9C,MAAM,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAChE,IAAI,MAAM,EAAE;gBACV,OAAO,MAAM,CAAC;aACf;SACF;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,MAAM,CAAC,cAAc,CAAC,WAAqB,EAAE,sBAA+B;QAC1E,KAAK,MAAM,iBAAiB,IAAI,aAAa,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE;YAClF,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,YAAY,EAAE,EAAE;gBAC9C,iBAAiB,CAAC,UAAU,CAAC,WAAW,EAAE,sBAAsB,CAAC,CAAC;aACnE;SACF;IACH,CAAC;IAED,KAAK,CAAC,kBAAkB,CAAC,OAA8B;QACrD,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,4BAA4B,CAAC,EAAC,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;QAC1F,IAAI,QAAQ,CAAC,QAAQ,EAAE,KAAK,2CAA2C,EAAE;YACvE,OAAO,IAAI,CAAC;SACb;QACD,OAAO,QAAQ,CAAC,UAAU,CAAC;IAC7B,CAAC;IAED,QAAQ;QACN,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAa,CAAC;IACnD,CAAC;IAEO,sBAAsB,CAAC,gBAAsD;QACnF,gEAAgE;QAChE,oEAAoE;QACpE,oEAAoE;QACpE,6CAA6C;QAC7C,6CAA6C;QAC7C,IAAI,gBAAgB,IAAI,gBAAgB,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,EAAE;YAC1D,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;YAC9D,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;YAClD,IAAI,CAAC,MAAM,EAAE,CAAC,eAAe,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAsC,CAAC,CAAC;SAC9F;QACD,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QACtC,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;QACvD,IAAI,YAAY,EAAE;YAChB,YAAY,CAAC,6BAA6B,CAAC,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACvF,YAAY,CAAC,gCAAgC,EAAE,CAAC;SACjD;QACD,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;IACpE,CAAC;IAED,qBAAqB;QACnB,OAAO,IAAI,CAAC,yBAAyB,CAAC;IACxC,CAAC;IAEO,QAAQ,CAAC,KAAwB,EAAE,gBAA0B;QACnE,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;QACzC,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE;YACvB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;QACD,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;QACxD,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,KAAK,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAChC,CAAC;IAED,aAAa,CACT,OAA8B,EAAE,aAAyC,EACzE,UAAwC,EAAE,UAAqC;QACjF,MAAM,qBAAqB,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACtG,sFAAsF;QACtF,IAAI,CAAC,IAAI,CAAC,yBAAyB,IAAI,qBAAqB,EAAE;YAC5D,OAAO,IAAI,CAAC;SACb;QACD,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;YACpC,OAAO,IAAI,CAAC;SACb;QAED,MAAM,KAAK,GACP,IAAI,iBAAiB,CAAC,IAAI,EAAE,qBAAqB,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,IAAI,IAAI,EAAE,UAAU,IAAI,IAAI,CAAC,CAAC;QAC9G,IAAI,aAAa,IAAI,CAAC,qBAAqB,EAAE;YAC3C,KAAK,CAAC,wBAAwB,GAAG,aAAa,CAAC;SAChD;QACD,IAAI,KAAK,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,SAAS,EAAE;YACzC,yCAAyC;YACzC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;SAC9C;QACD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAC3B,OAAO,KAAK,CAAC;IACf,CAAC;IAED,cAAc,CAAC,YAAiC,EAAE,IAA4C;QAC5F,MAAM,qBAAqB,GACvB,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC5F,sFAAsF;QACtF,IAAI,CAAC,IAAI,CAAC,yBAAyB,IAAI,qBAAqB,EAAE;YAC5D,OAAO;SACR;QACD,IAAI,KAAK,GAA6B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC;QACvF,IAAI,CAAC,KAAK,EAAE;YACV,0FAA0F;YAC1F,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,EAAE,YAAY,CAAC,QAAQ,IAAI,IAAI,CAAC,CAAC;YAC3E,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;YAC/B,IAAI,CAAC,KAAK,EAAE;gBACV,OAAO;aACR;SACF;QAED,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC;QAC/D,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC7B,IAAI,IAAI,EAAE;YACR,KAAK,CAAC,uBAAuB,CAAC,iBAAiB,GAAG,IAAI,4DAAyD,CAAC;SACjH;QACD,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;QAE5D,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE;YACvB,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;YACjC,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;YAChE,MAAM,cAAc,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;YAC3D,IAAI,cAAc,EAAE;gBAClB,cAAc,CAAC,aAAa,EAAE,CAAC;aAChC;SACF;QAED,yEAAyE;QACzE,MAAM,SAAS,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC;QACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACzC,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SACnE;QAED,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE;YACvB,IAAI,CAAC,MAAM,EAAE,CAAC,eAAe,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SAC1C;QACD,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,KAAK,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAChC,CAAC;IAED,cAAc,CAAC,YAAiC;QAC9C,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;QAC7C,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;QACvD,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;YAC3D,MAAM,aAAa,GAAG,IAAI,CAAC,8BAA8B,CACrD,YAAY,EAAE,YAAY,CAAC,GAAsC,EAAE,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,QAAQ,EAC7G,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;YACvC,aAAa,CAAC,WAAW,GAAG,IAAI,CAAC;YACjC,KAAK,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;SAClC;IACH,CAAC;IAED,aAAa,CAAC,OAA8B,EAAE,MAAe;QAC3D,sFAAsF;QACtF,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;YACnC,OAAO;SACR;QAED,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC/C,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,MAAM,qBAAqB,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC5D,IAAI,qBAAqB,EAAE;YACzB,qBAAqB,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;SACvD;aAAM;YACL,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACtB;QACD,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,KAAK,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAChC,CAAC;IAEO,iBAAiB,CAAC,KAA0D;QAClF,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;YACnC,OAAO;SACR;QAED,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC;QAC3B,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,YAAY,EAAE,KAAK,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,GAAG,EAAE;YACtF,OAAO;SACR;QAED,MAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAChF,IAAI,KAAK,EAAE;YACT,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SAC3B;IACH,CAAC;IAEO,sBAAsB,CAAC,KAAyE;QACtG,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;YACnC,OAAO;SACR;QAED,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;QACxB,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO;SACR;QACD,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC/C,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QACrB,IAAI,KAAK,CAAC,eAAe,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YACpC,OAAO;SACR;QAED,MAAM,QAAQ,GAAG,IAAI,QAAQ,CACzB,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,EACxG,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QAC5C,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IAC9B,CAAC;IAED,UAAU,CAAC,OAA8B;QACvC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;IAClD,CAAC;IAED,eAAe,CAAC,QAAqC;QACnD,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,OAAO,IAAI,CAAC,SAAS,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;SACvD;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM;QACJ,OAAO,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,CAAC;IAC3C,CAAC;IAED,cAAc,CAAC,GAAoC;QACjD,oDAAoD;QACpD,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IACpE,CAAC;IAEO,oBAAoB,CACxB,qBAA6C,EAAE,gBAAiD;QAClG,MAAM,YAAY,GAAG,gBAAgB,CAAC,KAAK,CAAC;QAC5C,MAAM,KAAK,GAAG,IAAI,iBAAiB,CAAC,IAAI,EAAE,qBAAqB,EAAE,YAAY,CAAC,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAC5G,IAAI,CAAC,qBAAqB,IAAI,YAAY,CAAC,QAAQ,EAAE;YACnD,KAAK,CAAC,wBAAwB,GAAG,YAAY,CAAC,QAAQ,CAAC;SACxD;QACD,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAErB,KAAK,MAAM,UAAU,IAAI,gBAAgB,CAAC,WAAW,IAAI,EAAE,EAAE;YAC3D,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;SAC9C;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YAC1D,MAAM,WAAW,GAAG,gBAAgB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAClD,MAAM,QAAQ,GAAG,IAAI,CAAC,8BAA8B,CAChD,YAAY,EAAE,WAAW,CAAC,GAAsC,EAChE,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,WAAW,CAAC,QAAQ,EAAE,WAAW,CAAC,YAAY,IAAI,IAAI,EAC3G,WAAW,CAAC,WAAW,IAAI,IAAI,CAAC,CAAC;YACrC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;SAC7B;QAED,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;YAClD,MAAM,aAAa,GAAG,IAAI,CAAC,8BAA8B,CACrD,YAAY,EAAE,YAAY,CAAC,GAAsC,EAAE,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,QAAQ,EAC7G,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;YACvC,KAAK,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;SAClC;IACH,CAAC;IAEO,8BAA8B,CAClC,KAA0B,EAAE,GAAoC,EAAE,IAAsC,EACxG,QAAgB,EAAE,gBAA6B,EAAE,WAAwB;QAC3E,MAAM,YAAY,GAAG,OAAO,gBAAgB,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACrG,OAAO,IAAI,QAAQ,CACf,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,GAAsC,EAAE,KAAK,CAAC,EAAE,EAAE,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAE,QAAQ,EACvG,YAAY,EAAE,WAAW,CAAC,CAAC;IACjC,CAAC;IAED,aAAa;QACX,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAChC,CAAC;IAED,YAAY;QACV,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAC9B,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,sBAAsB,IAAI,CAAC,EAAE,qDAAqD,CAAC,CAAC;QACxG,IAAI,CAAC,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,qBAAqB,EAAE;YAC9D,MAAM,EAAC,WAAW,EAAE,sBAAsB,EAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC;YACzE,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,sBAAsB,CAAC,CAAC;SACtD;IACH,CAAC;IAED,UAAU,CAAC,WAAqB,EAAE,sBAA+B;QAC/D,wFAAwF;QACxF,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;YAC/B,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;SACjE;QACD,IAAI,IAAI,CAAC,sBAAsB,EAAE;YAC/B,IAAI,CAAC,qBAAqB,GAAG,EAAC,WAAW,EAAE,sBAAsB,EAAC,CAAC;YACnE,OAAO;SACR;QACD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,MAAM,cAAc,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QAC3D,IAAI,cAAc,EAAE;YAClB,cAAc,CAAC,aAAa,EAAE,CAAC;SAChC;QACD,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;QACrD,KAAK,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,EAAC,WAAW,EAAE,sBAAsB,EAAC,CAAC,CAAC;IACvE,CAAC;IAED,mEAAmE;IACnE,8DAA8D;IAC9D,QAAQ,CAAC,GAAoC;QAC3C,OAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EAAC,GAAG,EAAC,CAAC,CAAC;IAC3C,CAAC;IAED,KAAK,CAAC,iBAAiB;QAIrB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,2BAA2B,EAAE,CAAC;QAChE,IAAI,QAAQ,CAAC,QAAQ,EAAE,EAAE;YACvB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,EAAC,YAAY,EAAE,QAAQ,CAAC,YAAY,EAAE,OAAO,EAAE,QAAQ,CAAC,OAAO,EAAC,CAAC;IAC1E,CAAC;IAED,sBAAsB,CAAC,KAAoC;QACzD,KAAK,IAAI,CAAC,KAAK,CAAC,6BAA6B,CAAC,EAAC,OAAO,EAAE,KAAK,CAAC,EAAE,EAAC,CAAC,CAAC;IACrE,CAAC;IAED,yBAAyB,CAAC,OAAgB;QACxC,OAAO,IAAI,CAAC,KAAK,CAAC,gCAAgC,CAAC,EAAC,OAAO,EAAC,CAAC,CAAC;IAChE,CAAC;IAED,KAAK,CAAC,gBAAgB;QAKpB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC1D,IAAI,QAAQ,CAAC,QAAQ,EAAE,EAAE;YACvB,OAAO,EAAC,GAAG,EAAE,QAAQ,CAAC,GAAsC,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAC,CAAC;SACvF;QACD,OAAO,EAAC,GAAG,EAAE,QAAQ,CAAC,GAAsC,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,IAAI,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,MAAM,EAAC,CAAC;IACtH,CAAC;IAED,KAAK,CAAC,uBAAuB;QAC3B,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,8BAA8B,EAAE,CAAC;QACnE,OAAO,QAAQ,CAAC,oBAAoB,IAAI,EAAE,CAAC;IAC7C,CAAC;IAED,KAAK,CAAC,gBAAgB;QAGpB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,uBAAuB,EAAE,CAAC;QAC5D,OAAO,EAAC,WAAW,EAAE,QAAQ,CAAC,WAAW,IAAI,IAAI,EAAC,CAAC;IACrD,CAAC;IAED,KAAK,CAAC,QAAQ;QACZ,OAAO,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC;IACtC,CAAC;IAEO,0BAA0B,CAAC,CAAmB,EAAE,CAAmB;QACzE,SAAS,SAAS,CAAC,KAA6B;YAC9C,IAAI,YAAY,GAA6B,KAAK,CAAC;YACnD,MAAM,OAAO,GAAG,EAAE,CAAC;YACnB,OAAO,YAAY,EAAE;gBACnB,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBAC3B,YAAY,GAAG,YAAY,CAAC,qBAAqB,EAAE,CAAC;aACrD;YACD,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;QAC3B,CAAC;QAED,IAAI,CAAC,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,MAAM,EAAE,EAAE;YAC7B,OAAO,gBAAgB,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAC1C;QAED,MAAM,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QACvE,MAAM,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QACvE,IAAI,MAAM,CAAC;QACX,IAAI,MAAM,CAAC;QACX,KAAK,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE;YACpB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE;gBAC7D,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;gBACpB,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;gBACpB,MAAM;aACP;SACF;QACD,IAAI,CAAC,MAAM,IAAI,MAAM,EAAE;YACrB,OAAO,CAAC,CAAC,CAAC;SACX;QAED,IAAI,CAAC,MAAM,IAAI,MAAM,EAAE;YACrB,OAAO,CAAC,CAAC;SACV;QAED,IAAI,MAAM,IAAI,MAAM,EAAE;YACpB,OAAO,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC3C;QAED,OAAO,gBAAgB,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC;IAEO,qBAAqB;QAC3B,MAAM,eAAe,GAAG,IAAI,GAAG,EAAU,CAAC;QAE1C,IAAI,kBAAkB,GAAgB,IAAI,CAAC;QAC3C,IAAI,6BAA6B,GAAgB,IAAI,CAAC;QACtD,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,EAAE;YAChD,MAAM,MAAM,GAAG,KAAK,CAAC,cAAc,CAAC;YACpC,IAAI,CAAC,MAAM,EAAE;gBACX,SAAS;aACV;YAED,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC5B,IAAI,KAAK,CAAC,WAAW,EAAE,EAAE;gBACvB,kBAAkB,GAAG,MAAM,CAAC;gBAC5B,IAAI,KAAK,CAAC,cAAc,EAAE,EAAE;oBAC1B,MAAM,iBAAiB,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC;oBACjF,6BAA6B,GAAG,iBAAiB,CAAC,cAAc,EAAE,CAAC;iBACpE;aACF;SACF;QACD,OAAO;YACL,eAAe,EAAE,eAAe;YAChC,kBAAkB,EAAE,kBAAkB;YACtC,6BAA6B,EAAE,6BAA6B;SAC7D,CAAC;IACJ,CAAC;IAEO,KAAK,CAAC,iBAAiB;QAC7B,MAAM,WAAW,GAAG,IAAI,GAAG,EAAU,CAAC;QACtC,IAAI,cAAc,GAAgB,IAAI,CAAC;QAEvC,KAAK,MAAM,EAAC,WAAW,EAAE,UAAU,EAAC,IAAI,MAAM,OAAO,CAAC,GAAG,CAChD,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,EAAC,CAAC,EAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YACJ,WAAW,EAAE,CAAC,CAAC,WAAW,EAAE;YAC5B,UAAU,EAAE,CAAC;SACd,CAAC,CAAC,CAAC,CAAC,EAAE;YACjF,IAAI,WAAW,EAAE;gBACf,cAAc,GAAG,UAAU,CAAC;aAC7B;YACD,IAAI,UAAU,EAAE;gBACd,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aAC7B;SACF;QAED,OAAO,EAAC,WAAW,EAAE,WAAW,EAAE,cAAc,EAAE,cAAc,EAAC,CAAC;IACpE,CAAC;IAEO,qBAAqB;QAC3B,MAAM,IAAI,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC1C,IAAI,CAAC,sBAAsB,CAAC,qBAAqB,CAC7C,IAAI,CAAC,kBAAkB,IAAI,EAAE,EAAE,IAAI,CAAC,6BAA6B,IAAI,EAAE,CAAC,CAAC;QAC7E,IAAI,CAAC,sBAAsB,CAAC,qBAAqB,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;IAC1E,CAAC;IAEO,KAAK,CAAC,iBAAiB;QAC7B,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC5C,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,IAAI,CAAC,cAAc,IAAI,EAAE,CAAC,CAAC;QACrE,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC9D,CAAC;IAED,KAAK,CAAC,iBAAiB;QACrB,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC;IAC3D,CAAC;IAED,qBAAqB;QACnB,MAAM,IAAI,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC1C,OAAO,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,6BAA6B,CAAC;IACvE,CAAC;IAED,yBAAyB,CAAC,KAAiD;QACzE,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,KAAK,CAAC,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,KAAK,KAAK,CAAC,QAAQ,EAAE;YACvG,IAAI,CAAC,SAAS,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;YACjD,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,8BAA8B,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;SACtF;aAAM;YACL,IAAI,CAAC,qCAAqC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SACvD;IACH,CAAC;IAED,2BAA2B,CAAC,KAAmD;QAC7E,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,KAAK,CAAC,iBAAiB,EAAE;YACnE,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;YAC1D,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,yBAAyB,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;SACjF;aAAM;YACL,IAAI,CAAC,uCAAuC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SACzD;IACH,CAAC;IAED,oBAAoB,CAAC,KAAwB;QAC3C,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE;YACxB,OAAO;SACR;QACD,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,qCAAqC,EAAE;YAC9D,IAAI,KAAK,CAAC,EAAE,KAAK,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,QAAQ,KAAK,KAAK,CAAC,QAAQ,EAAE;gBACnE,KAAK,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;gBACxC,IAAI,CAAC,qCAAqC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACzD,MAAM;aACP;SACF;QACD,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,uCAAuC,EAAE;YAChE,IAAI,KAAK,CAAC,EAAE,KAAK,KAAK,CAAC,iBAAiB,EAAE;gBACxC,KAAK,CAAC,uBAAuB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;gBACjD,IAAI,CAAC,uCAAuC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBAC3D,MAAM;aACP;SACF;QACD,mGAAmG;IACrG,CAAC;CACF;AAED,wDAAwD;AACxD,+CAA+C;AAC/C,MAAM,CAAN,IAAY,MAmBX;AAnBD,WAAY,MAAM;IAChB,mCAAyB,CAAA;IACzB,2CAAiC,CAAA;IACjC,yCAA+B,CAAA;IAC/B,uCAA6B,CAAA;IAC7B,iDAAuC,CAAA;IACvC,mDAAyC,CAAA;IACzC,yCAA+B,CAAA;IAC/B,6DAAmD,CAAA;IACnD,yDAA+C,CAAA;IAC/C,+CAAqC,CAAA;IACrC,2CAAiC,CAAA;IACjC,uBAAa,CAAA;IACb,qDAA2C,CAAA;IAC3C,2CAAiC,CAAA;IACjC,iDAAuC,CAAA;IACvC,mDAAyC,CAAA;IACzC,2EAAiE,CAAA;IACjE,iEAAuD,CAAA;AACzD,CAAC,EAnBW,MAAM,KAAN,MAAM,QAmBjB;AAuBD,MAAM,OAAO,iBAAiB;IAC5B,MAAM,CAAoB;IAC1B,8BAA8B,CAAyB;IAC9C,WAAW,CAAwB;IAC5C,wBAAwB,CAAc;IACtC,iBAAiB,CAAS;IAC1B,aAAa,CAAwB;IACrC,YAAY,CAAkC;IAC9C,0BAA0B,CAAS;IACnC,uBAAuB,CAAc;IACrC,mBAAmB,CAAwB;IAC3C,uBAAuB,CAAkC;IACzD,sBAAsB,CAA+B;IACrD,kBAAkB,CAAuC;IACzD,+BAA+B,CAAoD;IACnF,iBAAiB,CAAwC;IACzD,mBAAmB,CAAmC;IACtD,yBAAyB,CAAc;IACvC,oBAAoB,CAAyB;IAC7C,WAAW,CAAiC;IAC5C,WAAW,CAAyC;IACpD,YAAY,CAAiD;IAC7D,uBAAuB,GAInB;QACF,iBAAiB,EAAE,SAAS;QAC5B,YAAY,EAAE,EAAE;QAChB,gBAAgB,EAAE,SAAS;KAC5B,CAAC;IACF,oBAAoB,CAA0C;IAE9D,YACI,KAAwB,EAAE,WAAmC,EAAE,OAA8B,EAC7F,OAAiC,EAAE,kBAAoD,EACvF,UAAyC;QAC3C,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,8BAA8B,GAAG,WAAW,CAAC;QAClD,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC;QAC3B,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;QAErC,IAAI,CAAC,iBAAiB,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QAC7D,IAAI,CAAC,aAAa,GAAG,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC;QAC7C,IAAI,CAAC,YAAY;YACb,OAAO,IAAI,OAAO,CAAC,GAAsC,IAAI,QAAQ,CAAC,YAAY,CAAC,cAAc,CAAC;QACtG,IAAI,CAAC,0BAA0B,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;QAC/E,IAAI,CAAC,uBAAuB,GAAG,OAAO,IAAI,OAAO,CAAC,cAAc,CAAC;QACjE,IAAI,CAAC,uBAAuB;YACxB,CAAC,OAAO,IAAI,OAAO,CAAC,cAAiD,CAAC,IAAI,QAAQ,CAAC,YAAY,CAAC,cAAc,CAAC;QACnH,IAAI,CAAC,sBAAsB,GAAG,OAAO,EAAE,aAAa,CAAC;QACrD,IAAI,CAAC,kBAAkB,GAAG,OAAO,IAAI,OAAO,CAAC,iBAAiB,CAAC;QAC/D,IAAI,CAAC,+BAA+B,GAAG,OAAO,IAAI,OAAO,CAAC,8BAA8B,CAAC;QACzF,IAAI,CAAC,iBAAiB,GAAG,OAAO,IAAI,OAAO,CAAC,gBAAgB,CAAC;QAE7D,IAAI,CAAC,mBAAmB,GAAG,kBAAkB,CAAC;QAC9C,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,WAAW,GAAG,UAAU,EAAE,QAAQ,IAAI,IAAI,CAAC;QAChD,IAAI,CAAC,WAAW,GAAG,UAAU,EAAE,UAAU,IAAI,IAAI,CAAC;QAElD,IAAI,CAAC,oBAAoB,GAAG,IAAI,GAAG,EAAE,CAAC;QAEtC,IAAI,CAAC,YAAY,GAAG,IAAI,GAAG,EAAE,CAAC;QAC9B,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QAEjC,IAAI,IAAI,CAAC,8BAA8B,EAAE;YACvC,IAAI,CAAC,8BAA8B,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SACpE;IACH,CAAC;IAED,eAAe;QACb,OAAO,IAAI,CAAC,kBAAkB,KAAK,IAAI,IAAI,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;IAC1F,CAAC;IAED,oBAAoB;QAClB,OAAO,IAAI,CAAC,kBAAkB,CAAC;IACjC,CAAC;IAED,qBAAqB;QACnB,OAAO,IAAI,CAAC,+BAA+B,KAAK,IAAI,IAAI,IAAI,CAAC,+BAA+B,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;IACtH,CAAC;IAED,iCAAiC;QAC/B,OAAO,IAAI,CAAC,+BAA+B,CAAC;IAC9C,CAAC;IAED,mBAAmB;QACjB,OAAO,IAAI,CAAC,iBAAiB,CAAC;IAChC,CAAC;IAED,yBAAyB;QAEvB,OAAO;YACL,kBAAkB,EAAE,IAAI,CAAC,mBAAmB;YAC5C,wBAAwB,EAAE,IAAI,CAAC,yBAAyB,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC,MAAM,EAAE;SAC9F,CAAC;IACJ,CAAC;IAED,QAAQ,CAAC,YAAiC;QACxC,IAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC,QAAQ,CAAC;QAC/C,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC,IAAI,CAAC;QACvC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC,GAAsC,CAAC;QACxE,IAAI,CAAC,0BAA0B,GAAG,YAAY,CAAC,iBAAiB,CAAC;QACjE,IAAI,CAAC,uBAAuB,GAAG,YAAY,CAAC,cAAc,CAAC;QAC3D,IAAI,CAAC,uBAAuB;YACxB,YAAY,CAAC,cAAiD,IAAI,QAAQ,CAAC,YAAY,CAAC,cAAc,CAAC;QAC3G,IAAI,CAAC,sBAAsB,GAAG,YAAY,EAAE,aAAa,CAAC;QAC1D,IAAI,CAAC,kBAAkB,GAAG,YAAY,CAAC,iBAAiB,CAAC;QACzD,IAAI,CAAC,+BAA+B,GAAG,YAAY,CAAC,8BAA8B,CAAC;QACnF,IAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC,gBAAgB,CAAC;QACvD,IAAI,CAAC,uBAAuB,GAAG;YAC7B,iBAAiB,EAAE,SAAS;YAC5B,YAAY,EAAE,EAAE;YAChB,gBAAgB,EAAE,SAAS;SAC5B,CAAC;QAEF,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAC9D,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;QAC1B,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,YAAY,IAAI,YAAY,CAAC,QAAQ,KAAK,IAAI,CAAC,iBAAiB,EAAE;YACpE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;SAChC;IACH,CAAC;IAED,iBAAiB;QACf,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,IAAI,EAAE;QACJ,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,aAAa,IAAI,EAAE,CAAC;IAClC,CAAC;IAED,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED,iBAAiB;QACf,OAAO,IAAI,CAAC,0BAA0B,CAAC;IACzC,CAAC;IAED,aAAa;QACX,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,aAAa,CAAC,UAA0C;QACtD,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;IAChC,CAAC;IAED,aAAa;QACX,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,aAAa,CAAC,UAAkD;QAC9D,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;IAChC,CAAC;IAED,IAAI,cAAc;QAChB,OAAO,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED,IAAI,UAAU;QACZ,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;YAC7B,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SAC7E;QACD,OAAO,IAAI,CAAC,mBAAmB,CAAC;IAClC,CAAC;IAED,cAAc;QACZ,OAAO,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,iBAAiB,CAAC;IAChC,CAAC;IAED,WAAW;QACT,OAAO,IAAI,CAAC,sBAAsB,EAAE,WAAW,qBAAkC,CAAC;IACpF,CAAC;IAED,aAAa;QACX,OAAO,IAAI,CAAC,sBAAsB,CAAC;IACrC,CAAC;IAED,IAAI,WAAW;QACb,OAAO,CAAC,GAAG,IAAI,CAAC,oBAAoB,CAAC,CAAC;IACxC,CAAC;IAED;;OAEG;IACH,qBAAqB;QACnB,OAAO,IAAI,CAAC,8BAA8B,CAAC;IAC7C,CAAC;IAED;;OAEG;IACH,sBAAsB;QACpB,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE;YAClC,OAAO,IAAI,CAAC;SACb;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,YAAY,EAAE,CAAC;QACzD,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO,IAAI,CAAC;SACb;QACD,MAAM,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;QAC1D,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,IAAI,CAAC;SACb;QACD,kEAAkE;QAClE,oEAAoE;QACpE,iDAAiD;QACjD,6DAA6D;QAC7D,yDAAyD;QACzD,gEAAgE;QAChE,OAAO,WAAW,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,wBAAwB,CAAC,IAAI,IAAI,CAAC;IAC/E,CAAC;IAED;;;OAGG;IACH,WAAW;QACT,OAAO,IAAI,CAAC,qBAAqB,EAAE,IAAI,IAAI,CAAC,sBAAsB,EAAE,CAAC;IACvE,CAAC;IAED;;;OAGG;IACH,WAAW;QACT,OAAO,CAAC,IAAI,CAAC,8BAA8B,CAAC;IAC9C,CAAC;IAED;;;OAGG;IACH,UAAU;QACR,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,8BAA8B;YAC/E,CAAC,IAAI,CAAC,wBAAwB,CAAC;IACrC,CAAC;IAED,gBAAgB,CAAC,KAAwB,EAAE,MAAe;QACxD,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACxC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACvB,CAAC;IAEO,iBAAiB;QACvB,MAAM,MAAM,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACzC,IAAI,CAAC,oBAAoB,GAAG,IAAI,GAAG,EAAE,CAAC;QACtC,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;YAC1B,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SACrB;IACH,CAAC;IAED,MAAM,CAAC,MAAe;QACpB,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC3C,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,aAAa,EAAE,EAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAC,CAAC,CAAC;IACpF,CAAC;IAED,WAAW,CAAC,QAAkB;QAC5B,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;YACpD,oDAAoD;YACpD,OAAO;SACR;QACD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;IACvE,CAAC;IAED,UAAU,CAAC,OAAuB;QAChC,IAAI,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC;QACpD,IAAI,QAAQ,IAAI,QAAQ,CAAC,OAAO,KAAK,OAAO,EAAE;YAC5C,oDAAoD;YACpD,OAAO;SACR;QACD,QAAQ,GAAG,IAAI,QAAQ,CACnB,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,CAAC,GAAG,EAAE,EAAE,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,EAC3F,OAAO,CAAC,YAAY,EAAE,EAAE,OAAO,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAC1D,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;IACvE,CAAC;IAED,SAAS;QACP,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,CAAC;IAChD,CAAC;IAED,cAAc,CAAC,GAAoC;QACjD,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAC5C,IAAI,QAAQ,EAAE;YACZ,OAAO,QAAQ,CAAC;SACjB;QACD,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC7C,MAAM,QAAQ,GAAG,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;YAC3C,IAAI,QAAQ,EAAE;gBACZ,OAAO,QAAQ,CAAC;aACjB;SACF;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,qBAAqB,CAAC,QAAqC;QACzD,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,EAAE;YACjD,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE;gBACtB,OAAO,IAAI,CAAC;aACb;SACF;QAED,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC7C,IAAI,KAAK,CAAC,qBAAqB,CAAC,QAAQ,CAAC,EAAE;gBACzC,OAAO,IAAI,CAAC;aACb;SACF;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,UAAU,EAAE,EAAE;YACrB,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;SACtC;QACD,MAAM,QAAQ,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,WAAW,CAAC;QAC/E,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,OAAO,QAAQ,CAAC;aACjB;YACD,OAAO,IAAI,CAAC,aAAa,GAAG,IAAI,GAAG,QAAQ,GAAG,GAAG,CAAC;SACnD;QACD,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;IAC1C,CAAC;IAED,KAAK,CAAC,uBAAuB;QAC3B,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QACvC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,WAAW,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC3F,CAAC;IAED,KAAK,CAAC,yBAAyB;QAC7B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,uBAAuB,EAAE,CAAC;QAC1D,IAAI,YAAY,EAAE;YAChB,OAAO,YAAY,CAAC,cAAc,EAAE,CAAC;SACtC;QACD,IAAI,IAAI,CAAC,UAAU,EAAE,EAAE;YACrB,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC,eAAe,EAAE,CAAC;SAC9D;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,CAAC,SAAS;QACb,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QACvC,MAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC,MAAM,EAAE,CAAC,YAAY,EAAE,CAAC;QACtE,MAAM,mBAAmB,GAAG,KAAK,EAAC,QAAkB,EAAiB,EAAE;YACrE,MAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,oBAAoB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAC3E,IAAI,YAAY,EAAE;gBAChB,QAAQ,CAAC,YAAY,EAAE,CAAC,kBAAkB,CAAC,EAAC,YAAY,EAAE,YAAY,EAAE,EAAE,EAAC,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;aAC3F;QACH,CAAC,CAAC;QAEF,IAAI,WAAW,EAAE;YACf,OAAO,mBAAmB,CAAC,WAAW,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC,CAAC;SACxE;QAED,WAAW;QACX,IAAI,YAAY,EAAE;YAChB,MAAM,QAAQ,GAAG,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YAC9C,IAAI,QAAQ,EAAE;gBACZ,OAAO,mBAAmB,CAAC,QAAQ,CAAC,CAAC;aACtC;SACF;QAED,mFAAmF;QACnF,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC,eAAe,EAAE,CAAC;QAC7E,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC,YAAY,EAAE,CAAC,kBAAkB,CACjE,EAAC,IAAI,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAE,EAAC,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;SACtD;IACH,CAAC;IAED,KAAK,CAAC,yBAAyB;QAC7B,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC,MAAM,EAAE,CAAC,SAAS,EAAE,CAAC,gCAAgC,CACjG,EAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAC,CAAC,CAAC;QACjC,IAAI,QAAQ,CAAC,QAAQ,EAAE,EAAE;YACvB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,QAAQ,CAAC,MAAM,CAAC;IACzB,CAAC;IAED,KAAK,CAAC,eAAe;QACnB,MAAM,QAAQ,GACV,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC,MAAM,EAAE,CAAC,SAAS,EAAE,CAAC,sBAAsB,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAC,CAAC,CAAC;QAC5G,IAAI,QAAQ,CAAC,QAAQ,EAAE,EAAE;YACvB,OAAO,EAAE,CAAC;SACX;QACD,OAAO,QAAQ,CAAC,YAAY,CAAC;IAC/B,CAAC;IAED,qBAAqB,CAAC,sBAC4F;QAEhH,IAAI,CAAC,mBAAmB,GAAG,sBAAsB,CAAC,kBAAkB,CAAC;QACrE,IAAI,CAAC,yBAAyB,GAAG,sBAAsB,CAAC,wBAAwB,CAAC;IACnF,CAAC;IAED,0BAA0B,CAAC,KAAiD;QAC1E,IAAI,CAAC,uBAAuB,CAAC,iBAAiB,GAAG,KAAK,CAAC;QACvD,IAAI,CAAC,uBAAuB,CAAC,YAAY,GAAG,KAAK,CAAC,uBAAuB,CAAC;QAC1E,IAAI,CAAC,uBAAuB,CAAC,gBAAgB,GAAG,KAAK,CAAC,2BAA2B,CAAC;IACpF,CAAC;IAED,eAAe;QACb,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED,uBAAuB,CAAC,MAA0C;QAChE,IAAI,CAAC,oBAAoB,GAAG,MAAM,CAAC;IACrC,CAAC;CACF;AAED,MAAM,OAAO,cAAc;IACzB,kBAAkB,CAAoB;IACtC,YAAY,iBAAoC;QAC9C,IAAI,CAAC,kBAAkB,GAAG,iBAAiB,CAAC;IAC9C,CAAC;IACD,uBAAuB,CAAC,MAAkD;QACxE,IAAI,CAAC,kBAAkB,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC;IAC5D,CAAC;IAED,oBAAoB,CAAC,EAAC,SAAS,EAA0C;QACvE,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,MAAM,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;IACvF,CAAC;IAED,cAAc,CAAC,EAAC,SAAS,EAAoC;QAC3D,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAC5C,MAAM,CAAC,IAAI,EAAE,EAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,EAAE,QAAQ,EAAE,SAAS,EAAC,CAAC,CAAC;IACtF,CAAC;IAED,cAAc,CAAC,EAAC,OAAO,EAAE,IAAI,EAAoC;QAC/D,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,MAAM,CAAC,cAAc,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;IAC3F,CAAC;IAED,aAAa,CAAC,EAAC,OAAO,EAAE,aAAa,EAAE,KAAK,EAAE,UAAU,EAAmC;QACzF,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,OAAO,EAAE,aAAa,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;IACnF,CAAC;IAED,cAAc,CAAC,EAAC,KAAK,EAAE,IAAI,EAAoC;QAC7D,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IACtD,CAAC;IAED,cAAc,CAAC,EAAC,KAAK,EAAoC;QACvD,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;IAChD,CAAC;IAED,aAAa,CAAC,EAAC,OAAO,EAAE,MAAM,EAAmC;QAC/D,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,OAAO,EAAE,MAAM,sBAAgD,CAAC,CAAC;IACzG,CAAC;IAED,mBAAmB,CAAC,EAA0C;IAC9D,CAAC;IAED,mBAAmB,CAAC,EAA0C;IAC9D,CAAC;IAED,wBAAwB,CAAC,EAA+C;IACxE,CAAC;IAED,wBAAwB,CAAC,EAA+C;IACxE,CAAC;IAED,+BAA+B,CAAC,EAAsD;IACtF,CAAC;IAED,uBAAuB,CAAC,EAA8C;IACtE,CAAC;IAED,YAAY;QACV,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;IACxE,CAAC;IAED,uBAAuB,CAAC,EAAC,iBAAiB,EAA6C;QACrF,IAAI,CAAC,iBAAiB,EAAE;YACtB,KAAK,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,6BAA6B,CAAC,EAAC,MAAM,EAAE,KAAK,EAAC,CAAC,CAAC;SACnF;IACH,CAAC;IAED,sBAAsB,CAAC,EAA6C;IACpE,CAAC;IAED,eAAe,CAAC,EAAsC;IACtD,CAAC;IAED,2BAA2B,CAAC,EAAkD;IAC9E,CAAC;IAED,iBAAiB;QACf,IAAI,CAAC,kBAAkB,CAAC,qBAAqB,GAAG,IAAI,CAAC;QACrD,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;IAC7E,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,kBAAkB,CAAC,qBAAqB,GAAG,KAAK,CAAC;QACtD,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC;IAC9E,CAAC;IAED,UAAU,CAAC,EAAiC;IAC5C,CAAC;IAED,wBAAwB,CAAC,EAA+C;IACxE,CAAC;IAED,iBAAiB,CAAC,EAAwC;IAC1D,CAAC;IAED,iBAAiB,CAAC,EAAwC;IAC1D,CAAC;IAED,gBAAgB;IAChB,CAAC;IAED,yBAAyB,CAAC,MAAoD;QAC5E,IAAI,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,MAAM,CAAC,CAAC;IAC9D,CAAC;CACF;AAED,QAAQ,CAAC,QAAQ,CAAC,iBAAiB,EAAE,EAAC,YAAY,EAAE,UAAU,CAAC,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAC,CAAC,CAAC","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2011 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the #name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../common/common.js';\nimport * as i18n from '../i18n/i18n.js';\nimport * as Platform from '../platform/platform.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nimport type {DeferredDOMNode, DOMNode} from './DOMModel.js';\nimport {DOMModel} from './DOMModel.js';\nimport type {RequestUpdateDroppedEventData} from './NetworkManager.js';\nimport {Events as NetworkManagerEvents, NetworkManager} from './NetworkManager.js';\nimport type {NetworkRequest} from './NetworkRequest.js';\nimport {Resource} from './Resource.js';\nimport {ExecutionContext, RuntimeModel} from './RuntimeModel.js';\nimport type {Target} from './Target.js';\nimport {Capability} from './Target.js';\nimport {SDKModel} from './SDKModel.js';\nimport {TargetManager} from './TargetManager.js';\nimport {SecurityOriginManager} from './SecurityOriginManager.js';\nimport {StorageKeyManager} from './StorageKeyManager.js';\n\nexport class ResourceTreeModel extends SDKModel<EventTypes> {\n  readonly agent: ProtocolProxyApi.PageApi;\n  readonly storageAgent: ProtocolProxyApi.StorageApi;\n  readonly #securityOriginManager: SecurityOriginManager;\n  readonly #storageKeyManager: StorageKeyManager;\n  readonly framesInternal: Map<string, ResourceTreeFrame>;\n  #cachedResourcesProcessed: boolean;\n  #pendingReloadOptions: {\n    ignoreCache: (boolean|undefined),\n    scriptToEvaluateOnLoad: (string|undefined),\n  }|null;\n  #reloadSuspensionCount: number;\n  isInterstitialShowing: boolean;\n  mainFrame: ResourceTreeFrame|null;\n  #pendingBackForwardCacheNotUsedEvents: Set<Protocol.Page.BackForwardCacheNotUsedEvent>;\n  #pendingPrerenderAttemptCompletedEvents: Set<Protocol.Page.PrerenderAttemptCompletedEvent>;\n\n  constructor(target: Target) {\n    super(target);\n\n    const networkManager = target.model(NetworkManager);\n    if (networkManager) {\n      networkManager.addEventListener(NetworkManagerEvents.RequestFinished, this.onRequestFinished, this);\n      networkManager.addEventListener(NetworkManagerEvents.RequestUpdateDropped, this.onRequestUpdateDropped, this);\n    }\n    this.agent = target.pageAgent();\n    this.storageAgent = target.storageAgent();\n    void this.agent.invoke_enable();\n    this.#securityOriginManager = (target.model(SecurityOriginManager) as SecurityOriginManager);\n    this.#storageKeyManager = (target.model(StorageKeyManager) as StorageKeyManager);\n    this.#pendingBackForwardCacheNotUsedEvents = new Set<Protocol.Page.BackForwardCacheNotUsedEvent>();\n    this.#pendingPrerenderAttemptCompletedEvents = new Set<Protocol.Page.PrerenderAttemptCompletedEvent>();\n    target.registerPageDispatcher(new PageDispatcher(this));\n\n    this.framesInternal = new Map();\n    this.#cachedResourcesProcessed = false;\n    this.#pendingReloadOptions = null;\n    this.#reloadSuspensionCount = 0;\n    this.isInterstitialShowing = false;\n    this.mainFrame = null;\n\n    void this.agent.invoke_getResourceTree().then(event => {\n      this.processCachedResources(event.getError() ? null : event.frameTree);\n    });\n  }\n\n  static frameForRequest(request: NetworkRequest): ResourceTreeFrame|null {\n    const networkManager = NetworkManager.forRequest(request);\n    const resourceTreeModel = networkManager ? networkManager.target().model(ResourceTreeModel) : null;\n    if (!resourceTreeModel) {\n      return null;\n    }\n    return request.frameId ? resourceTreeModel.frameForId(request.frameId) : null;\n  }\n\n  static frames(): ResourceTreeFrame[] {\n    const result = [];\n    for (const resourceTreeModel of TargetManager.instance().models(ResourceTreeModel)) {\n      result.push(...resourceTreeModel.framesInternal.values());\n    }\n    return result;\n  }\n\n  static resourceForURL(url: Platform.DevToolsPath.UrlString): Resource|null {\n    for (const resourceTreeModel of TargetManager.instance().models(ResourceTreeModel)) {\n      const mainFrame = resourceTreeModel.mainFrame;\n      const result = mainFrame ? mainFrame.resourceForURL(url) : null;\n      if (result) {\n        return result;\n      }\n    }\n    return null;\n  }\n\n  static reloadAllPages(bypassCache?: boolean, scriptToEvaluateOnLoad?: string): void {\n    for (const resourceTreeModel of TargetManager.instance().models(ResourceTreeModel)) {\n      if (!resourceTreeModel.target().parentTarget()) {\n        resourceTreeModel.reloadPage(bypassCache, scriptToEvaluateOnLoad);\n      }\n    }\n  }\n\n  async storageKeyForFrame(frameId: Protocol.Page.FrameId): Promise<string|null> {\n    const response = await this.storageAgent.invoke_getStorageKeyForFrame({frameId: frameId});\n    if (response.getError() === 'Frame tree node for given frame not found') {\n      return null;\n    }\n    return response.storageKey;\n  }\n\n  domModel(): DOMModel {\n    return this.target().model(DOMModel) as DOMModel;\n  }\n\n  private processCachedResources(mainFramePayload: Protocol.Page.FrameResourceTree|null): void {\n    // TODO(caseq): the url check below is a mergeable, conservative\n    // workaround for a problem caused by us requesting resources from a\n    // subtarget frame before it has committed. The proper fix is likely\n    // to be too complicated to be safely merged.\n    // See https://crbug.com/1081270 for details.\n    if (mainFramePayload && mainFramePayload.frame.url !== ':') {\n      this.dispatchEventToListeners(Events.WillLoadCachedResources);\n      this.addFramesRecursively(null, mainFramePayload);\n      this.target().setInspectedURL(mainFramePayload.frame.url as Platform.DevToolsPath.UrlString);\n    }\n    this.#cachedResourcesProcessed = true;\n    const runtimeModel = this.target().model(RuntimeModel);\n    if (runtimeModel) {\n      runtimeModel.setExecutionContextComparator(this.executionContextComparator.bind(this));\n      runtimeModel.fireExecutionContextOrderChanged();\n    }\n    this.dispatchEventToListeners(Events.CachedResourcesLoaded, this);\n  }\n\n  cachedResourcesLoaded(): boolean {\n    return this.#cachedResourcesProcessed;\n  }\n\n  private addFrame(frame: ResourceTreeFrame, _aboutToNavigate?: boolean): void {\n    this.framesInternal.set(frame.id, frame);\n    if (frame.isMainFrame()) {\n      this.mainFrame = frame;\n    }\n    this.dispatchEventToListeners(Events.FrameAdded, frame);\n    this.updateSecurityOrigins();\n    void this.updateStorageKeys();\n  }\n\n  frameAttached(\n      frameId: Protocol.Page.FrameId, parentFrameId: Protocol.Page.FrameId|null,\n      stackTrace?: Protocol.Runtime.StackTrace, adScriptId?: Protocol.Page.AdScriptId): ResourceTreeFrame|null {\n    const sameTargetParentFrame = parentFrameId ? (this.framesInternal.get(parentFrameId) || null) : null;\n    // Do nothing unless cached resource tree is processed - it will overwrite everything.\n    if (!this.#cachedResourcesProcessed && sameTargetParentFrame) {\n      return null;\n    }\n    if (this.framesInternal.has(frameId)) {\n      return null;\n    }\n\n    const frame =\n        new ResourceTreeFrame(this, sameTargetParentFrame, frameId, null, stackTrace || null, adScriptId || null);\n    if (parentFrameId && !sameTargetParentFrame) {\n      frame.crossTargetParentFrameId = parentFrameId;\n    }\n    if (frame.isMainFrame() && this.mainFrame) {\n      // Navigation to the new backend process.\n      this.frameDetached(this.mainFrame.id, false);\n    }\n    this.addFrame(frame, true);\n    return frame;\n  }\n\n  frameNavigated(framePayload: Protocol.Page.Frame, type: Protocol.Page.NavigationType|undefined): void {\n    const sameTargetParentFrame =\n        framePayload.parentId ? (this.framesInternal.get(framePayload.parentId) || null) : null;\n    // Do nothing unless cached resource tree is processed - it will overwrite everything.\n    if (!this.#cachedResourcesProcessed && sameTargetParentFrame) {\n      return;\n    }\n    let frame: (ResourceTreeFrame|null) = this.framesInternal.get(framePayload.id) || null;\n    if (!frame) {\n      // Simulate missed \"frameAttached\" for a main frame navigation to the new backend process.\n      frame = this.frameAttached(framePayload.id, framePayload.parentId || null);\n      console.assert(Boolean(frame));\n      if (!frame) {\n        return;\n      }\n    }\n\n    this.dispatchEventToListeners(Events.FrameWillNavigate, frame);\n    frame.navigate(framePayload);\n    if (type) {\n      frame.backForwardCacheDetails.restoredFromCache = type === Protocol.Page.NavigationType.BackForwardCacheRestore;\n    }\n    this.dispatchEventToListeners(Events.FrameNavigated, frame);\n\n    if (frame.isMainFrame()) {\n      this.processPendingEvents(frame);\n      this.dispatchEventToListeners(Events.MainFrameNavigated, frame);\n      const networkManager = this.target().model(NetworkManager);\n      if (networkManager) {\n        networkManager.clearRequests();\n      }\n    }\n\n    // Fill frame with retained resources (the ones loaded using new loader).\n    const resources = frame.resources();\n    for (let i = 0; i < resources.length; ++i) {\n      this.dispatchEventToListeners(Events.ResourceAdded, resources[i]);\n    }\n\n    if (frame.isMainFrame()) {\n      this.target().setInspectedURL(frame.url);\n    }\n    this.updateSecurityOrigins();\n    void this.updateStorageKeys();\n  }\n\n  documentOpened(framePayload: Protocol.Page.Frame): void {\n    this.frameNavigated(framePayload, undefined);\n    const frame = this.framesInternal.get(framePayload.id);\n    if (frame && !frame.getResourcesMap().get(framePayload.url)) {\n      const frameResource = this.createResourceFromFramePayload(\n          framePayload, framePayload.url as Platform.DevToolsPath.UrlString, Common.ResourceType.resourceTypes.Document,\n          framePayload.mimeType, null, null);\n      frameResource.isGenerated = true;\n      frame.addResource(frameResource);\n    }\n  }\n\n  frameDetached(frameId: Protocol.Page.FrameId, isSwap: boolean): void {\n    // Do nothing unless cached resource tree is processed - it will overwrite everything.\n    if (!this.#cachedResourcesProcessed) {\n      return;\n    }\n\n    const frame = this.framesInternal.get(frameId);\n    if (!frame) {\n      return;\n    }\n\n    const sameTargetParentFrame = frame.sameTargetParentFrame();\n    if (sameTargetParentFrame) {\n      sameTargetParentFrame.removeChildFrame(frame, isSwap);\n    } else {\n      frame.remove(isSwap);\n    }\n    this.updateSecurityOrigins();\n    void this.updateStorageKeys();\n  }\n\n  private onRequestFinished(event: Common.EventTarget.EventTargetEvent<NetworkRequest>): void {\n    if (!this.#cachedResourcesProcessed) {\n      return;\n    }\n\n    const request = event.data;\n    if (request.failed || request.resourceType() === Common.ResourceType.resourceTypes.XHR) {\n      return;\n    }\n\n    const frame = request.frameId ? this.framesInternal.get(request.frameId) : null;\n    if (frame) {\n      frame.addRequest(request);\n    }\n  }\n\n  private onRequestUpdateDropped(event: Common.EventTarget.EventTargetEvent<RequestUpdateDroppedEventData>): void {\n    if (!this.#cachedResourcesProcessed) {\n      return;\n    }\n\n    const data = event.data;\n    const frameId = data.frameId;\n    if (!frameId) {\n      return;\n    }\n    const frame = this.framesInternal.get(frameId);\n    if (!frame) {\n      return;\n    }\n\n    const url = data.url;\n    if (frame.getResourcesMap().get(url)) {\n      return;\n    }\n\n    const resource = new Resource(\n        this, null, url, frame.url, frameId, data.loaderId, Common.ResourceType.resourceTypes[data.resourceType],\n        data.mimeType, data.lastModified, null);\n    frame.addResource(resource);\n  }\n\n  frameForId(frameId: Protocol.Page.FrameId): ResourceTreeFrame|null {\n    return this.framesInternal.get(frameId) || null;\n  }\n\n  forAllResources(callback: (arg0: Resource) => boolean): boolean {\n    if (this.mainFrame) {\n      return this.mainFrame.callForFrameResources(callback);\n    }\n    return false;\n  }\n\n  frames(): ResourceTreeFrame[] {\n    return [...this.framesInternal.values()];\n  }\n\n  resourceForURL(url: Platform.DevToolsPath.UrlString): Resource|null {\n    // Workers call into this with no #frames available.\n    return this.mainFrame ? this.mainFrame.resourceForURL(url) : null;\n  }\n\n  private addFramesRecursively(\n      sameTargetParentFrame: ResourceTreeFrame|null, frameTreePayload: Protocol.Page.FrameResourceTree): void {\n    const framePayload = frameTreePayload.frame;\n    const frame = new ResourceTreeFrame(this, sameTargetParentFrame, framePayload.id, framePayload, null, null);\n    if (!sameTargetParentFrame && framePayload.parentId) {\n      frame.crossTargetParentFrameId = framePayload.parentId;\n    }\n    this.addFrame(frame);\n\n    for (const childFrame of frameTreePayload.childFrames || []) {\n      this.addFramesRecursively(frame, childFrame);\n    }\n\n    for (let i = 0; i < frameTreePayload.resources.length; ++i) {\n      const subresource = frameTreePayload.resources[i];\n      const resource = this.createResourceFromFramePayload(\n          framePayload, subresource.url as Platform.DevToolsPath.UrlString,\n          Common.ResourceType.resourceTypes[subresource.type], subresource.mimeType, subresource.lastModified || null,\n          subresource.contentSize || null);\n      frame.addResource(resource);\n    }\n\n    if (!frame.getResourcesMap().get(framePayload.url)) {\n      const frameResource = this.createResourceFromFramePayload(\n          framePayload, framePayload.url as Platform.DevToolsPath.UrlString, Common.ResourceType.resourceTypes.Document,\n          framePayload.mimeType, null, null);\n      frame.addResource(frameResource);\n    }\n  }\n\n  private createResourceFromFramePayload(\n      frame: Protocol.Page.Frame, url: Platform.DevToolsPath.UrlString, type: Common.ResourceType.ResourceType,\n      mimeType: string, lastModifiedTime: number|null, contentSize: number|null): Resource {\n    const lastModified = typeof lastModifiedTime === 'number' ? new Date(lastModifiedTime * 1000) : null;\n    return new Resource(\n        this, null, url, frame.url as Platform.DevToolsPath.UrlString, frame.id, frame.loaderId, type, mimeType,\n        lastModified, contentSize);\n  }\n\n  suspendReload(): void {\n    this.#reloadSuspensionCount++;\n  }\n\n  resumeReload(): void {\n    this.#reloadSuspensionCount--;\n    console.assert(this.#reloadSuspensionCount >= 0, 'Unbalanced call to ResourceTreeModel.resumeReload()');\n    if (!this.#reloadSuspensionCount && this.#pendingReloadOptions) {\n      const {ignoreCache, scriptToEvaluateOnLoad} = this.#pendingReloadOptions;\n      this.reloadPage(ignoreCache, scriptToEvaluateOnLoad);\n    }\n  }\n\n  reloadPage(ignoreCache?: boolean, scriptToEvaluateOnLoad?: string): void {\n    // Only dispatch PageReloadRequested upon first reload request to simplify client logic.\n    if (!this.#pendingReloadOptions) {\n      this.dispatchEventToListeners(Events.PageReloadRequested, this);\n    }\n    if (this.#reloadSuspensionCount) {\n      this.#pendingReloadOptions = {ignoreCache, scriptToEvaluateOnLoad};\n      return;\n    }\n    this.#pendingReloadOptions = null;\n    const networkManager = this.target().model(NetworkManager);\n    if (networkManager) {\n      networkManager.clearRequests();\n    }\n    this.dispatchEventToListeners(Events.WillReloadPage);\n    void this.agent.invoke_reload({ignoreCache, scriptToEvaluateOnLoad});\n  }\n\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  navigate(url: Platform.DevToolsPath.UrlString): Promise<any> {\n    return this.agent.invoke_navigate({url});\n  }\n\n  async navigationHistory(): Promise<{\n    currentIndex: number,\n    entries: Array<Protocol.Page.NavigationEntry>,\n  }|null> {\n    const response = await this.agent.invoke_getNavigationHistory();\n    if (response.getError()) {\n      return null;\n    }\n    return {currentIndex: response.currentIndex, entries: response.entries};\n  }\n\n  navigateToHistoryEntry(entry: Protocol.Page.NavigationEntry): void {\n    void this.agent.invoke_navigateToHistoryEntry({entryId: entry.id});\n  }\n\n  setLifecycleEventsEnabled(enabled: boolean): Promise<Protocol.ProtocolResponseWithError> {\n    return this.agent.invoke_setLifecycleEventsEnabled({enabled});\n  }\n\n  async fetchAppManifest(): Promise<{\n    url: Platform.DevToolsPath.UrlString,\n    data: string|null,\n    errors: Array<Protocol.Page.AppManifestError>,\n  }> {\n    const response = await this.agent.invoke_getAppManifest();\n    if (response.getError()) {\n      return {url: response.url as Platform.DevToolsPath.UrlString, data: null, errors: []};\n    }\n    return {url: response.url as Platform.DevToolsPath.UrlString, data: response.data || null, errors: response.errors};\n  }\n\n  async getInstallabilityErrors(): Promise<Protocol.Page.InstallabilityError[]> {\n    const response = await this.agent.invoke_getInstallabilityErrors();\n    return response.installabilityErrors || [];\n  }\n\n  async getManifestIcons(): Promise<{\n    primaryIcon: string | null,\n  }> {\n    const response = await this.agent.invoke_getManifestIcons();\n    return {primaryIcon: response.primaryIcon || null};\n  }\n\n  async getAppId(): Promise<Protocol.Page.GetAppIdResponse> {\n    return this.agent.invoke_getAppId();\n  }\n\n  private executionContextComparator(a: ExecutionContext, b: ExecutionContext): number {\n    function framePath(frame: ResourceTreeFrame|null): ResourceTreeFrame[] {\n      let currentFrame: (ResourceTreeFrame|null) = frame;\n      const parents = [];\n      while (currentFrame) {\n        parents.push(currentFrame);\n        currentFrame = currentFrame.sameTargetParentFrame();\n      }\n      return parents.reverse();\n    }\n\n    if (a.target() !== b.target()) {\n      return ExecutionContext.comparator(a, b);\n    }\n\n    const framesA = a.frameId ? framePath(this.frameForId(a.frameId)) : [];\n    const framesB = b.frameId ? framePath(this.frameForId(b.frameId)) : [];\n    let frameA;\n    let frameB;\n    for (let i = 0;; i++) {\n      if (!framesA[i] || !framesB[i] || (framesA[i] !== framesB[i])) {\n        frameA = framesA[i];\n        frameB = framesB[i];\n        break;\n      }\n    }\n    if (!frameA && frameB) {\n      return -1;\n    }\n\n    if (!frameB && frameA) {\n      return 1;\n    }\n\n    if (frameA && frameB) {\n      return frameA.id.localeCompare(frameB.id);\n    }\n\n    return ExecutionContext.comparator(a, b);\n  }\n\n  private getSecurityOriginData(): SecurityOriginData {\n    const securityOrigins = new Set<string>();\n\n    let mainSecurityOrigin: string|null = null;\n    let unreachableMainSecurityOrigin: string|null = null;\n    for (const frame of this.framesInternal.values()) {\n      const origin = frame.securityOrigin;\n      if (!origin) {\n        continue;\n      }\n\n      securityOrigins.add(origin);\n      if (frame.isMainFrame()) {\n        mainSecurityOrigin = origin;\n        if (frame.unreachableUrl()) {\n          const unreachableParsed = new Common.ParsedURL.ParsedURL(frame.unreachableUrl());\n          unreachableMainSecurityOrigin = unreachableParsed.securityOrigin();\n        }\n      }\n    }\n    return {\n      securityOrigins: securityOrigins,\n      mainSecurityOrigin: mainSecurityOrigin,\n      unreachableMainSecurityOrigin: unreachableMainSecurityOrigin,\n    };\n  }\n\n  private async getStorageKeyData(): Promise<StorageKeyData> {\n    const storageKeys = new Set<string>();\n    let mainStorageKey: string|null = null;\n\n    for (const {isMainFrame, storageKey} of await Promise.all(\n             [...this.framesInternal.values()].map(async f => f.storageKey.then(k => ({\n                                                                                  isMainFrame: f.isMainFrame(),\n                                                                                  storageKey: k,\n                                                                                }))))) {\n      if (isMainFrame) {\n        mainStorageKey = storageKey;\n      }\n      if (storageKey) {\n        storageKeys.add(storageKey);\n      }\n    }\n\n    return {storageKeys: storageKeys, mainStorageKey: mainStorageKey};\n  }\n\n  private updateSecurityOrigins(): void {\n    const data = this.getSecurityOriginData();\n    this.#securityOriginManager.setMainSecurityOrigin(\n        data.mainSecurityOrigin || '', data.unreachableMainSecurityOrigin || '');\n    this.#securityOriginManager.updateSecurityOrigins(data.securityOrigins);\n  }\n\n  private async updateStorageKeys(): Promise<void> {\n    const data = await this.getStorageKeyData();\n    this.#storageKeyManager.setMainStorageKey(data.mainStorageKey || '');\n    this.#storageKeyManager.updateStorageKeys(data.storageKeys);\n  }\n\n  async getMainStorageKey(): Promise<string|null> {\n    return this.mainFrame ? this.mainFrame.storageKey : null;\n  }\n\n  getMainSecurityOrigin(): string|null {\n    const data = this.getSecurityOriginData();\n    return data.mainSecurityOrigin || data.unreachableMainSecurityOrigin;\n  }\n\n  onBackForwardCacheNotUsed(event: Protocol.Page.BackForwardCacheNotUsedEvent): void {\n    if (this.mainFrame && this.mainFrame.id === event.frameId && this.mainFrame.loaderId === event.loaderId) {\n      this.mainFrame.setBackForwardCacheDetails(event);\n      this.dispatchEventToListeners(Events.BackForwardCacheDetailsUpdated, this.mainFrame);\n    } else {\n      this.#pendingBackForwardCacheNotUsedEvents.add(event);\n    }\n  }\n\n  onPrerenderAttemptCompleted(event: Protocol.Page.PrerenderAttemptCompletedEvent): void {\n    if (this.mainFrame && this.mainFrame.id === event.initiatingFrameId) {\n      this.mainFrame.setPrerenderFinalStatus(event.finalStatus);\n      this.dispatchEventToListeners(Events.PrerenderingStatusUpdated, this.mainFrame);\n    } else {\n      this.#pendingPrerenderAttemptCompletedEvents.add(event);\n    }\n  }\n\n  processPendingEvents(frame: ResourceTreeFrame): void {\n    if (!frame.isMainFrame()) {\n      return;\n    }\n    for (const event of this.#pendingBackForwardCacheNotUsedEvents) {\n      if (frame.id === event.frameId && frame.loaderId === event.loaderId) {\n        frame.setBackForwardCacheDetails(event);\n        this.#pendingBackForwardCacheNotUsedEvents.delete(event);\n        break;\n      }\n    }\n    for (const event of this.#pendingPrerenderAttemptCompletedEvents) {\n      if (frame.id === event.initiatingFrameId) {\n        frame.setPrerenderFinalStatus(event.finalStatus);\n        this.#pendingPrerenderAttemptCompletedEvents.delete(event);\n        break;\n      }\n    }\n    // No need to dispatch events here as this method call is followed by a `MainFrameNavigated` event.\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  FrameAdded = 'FrameAdded',\n  FrameNavigated = 'FrameNavigated',\n  FrameDetached = 'FrameDetached',\n  FrameResized = 'FrameResized',\n  FrameWillNavigate = 'FrameWillNavigate',\n  MainFrameNavigated = 'MainFrameNavigated',\n  ResourceAdded = 'ResourceAdded',\n  WillLoadCachedResources = 'WillLoadCachedResources',\n  CachedResourcesLoaded = 'CachedResourcesLoaded',\n  DOMContentLoaded = 'DOMContentLoaded',\n  LifecycleEvent = 'LifecycleEvent',\n  Load = 'Load',\n  PageReloadRequested = 'PageReloadRequested',\n  WillReloadPage = 'WillReloadPage',\n  InterstitialShown = 'InterstitialShown',\n  InterstitialHidden = 'InterstitialHidden',\n  BackForwardCacheDetailsUpdated = 'BackForwardCacheDetailsUpdated',\n  PrerenderingStatusUpdated = 'PrerenderingStatusUpdated',\n}\n\nexport type EventTypes = {\n  [Events.FrameAdded]: ResourceTreeFrame,\n  [Events.FrameNavigated]: ResourceTreeFrame,\n  [Events.FrameDetached]: {frame: ResourceTreeFrame, isSwap: boolean},\n  [Events.FrameResized]: void,\n  [Events.FrameWillNavigate]: ResourceTreeFrame,\n  [Events.MainFrameNavigated]: ResourceTreeFrame,\n  [Events.ResourceAdded]: Resource,\n  [Events.WillLoadCachedResources]: void,\n  [Events.CachedResourcesLoaded]: ResourceTreeModel,\n  [Events.DOMContentLoaded]: number,\n  [Events.LifecycleEvent]: {frameId: Protocol.Page.FrameId, name: string},\n  [Events.Load]: {resourceTreeModel: ResourceTreeModel, loadTime: number},\n  [Events.PageReloadRequested]: ResourceTreeModel,\n  [Events.WillReloadPage]: void,\n  [Events.InterstitialShown]: void,\n  [Events.InterstitialHidden]: void,\n  [Events.BackForwardCacheDetailsUpdated]: ResourceTreeFrame,\n  [Events.PrerenderingStatusUpdated]: ResourceTreeFrame,\n};\n\nexport class ResourceTreeFrame {\n  #model: ResourceTreeModel;\n  #sameTargetParentFrameInternal: ResourceTreeFrame|null;\n  readonly #idInternal: Protocol.Page.FrameId;\n  crossTargetParentFrameId: string|null;\n  #loaderIdInternal: string;\n  #nameInternal: string|null|undefined;\n  #urlInternal: Platform.DevToolsPath.UrlString;\n  #domainAndRegistryInternal: string;\n  #securityOriginInternal: string|null;\n  #storageKeyInternal?: Promise<string|null>;\n  #unreachableUrlInternal: Platform.DevToolsPath.UrlString;\n  #adFrameStatusInternal?: Protocol.Page.AdFrameStatus;\n  #secureContextType: Protocol.Page.SecureContextType|null;\n  #crossOriginIsolatedContextType: Protocol.Page.CrossOriginIsolatedContextType|null;\n  #gatedAPIFeatures: Protocol.Page.GatedAPIFeatures[]|null;\n  #creationStackTrace: Protocol.Runtime.StackTrace|null;\n  #creationStackTraceTarget: Target|null;\n  #childFramesInternal: Set<ResourceTreeFrame>;\n  #adScriptId: Protocol.Runtime.ScriptId|null;\n  #debuggerId: Protocol.Runtime.UniqueDebuggerId|null;\n  resourcesMap: Map<Platform.DevToolsPath.UrlString, Resource>;\n  backForwardCacheDetails: {\n    restoredFromCache: boolean|undefined,\n    explanations: Protocol.Page.BackForwardCacheNotRestoredExplanation[],\n    explanationsTree: Protocol.Page.BackForwardCacheNotRestoredExplanationTree|undefined,\n  } = {\n    restoredFromCache: undefined,\n    explanations: [],\n    explanationsTree: undefined,\n  };\n  prerenderFinalStatus: Protocol.Page.PrerenderFinalStatus|null;\n\n  constructor(\n      model: ResourceTreeModel, parentFrame: ResourceTreeFrame|null, frameId: Protocol.Page.FrameId,\n      payload: Protocol.Page.Frame|null, creationStackTrace: Protocol.Runtime.StackTrace|null,\n      adScriptId: Protocol.Page.AdScriptId|null) {\n    this.#model = model;\n    this.#sameTargetParentFrameInternal = parentFrame;\n    this.#idInternal = frameId;\n    this.crossTargetParentFrameId = null;\n\n    this.#loaderIdInternal = (payload && payload.loaderId) || '';\n    this.#nameInternal = payload && payload.name;\n    this.#urlInternal =\n        payload && payload.url as Platform.DevToolsPath.UrlString || Platform.DevToolsPath.EmptyUrlString;\n    this.#domainAndRegistryInternal = (payload && payload.domainAndRegistry) || '';\n    this.#securityOriginInternal = payload && payload.securityOrigin;\n    this.#unreachableUrlInternal =\n        (payload && payload.unreachableUrl as Platform.DevToolsPath.UrlString) || Platform.DevToolsPath.EmptyUrlString;\n    this.#adFrameStatusInternal = payload?.adFrameStatus;\n    this.#secureContextType = payload && payload.secureContextType;\n    this.#crossOriginIsolatedContextType = payload && payload.crossOriginIsolatedContextType;\n    this.#gatedAPIFeatures = payload && payload.gatedAPIFeatures;\n\n    this.#creationStackTrace = creationStackTrace;\n    this.#creationStackTraceTarget = null;\n\n    this.#adScriptId = adScriptId?.scriptId || null;\n    this.#debuggerId = adScriptId?.debuggerId || null;\n\n    this.#childFramesInternal = new Set();\n\n    this.resourcesMap = new Map();\n    this.prerenderFinalStatus = null;\n\n    if (this.#sameTargetParentFrameInternal) {\n      this.#sameTargetParentFrameInternal.#childFramesInternal.add(this);\n    }\n  }\n\n  isSecureContext(): boolean {\n    return this.#secureContextType !== null && this.#secureContextType.startsWith('Secure');\n  }\n\n  getSecureContextType(): Protocol.Page.SecureContextType|null {\n    return this.#secureContextType;\n  }\n\n  isCrossOriginIsolated(): boolean {\n    return this.#crossOriginIsolatedContextType !== null && this.#crossOriginIsolatedContextType.startsWith('Isolated');\n  }\n\n  getCrossOriginIsolatedContextType(): Protocol.Page.CrossOriginIsolatedContextType|null {\n    return this.#crossOriginIsolatedContextType;\n  }\n\n  getGatedAPIFeatures(): Protocol.Page.GatedAPIFeatures[]|null {\n    return this.#gatedAPIFeatures;\n  }\n\n  getCreationStackTraceData():\n      {creationStackTrace: Protocol.Runtime.StackTrace|null, creationStackTraceTarget: Target} {\n    return {\n      creationStackTrace: this.#creationStackTrace,\n      creationStackTraceTarget: this.#creationStackTraceTarget || this.resourceTreeModel().target(),\n    };\n  }\n\n  navigate(framePayload: Protocol.Page.Frame): void {\n    this.#loaderIdInternal = framePayload.loaderId;\n    this.#nameInternal = framePayload.name;\n    this.#urlInternal = framePayload.url as Platform.DevToolsPath.UrlString;\n    this.#domainAndRegistryInternal = framePayload.domainAndRegistry;\n    this.#securityOriginInternal = framePayload.securityOrigin;\n    this.#unreachableUrlInternal =\n        framePayload.unreachableUrl as Platform.DevToolsPath.UrlString || Platform.DevToolsPath.EmptyUrlString;\n    this.#adFrameStatusInternal = framePayload?.adFrameStatus;\n    this.#secureContextType = framePayload.secureContextType;\n    this.#crossOriginIsolatedContextType = framePayload.crossOriginIsolatedContextType;\n    this.#gatedAPIFeatures = framePayload.gatedAPIFeatures;\n    this.backForwardCacheDetails = {\n      restoredFromCache: undefined,\n      explanations: [],\n      explanationsTree: undefined,\n    };\n\n    const mainResource = this.resourcesMap.get(this.#urlInternal);\n    this.resourcesMap.clear();\n    this.removeChildFrames();\n    if (mainResource && mainResource.loaderId === this.#loaderIdInternal) {\n      this.addResource(mainResource);\n    }\n  }\n\n  resourceTreeModel(): ResourceTreeModel {\n    return this.#model;\n  }\n\n  get id(): Protocol.Page.FrameId {\n    return this.#idInternal;\n  }\n\n  get name(): string {\n    return this.#nameInternal || '';\n  }\n\n  get url(): Platform.DevToolsPath.UrlString {\n    return this.#urlInternal;\n  }\n\n  domainAndRegistry(): string {\n    return this.#domainAndRegistryInternal;\n  }\n\n  getAdScriptId(): Protocol.Runtime.ScriptId|null {\n    return this.#adScriptId;\n  }\n\n  setAdScriptId(adScriptId: Protocol.Runtime.ScriptId|null): void {\n    this.#adScriptId = adScriptId;\n  }\n\n  getDebuggerId(): Protocol.Runtime.UniqueDebuggerId|null {\n    return this.#debuggerId;\n  }\n\n  setDebuggerId(debuggerId: Protocol.Runtime.UniqueDebuggerId|null): void {\n    this.#debuggerId = debuggerId;\n  }\n\n  get securityOrigin(): string|null {\n    return this.#securityOriginInternal;\n  }\n\n  get storageKey(): Promise<string|null> {\n    if (!this.#storageKeyInternal) {\n      this.#storageKeyInternal = this.#model.storageKeyForFrame(this.#idInternal);\n    }\n    return this.#storageKeyInternal;\n  }\n\n  unreachableUrl(): Platform.DevToolsPath.UrlString {\n    return this.#unreachableUrlInternal;\n  }\n\n  get loaderId(): string {\n    return this.#loaderIdInternal;\n  }\n\n  adFrameType(): Protocol.Page.AdFrameType {\n    return this.#adFrameStatusInternal?.adFrameType || Protocol.Page.AdFrameType.None;\n  }\n\n  adFrameStatus(): Protocol.Page.AdFrameStatus|undefined {\n    return this.#adFrameStatusInternal;\n  }\n\n  get childFrames(): ResourceTreeFrame[] {\n    return [...this.#childFramesInternal];\n  }\n\n  /**\n   * Returns the parent frame if both #frames are part of the same process/target.\n   */\n  sameTargetParentFrame(): ResourceTreeFrame|null {\n    return this.#sameTargetParentFrameInternal;\n  }\n\n  /**\n   * Returns the parent frame if both #frames are part of different processes/targets (child is an OOPIF).\n   */\n  crossTargetParentFrame(): ResourceTreeFrame|null {\n    if (!this.crossTargetParentFrameId) {\n      return null;\n    }\n    const parentTarget = this.#model.target().parentTarget();\n    if (!parentTarget) {\n      return null;\n    }\n    const parentModel = parentTarget.model(ResourceTreeModel);\n    if (!parentModel) {\n      return null;\n    }\n    // Note that parent #model has already processed cached resources:\n    // - when parent target was created, we issued getResourceTree call;\n    // - strictly after we issued setAutoAttach call;\n    // - both of them were handled in renderer in the same order;\n    // - cached resource tree got processed on parent #model;\n    // - child target was created as a result of setAutoAttach call.\n    return parentModel.framesInternal.get(this.crossTargetParentFrameId) || null;\n  }\n\n  /**\n   * Returns the parent frame. There is only 1 parent and it's either in the\n   * same target or it's cross-target.\n   */\n  parentFrame(): ResourceTreeFrame|null {\n    return this.sameTargetParentFrame() || this.crossTargetParentFrame();\n  }\n\n  /**\n   * Returns true if this is the main frame of its target. For example, this returns true for the main frame\n   * of an out-of-process iframe (OOPIF).\n   */\n  isMainFrame(): boolean {\n    return !this.#sameTargetParentFrameInternal;\n  }\n\n  /**\n   * Returns true if this is the top frame of the main target, i.e. if this is the top-most frame in the inspected\n   * tab.\n   */\n  isTopFrame(): boolean {\n    return !this.#model.target().parentTarget() && !this.#sameTargetParentFrameInternal &&\n        !this.crossTargetParentFrameId;\n  }\n\n  removeChildFrame(frame: ResourceTreeFrame, isSwap: boolean): void {\n    this.#childFramesInternal.delete(frame);\n    frame.remove(isSwap);\n  }\n\n  private removeChildFrames(): void {\n    const frames = this.#childFramesInternal;\n    this.#childFramesInternal = new Set();\n    for (const frame of frames) {\n      frame.remove(false);\n    }\n  }\n\n  remove(isSwap: boolean): void {\n    this.removeChildFrames();\n    this.#model.framesInternal.delete(this.id);\n    this.#model.dispatchEventToListeners(Events.FrameDetached, {frame: this, isSwap});\n  }\n\n  addResource(resource: Resource): void {\n    if (this.resourcesMap.get(resource.url) === resource) {\n      // Already in the tree, we just got an extra update.\n      return;\n    }\n    this.resourcesMap.set(resource.url, resource);\n    this.#model.dispatchEventToListeners(Events.ResourceAdded, resource);\n  }\n\n  addRequest(request: NetworkRequest): void {\n    let resource = this.resourcesMap.get(request.url());\n    if (resource && resource.request === request) {\n      // Already in the tree, we just got an extra update.\n      return;\n    }\n    resource = new Resource(\n        this.#model, request, request.url(), request.documentURL, request.frameId, request.loaderId,\n        request.resourceType(), request.mimeType, null, null);\n    this.resourcesMap.set(resource.url, resource);\n    this.#model.dispatchEventToListeners(Events.ResourceAdded, resource);\n  }\n\n  resources(): Resource[] {\n    return Array.from(this.resourcesMap.values());\n  }\n\n  resourceForURL(url: Platform.DevToolsPath.UrlString): Resource|null {\n    const resource = this.resourcesMap.get(url);\n    if (resource) {\n      return resource;\n    }\n    for (const frame of this.#childFramesInternal) {\n      const resource = frame.resourceForURL(url);\n      if (resource) {\n        return resource;\n      }\n    }\n    return null;\n  }\n\n  callForFrameResources(callback: (arg0: Resource) => boolean): boolean {\n    for (const resource of this.resourcesMap.values()) {\n      if (callback(resource)) {\n        return true;\n      }\n    }\n\n    for (const frame of this.#childFramesInternal) {\n      if (frame.callForFrameResources(callback)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  displayName(): string {\n    if (this.isTopFrame()) {\n      return i18n.i18n.lockedString('top');\n    }\n    const subtitle = new Common.ParsedURL.ParsedURL(this.#urlInternal).displayName;\n    if (subtitle) {\n      if (!this.#nameInternal) {\n        return subtitle;\n      }\n      return this.#nameInternal + ' (' + subtitle + ')';\n    }\n    return i18n.i18n.lockedString('iframe');\n  }\n\n  async getOwnerDeferredDOMNode(): Promise<DeferredDOMNode|null> {\n    const parentFrame = this.parentFrame();\n    if (!parentFrame) {\n      return null;\n    }\n    return parentFrame.resourceTreeModel().domModel().getOwnerNodeForFrame(this.#idInternal);\n  }\n\n  async getOwnerDOMNodeOrDocument(): Promise<DOMNode|null> {\n    const deferredNode = await this.getOwnerDeferredDOMNode();\n    if (deferredNode) {\n      return deferredNode.resolvePromise();\n    }\n    if (this.isTopFrame()) {\n      return this.resourceTreeModel().domModel().requestDocument();\n    }\n    return null;\n  }\n\n  async highlight(): Promise<void> {\n    const parentFrame = this.parentFrame();\n    const parentTarget = this.resourceTreeModel().target().parentTarget();\n    const highlightFrameOwner = async(domModel: DOMModel): Promise<void> => {\n      const deferredNode = await domModel.getOwnerNodeForFrame(this.#idInternal);\n      if (deferredNode) {\n        domModel.overlayModel().highlightInOverlay({deferredNode, selectorList: ''}, 'all', true);\n      }\n    };\n\n    if (parentFrame) {\n      return highlightFrameOwner(parentFrame.resourceTreeModel().domModel());\n    }\n\n    // Portals.\n    if (parentTarget) {\n      const domModel = parentTarget.model(DOMModel);\n      if (domModel) {\n        return highlightFrameOwner(domModel);\n      }\n    }\n\n    // For the top frame there is no owner node. Highlight the whole #document instead.\n    const document = await this.resourceTreeModel().domModel().requestDocument();\n    if (document) {\n      this.resourceTreeModel().domModel().overlayModel().highlightInOverlay(\n          {node: document, selectorList: ''}, 'all', true);\n    }\n  }\n\n  async getPermissionsPolicyState(): Promise<Protocol.Page.PermissionsPolicyFeatureState[]|null> {\n    const response = await this.resourceTreeModel().target().pageAgent().invoke_getPermissionsPolicyState(\n        {frameId: this.#idInternal});\n    if (response.getError()) {\n      return null;\n    }\n    return response.states;\n  }\n\n  async getOriginTrials(): Promise<Protocol.Page.OriginTrial[]> {\n    const response =\n        await this.resourceTreeModel().target().pageAgent().invoke_getOriginTrials({frameId: this.#idInternal});\n    if (response.getError()) {\n      return [];\n    }\n    return response.originTrials;\n  }\n\n  setCreationStackTrace(creationStackTraceData:\n                            {creationStackTrace: Protocol.Runtime.StackTrace|null, creationStackTraceTarget: Target}):\n      void {\n    this.#creationStackTrace = creationStackTraceData.creationStackTrace;\n    this.#creationStackTraceTarget = creationStackTraceData.creationStackTraceTarget;\n  }\n\n  setBackForwardCacheDetails(event: Protocol.Page.BackForwardCacheNotUsedEvent): void {\n    this.backForwardCacheDetails.restoredFromCache = false;\n    this.backForwardCacheDetails.explanations = event.notRestoredExplanations;\n    this.backForwardCacheDetails.explanationsTree = event.notRestoredExplanationsTree;\n  }\n\n  getResourcesMap(): Map<string, Resource> {\n    return this.resourcesMap;\n  }\n\n  setPrerenderFinalStatus(status: Protocol.Page.PrerenderFinalStatus): void {\n    this.prerenderFinalStatus = status;\n  }\n}\n\nexport class PageDispatcher implements ProtocolProxyApi.PageDispatcher {\n  #resourceTreeModel: ResourceTreeModel;\n  constructor(resourceTreeModel: ResourceTreeModel) {\n    this.#resourceTreeModel = resourceTreeModel;\n  }\n  backForwardCacheNotUsed(params: Protocol.Page.BackForwardCacheNotUsedEvent): void {\n    this.#resourceTreeModel.onBackForwardCacheNotUsed(params);\n  }\n\n  domContentEventFired({timestamp}: Protocol.Page.DomContentEventFiredEvent): void {\n    this.#resourceTreeModel.dispatchEventToListeners(Events.DOMContentLoaded, timestamp);\n  }\n\n  loadEventFired({timestamp}: Protocol.Page.LoadEventFiredEvent): void {\n    this.#resourceTreeModel.dispatchEventToListeners(\n        Events.Load, {resourceTreeModel: this.#resourceTreeModel, loadTime: timestamp});\n  }\n\n  lifecycleEvent({frameId, name}: Protocol.Page.LifecycleEventEvent): void {\n    this.#resourceTreeModel.dispatchEventToListeners(Events.LifecycleEvent, {frameId, name});\n  }\n\n  frameAttached({frameId, parentFrameId, stack, adScriptId}: Protocol.Page.FrameAttachedEvent): void {\n    this.#resourceTreeModel.frameAttached(frameId, parentFrameId, stack, adScriptId);\n  }\n\n  frameNavigated({frame, type}: Protocol.Page.FrameNavigatedEvent): void {\n    this.#resourceTreeModel.frameNavigated(frame, type);\n  }\n\n  documentOpened({frame}: Protocol.Page.DocumentOpenedEvent): void {\n    this.#resourceTreeModel.documentOpened(frame);\n  }\n\n  frameDetached({frameId, reason}: Protocol.Page.FrameDetachedEvent): void {\n    this.#resourceTreeModel.frameDetached(frameId, reason === Protocol.Page.FrameDetachedEventReason.Swap);\n  }\n\n  frameStartedLoading({}: Protocol.Page.FrameStartedLoadingEvent): void {\n  }\n\n  frameStoppedLoading({}: Protocol.Page.FrameStoppedLoadingEvent): void {\n  }\n\n  frameRequestedNavigation({}: Protocol.Page.FrameRequestedNavigationEvent): void {\n  }\n\n  frameScheduledNavigation({}: Protocol.Page.FrameScheduledNavigationEvent): void {\n  }\n\n  frameClearedScheduledNavigation({}: Protocol.Page.FrameClearedScheduledNavigationEvent): void {\n  }\n\n  navigatedWithinDocument({}: Protocol.Page.NavigatedWithinDocumentEvent): void {\n  }\n\n  frameResized(): void {\n    this.#resourceTreeModel.dispatchEventToListeners(Events.FrameResized);\n  }\n\n  javascriptDialogOpening({hasBrowserHandler}: Protocol.Page.JavascriptDialogOpeningEvent): void {\n    if (!hasBrowserHandler) {\n      void this.#resourceTreeModel.agent.invoke_handleJavaScriptDialog({accept: false});\n    }\n  }\n\n  javascriptDialogClosed({}: Protocol.Page.JavascriptDialogClosedEvent): void {\n  }\n\n  screencastFrame({}: Protocol.Page.ScreencastFrameEvent): void {\n  }\n\n  screencastVisibilityChanged({}: Protocol.Page.ScreencastVisibilityChangedEvent): void {\n  }\n\n  interstitialShown(): void {\n    this.#resourceTreeModel.isInterstitialShowing = true;\n    this.#resourceTreeModel.dispatchEventToListeners(Events.InterstitialShown);\n  }\n\n  interstitialHidden(): void {\n    this.#resourceTreeModel.isInterstitialShowing = false;\n    this.#resourceTreeModel.dispatchEventToListeners(Events.InterstitialHidden);\n  }\n\n  windowOpen({}: Protocol.Page.WindowOpenEvent): void {\n  }\n\n  compilationCacheProduced({}: Protocol.Page.CompilationCacheProducedEvent): void {\n  }\n\n  fileChooserOpened({}: Protocol.Page.FileChooserOpenedEvent): void {\n  }\n\n  downloadWillBegin({}: Protocol.Page.DownloadWillBeginEvent): void {\n  }\n\n  downloadProgress(): void {\n  }\n\n  prerenderAttemptCompleted(params: Protocol.Page.PrerenderAttemptCompletedEvent): void {\n    this.#resourceTreeModel.onPrerenderAttemptCompleted(params);\n  }\n}\n\nSDKModel.register(ResourceTreeModel, {capabilities: Capability.DOM, autostart: true, early: true});\nexport interface SecurityOriginData {\n  securityOrigins: Set<string>;\n  mainSecurityOrigin: string|null;\n  unreachableMainSecurityOrigin: string|null;\n}\n\nexport interface StorageKeyData {\n  storageKeys: Set<string>;\n  mainStorageKey: string|null;\n}\n"]}
{"version":3,"file":"AccessibilityModel.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/AccessibilityModel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Protocol from '../../generated/protocol.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\n\nimport type {DOMNode} from './DOMModel.js';\nimport {DeferredDOMNode} from './DOMModel.js';\nimport type {Target} from './Target.js';\nimport {Capability} from './Target.js';\nimport {SDKModel} from './SDKModel.js';\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum CoreAxPropertyName {\n  Name = 'name',\n  Description = 'description',\n  Value = 'value',\n  Role = 'role',\n}\n\nexport interface CoreOrProtocolAxProperty {\n  name: CoreAxPropertyName|Protocol.Accessibility.AXPropertyName;\n  value: Protocol.Accessibility.AXValue;\n}\n\nexport class AccessibilityNode {\n  readonly #accessibilityModelInternal: AccessibilityModel;\n  readonly #idInternal: Protocol.Accessibility.AXNodeId;\n  readonly #backendDOMNodeIdInternal: Protocol.DOM.BackendNodeId|null;\n  readonly #deferredDOMNodeInternal: DeferredDOMNode|null;\n  readonly #ignoredInternal: boolean;\n  readonly #ignoredReasonsInternal: Protocol.Accessibility.AXProperty[]|undefined;\n  readonly #roleInternal: Protocol.Accessibility.AXValue|null;\n  readonly #nameInternal: Protocol.Accessibility.AXValue|null;\n  readonly #descriptionInternal: Protocol.Accessibility.AXValue|null;\n  readonly #valueInternal: Protocol.Accessibility.AXValue|null;\n  readonly #propertiesInternal: Protocol.Accessibility.AXProperty[]|null;\n  readonly #parentId: Protocol.Accessibility.AXNodeId|null;\n  readonly #frameId: Protocol.Page.FrameId|null;\n  readonly #childIds: Protocol.Accessibility.AXNodeId[]|null;\n\n  constructor(accessibilityModel: AccessibilityModel, payload: Protocol.Accessibility.AXNode) {\n    this.#accessibilityModelInternal = accessibilityModel;\n\n    this.#idInternal = payload.nodeId;\n    accessibilityModel.setAXNodeForAXId(this.#idInternal, this);\n    if (payload.backendDOMNodeId) {\n      accessibilityModel.setAXNodeForBackendDOMNodeId(payload.backendDOMNodeId, this);\n      this.#backendDOMNodeIdInternal = payload.backendDOMNodeId;\n      this.#deferredDOMNodeInternal = new DeferredDOMNode(accessibilityModel.target(), payload.backendDOMNodeId);\n    } else {\n      this.#backendDOMNodeIdInternal = null;\n      this.#deferredDOMNodeInternal = null;\n    }\n    this.#ignoredInternal = payload.ignored;\n    if (this.#ignoredInternal && 'ignoredReasons' in payload) {\n      this.#ignoredReasonsInternal = payload.ignoredReasons;\n    }\n\n    this.#roleInternal = payload.role || null;\n    this.#nameInternal = payload.name || null;\n    this.#descriptionInternal = payload.description || null;\n    this.#valueInternal = payload.value || null;\n    this.#propertiesInternal = payload.properties || null;\n    this.#childIds = payload.childIds || null;\n    this.#parentId = payload.parentId || null;\n    if (payload.frameId && !payload.parentId) {\n      this.#frameId = payload.frameId;\n      accessibilityModel.setRootAXNodeForFrameId(payload.frameId, this);\n    } else {\n      this.#frameId = null;\n    }\n  }\n\n  id(): Protocol.Accessibility.AXNodeId {\n    return this.#idInternal;\n  }\n\n  accessibilityModel(): AccessibilityModel {\n    return this.#accessibilityModelInternal;\n  }\n\n  ignored(): boolean {\n    return this.#ignoredInternal;\n  }\n\n  ignoredReasons(): Protocol.Accessibility.AXProperty[]|null {\n    return this.#ignoredReasonsInternal || null;\n  }\n\n  role(): Protocol.Accessibility.AXValue|null {\n    return this.#roleInternal || null;\n  }\n\n  coreProperties(): CoreOrProtocolAxProperty[] {\n    const properties: CoreOrProtocolAxProperty[] = [];\n\n    if (this.#nameInternal) {\n      properties.push({name: CoreAxPropertyName.Name, value: this.#nameInternal});\n    }\n    if (this.#descriptionInternal) {\n      properties.push({name: CoreAxPropertyName.Description, value: this.#descriptionInternal});\n    }\n    if (this.#valueInternal) {\n      properties.push({name: CoreAxPropertyName.Value, value: this.#valueInternal});\n    }\n\n    return properties;\n  }\n\n  name(): Protocol.Accessibility.AXValue|null {\n    return this.#nameInternal || null;\n  }\n\n  description(): Protocol.Accessibility.AXValue|null {\n    return this.#descriptionInternal || null;\n  }\n\n  value(): Protocol.Accessibility.AXValue|null {\n    return this.#valueInternal || null;\n  }\n\n  properties(): Protocol.Accessibility.AXProperty[]|null {\n    return this.#propertiesInternal || null;\n  }\n\n  parentNode(): AccessibilityNode|null {\n    if (this.#parentId) {\n      return this.#accessibilityModelInternal.axNodeForId(this.#parentId);\n    }\n    return null;\n  }\n\n  isDOMNode(): boolean {\n    return Boolean(this.#backendDOMNodeIdInternal);\n  }\n\n  backendDOMNodeId(): Protocol.DOM.BackendNodeId|null {\n    return this.#backendDOMNodeIdInternal;\n  }\n\n  deferredDOMNode(): DeferredDOMNode|null {\n    return this.#deferredDOMNodeInternal;\n  }\n\n  highlightDOMNode(): void {\n    const deferredNode = this.deferredDOMNode();\n    if (!deferredNode) {\n      return;\n    }\n    // Highlight node in page.\n    deferredNode.highlight();\n  }\n\n  children(): AccessibilityNode[] {\n    if (!this.#childIds) {\n      return [];\n    }\n\n    const children = [];\n    for (const childId of this.#childIds) {\n      const child = this.#accessibilityModelInternal.axNodeForId(childId);\n      if (child) {\n        children.push(child);\n      }\n    }\n\n    return children;\n  }\n\n  numChildren(): number {\n    if (!this.#childIds) {\n      return 0;\n    }\n    return this.#childIds.length;\n  }\n\n  hasOnlyUnloadedChildren(): boolean {\n    if (!this.#childIds || !this.#childIds.length) {\n      return false;\n    }\n    return this.#childIds.every(id => this.#accessibilityModelInternal.axNodeForId(id) === null);\n  }\n\n  hasUnloadedChildren(): boolean {\n    if (!this.#childIds || !this.#childIds.length) {\n      return false;\n    }\n    return this.#childIds.some(id => this.#accessibilityModelInternal.axNodeForId(id) === null);\n  }\n  // Only the root node gets a frameId, so nodes have to walk up the tree to find their frameId.\n  getFrameId(): Protocol.Page.FrameId|null {\n    return this.#frameId || this.parentNode()?.getFrameId() || null;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  TreeUpdated = 'TreeUpdated',\n}\n\nexport type EventTypes = {\n  [Events.TreeUpdated]: {root?: AccessibilityNode},\n};\n\nexport class AccessibilityModel extends SDKModel<EventTypes> implements ProtocolProxyApi.AccessibilityDispatcher {\n  agent: ProtocolProxyApi.AccessibilityApi;\n  #axIdToAXNode: Map<string, AccessibilityNode>;\n  #backendDOMNodeIdToAXNode: Map<Protocol.DOM.BackendNodeId, AccessibilityNode>;\n  #frameIdToAXNode: Map<Protocol.Page.FrameId, AccessibilityNode>;\n  #pendingChildRequests: Map<string, Promise<Protocol.Accessibility.GetChildAXNodesResponse>>;\n  #root: AccessibilityNode|null;\n\n  constructor(target: Target) {\n    super(target);\n    target.registerAccessibilityDispatcher(this);\n    this.agent = target.accessibilityAgent();\n    void this.resumeModel();\n\n    this.#axIdToAXNode = new Map();\n    this.#backendDOMNodeIdToAXNode = new Map();\n    this.#frameIdToAXNode = new Map();\n    this.#pendingChildRequests = new Map();\n    this.#root = null;\n  }\n\n  clear(): void {\n    this.#root = null;\n    this.#axIdToAXNode.clear();\n    this.#backendDOMNodeIdToAXNode.clear();\n    this.#frameIdToAXNode.clear();\n  }\n\n  async resumeModel(): Promise<void> {\n    await this.agent.invoke_enable();\n  }\n\n  async suspendModel(): Promise<void> {\n    await this.agent.invoke_disable();\n  }\n\n  async requestPartialAXTree(node: DOMNode): Promise<void> {\n    const {nodes} = await this.agent.invoke_getPartialAXTree({nodeId: node.id, fetchRelatives: true});\n    if (!nodes) {\n      return;\n    }\n    const axNodes = [];\n    for (const payload of nodes) {\n      axNodes.push(new AccessibilityNode(this, payload));\n    }\n  }\n\n  loadComplete({root}: Protocol.Accessibility.LoadCompleteEvent): void {\n    this.clear();\n    this.#root = new AccessibilityNode(this, root);\n    this.dispatchEventToListeners(Events.TreeUpdated, {root: this.#root});\n  }\n\n  nodesUpdated({nodes}: Protocol.Accessibility.NodesUpdatedEvent): void {\n    this.createNodesFromPayload(nodes);\n    this.dispatchEventToListeners(Events.TreeUpdated, {});\n    return;\n  }\n\n  private createNodesFromPayload(payloadNodes: Protocol.Accessibility.AXNode[]): AccessibilityNode[] {\n    const accessibilityNodes = payloadNodes.map(node => {\n      const sdkNode = new AccessibilityNode(this, node);\n      return sdkNode;\n    });\n\n    return accessibilityNodes;\n  }\n\n  async requestRootNode(frameId?: Protocol.Page.FrameId): Promise<AccessibilityNode|undefined> {\n    if (frameId && this.#frameIdToAXNode.has(frameId)) {\n      return this.#frameIdToAXNode.get(frameId);\n    }\n    if (!frameId && this.#root) {\n      return this.#root;\n    }\n    const {node} = await this.agent.invoke_getRootAXNode({frameId});\n    if (!node) {\n      return;\n    }\n    return this.createNodesFromPayload([node])[0];\n  }\n\n  async requestAXChildren(nodeId: Protocol.Accessibility.AXNodeId, frameId?: Protocol.Page.FrameId):\n      Promise<AccessibilityNode[]> {\n    const parent = this.#axIdToAXNode.get(nodeId);\n    if (!parent) {\n      throw Error('Cannot request children before parent');\n    }\n    if (!parent.hasUnloadedChildren()) {\n      return parent.children();\n    }\n\n    const request = this.#pendingChildRequests.get(nodeId);\n    if (request) {\n      await request;\n    } else {\n      const request = this.agent.invoke_getChildAXNodes({id: nodeId, frameId});\n      this.#pendingChildRequests.set(nodeId, request);\n      const result = await request;\n      if (!result.getError()) {\n        this.createNodesFromPayload(result.nodes);\n        this.#pendingChildRequests.delete(nodeId);\n      }\n    }\n    return parent.children();\n  }\n\n  async requestAndLoadSubTreeToNode(node: DOMNode): Promise<AccessibilityNode[]|null> {\n    // Node may have already been loaded, so don't bother requesting it again.\n    const result = [];\n    let ancestor = this.axNodeForDOMNode(node);\n    while (ancestor) {\n      result.push(ancestor);\n      const parent = ancestor.parentNode();\n      if (!parent) {\n        return result;\n      }\n      ancestor = parent;\n    }\n    const {nodes} = await this.agent.invoke_getAXNodeAndAncestors({backendNodeId: node.backendNodeId()});\n    if (!nodes) {\n      return null;\n    }\n    const ancestors = this.createNodesFromPayload(nodes);\n\n    return ancestors;\n  }\n\n  axNodeForId(axId: Protocol.Accessibility.AXNodeId): AccessibilityNode|null {\n    return this.#axIdToAXNode.get(axId) || null;\n  }\n\n  setRootAXNodeForFrameId(frameId: Protocol.Page.FrameId, axNode: AccessibilityNode): void {\n    this.#frameIdToAXNode.set(frameId, axNode);\n  }\n\n  axNodeForFrameId(frameId: Protocol.Page.FrameId): AccessibilityNode|null {\n    return this.#frameIdToAXNode.get(frameId) ?? null;\n  }\n\n  setAXNodeForAXId(axId: string, axNode: AccessibilityNode): void {\n    this.#axIdToAXNode.set(axId, axNode);\n  }\n\n  axNodeForDOMNode(domNode: DOMNode|null): AccessibilityNode|null {\n    if (!domNode) {\n      return null;\n    }\n    return this.#backendDOMNodeIdToAXNode.get(domNode.backendNodeId()) ?? null;\n  }\n\n  setAXNodeForBackendDOMNodeId(backendDOMNodeId: Protocol.DOM.BackendNodeId, axNode: AccessibilityNode): void {\n    this.#backendDOMNodeIdToAXNode.set(backendDOMNodeId, axNode);\n  }\n\n  getAgent(): ProtocolProxyApi.AccessibilityApi {\n    return this.agent;\n  }\n}\n\nSDKModel.register(AccessibilityModel, {capabilities: Capability.DOM, autostart: false});\n"]}
{"version":3,"file":"ExtensionPanel.js","sourceRoot":"","sources":["../../../../../../front_end/models/extensions/ExtensionPanel.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2012 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as _ProtocolClient from '../../core/protocol_client/protocol_client.js';  // eslint-disable-line @typescript-eslint/no-unused-vars\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport * as ExtensionAPI from './ExtensionAPI.js';\nimport type {ExtensionServer} from './ExtensionServer.js';\nimport {ExtensionNotifierView, ExtensionView} from './ExtensionView.js';\n\nexport class ExtensionPanel extends UI.Panel.Panel implements UI.SearchableView.Searchable {\n  private readonly server: ExtensionServer;\n  private readonly id: string;\n  private readonly panelToolbar: UI.Toolbar.Toolbar;\n  private readonly searchableViewInternal: UI.SearchableView.SearchableView;\n\n  constructor(server: ExtensionServer, panelName: string, id: string, pageURL: string) {\n    super(panelName);\n    this.server = server;\n    this.id = id;\n    this.setHideOnDetach();\n    this.panelToolbar = new UI.Toolbar.Toolbar('hidden', this.element);\n\n    this.searchableViewInternal = new UI.SearchableView.SearchableView(this, null);\n    this.searchableViewInternal.show(this.element);\n\n    const extensionView = new ExtensionView(server, this.id, pageURL, 'extension');\n    extensionView.show(this.searchableViewInternal.element);\n  }\n\n  addToolbarItem(item: UI.Toolbar.ToolbarItem): void {\n    this.panelToolbar.element.classList.remove('hidden');\n    this.panelToolbar.appendToolbarItem(item);\n  }\n\n  searchCanceled(): void {\n    this.server.notifySearchAction(this.id, ExtensionAPI.PrivateAPI.Panels.SearchAction.CancelSearch);\n    this.searchableViewInternal.updateSearchMatchesCount(0);\n  }\n\n  searchableView(): UI.SearchableView.SearchableView {\n    return this.searchableViewInternal;\n  }\n\n  performSearch(searchConfig: UI.SearchableView.SearchConfig, _shouldJump: boolean, _jumpBackwards?: boolean): void {\n    const query = searchConfig.query;\n    this.server.notifySearchAction(this.id, ExtensionAPI.PrivateAPI.Panels.SearchAction.PerformSearch, query);\n  }\n\n  jumpToNextSearchResult(): void {\n    this.server.notifySearchAction(this.id, ExtensionAPI.PrivateAPI.Panels.SearchAction.NextSearchResult);\n  }\n\n  jumpToPreviousSearchResult(): void {\n    this.server.notifySearchAction(this.id, ExtensionAPI.PrivateAPI.Panels.SearchAction.PreviousSearchResult);\n  }\n\n  supportsCaseSensitiveSearch(): boolean {\n    return false;\n  }\n\n  supportsRegexSearch(): boolean {\n    return false;\n  }\n}\n\nexport class ExtensionButton {\n  private readonly id: string;\n  private readonly toolbarButtonInternal: UI.Toolbar.ToolbarButton;\n  constructor(server: ExtensionServer, id: string, iconURL: string, tooltip?: string, disabled?: boolean) {\n    this.id = id;\n\n    this.toolbarButtonInternal = new UI.Toolbar.ToolbarButton('', '');\n    this.toolbarButtonInternal.addEventListener(\n        UI.Toolbar.ToolbarButton.Events.Click, server.notifyButtonClicked.bind(server, this.id));\n    this.update(iconURL, tooltip, disabled);\n  }\n\n  update(iconURL?: string, tooltip?: string, disabled?: boolean): void {\n    if (typeof iconURL === 'string') {\n      this.toolbarButtonInternal.setBackgroundImage(iconURL);\n    }\n    if (typeof tooltip === 'string') {\n      this.toolbarButtonInternal.setTitle(tooltip);\n    }\n    if (typeof disabled === 'boolean') {\n      this.toolbarButtonInternal.setEnabled(!disabled);\n    }\n  }\n\n  toolbarButton(): UI.Toolbar.ToolbarButton {\n    return this.toolbarButtonInternal;\n  }\n}\n\nexport class ExtensionSidebarPane extends UI.View.SimpleView {\n  private readonly panelNameInternal: string;\n  private server: ExtensionServer;\n  private idInternal: string;\n  private extensionView?: ExtensionView;\n  private objectPropertiesView?: ExtensionNotifierView;\n  constructor(server: ExtensionServer, panelName: string, title: Platform.UIString.LocalizedString, id: string) {\n    super(title);\n    this.element.classList.add('fill');\n    this.panelNameInternal = panelName;\n    this.server = server;\n    this.idInternal = id;\n  }\n\n  id(): string {\n    return this.idInternal;\n  }\n\n  panelName(): string {\n    return this.panelNameInternal;\n  }\n\n  setObject(object: Object, title: string|undefined, callback: (arg0?: (string|null)|undefined) => void): void {\n    this.createObjectPropertiesView();\n    this.setObjectInternal(SDK.RemoteObject.RemoteObject.fromLocalObject(object), title, callback);\n  }\n\n  setExpression(\n      expression: string, title: string|undefined, evaluateOptions: Object|undefined, securityOrigin: string,\n      callback: (arg0?: (string|null)|undefined) => void): void {\n    this.createObjectPropertiesView();\n    this.server.evaluate(\n        expression, true, false, evaluateOptions, securityOrigin, this.onEvaluate.bind(this, title, callback));\n  }\n\n  setPage(url: Platform.DevToolsPath.UrlString): void {\n    if (this.objectPropertiesView) {\n      this.objectPropertiesView.detach();\n      delete this.objectPropertiesView;\n    }\n    if (this.extensionView) {\n      this.extensionView.detach(true);\n    }\n\n    this.extensionView = new ExtensionView(this.server, this.idInternal, url, 'extension fill');\n    this.extensionView.show(this.element);\n\n    if (!this.element.style.height) {\n      this.setHeight('150px');\n    }\n  }\n\n  setHeight(height: string): void {\n    this.element.style.height = height;\n  }\n\n  private onEvaluate(\n      title: string|undefined, callback: (arg0?: (string|null)|undefined) => void, error: string|null,\n      result: SDK.RemoteObject.RemoteObject|null, _wasThrown?: boolean): void {\n    if (error) {\n      callback(error.toString());\n    } else if (!result) {\n      callback();\n    } else {\n      this.setObjectInternal(result, title, callback);\n    }\n  }\n\n  private createObjectPropertiesView(): void {\n    if (this.objectPropertiesView) {\n      return;\n    }\n    if (this.extensionView) {\n      this.extensionView.detach(true);\n      delete this.extensionView;\n    }\n    this.objectPropertiesView = new ExtensionNotifierView(this.server, this.idInternal);\n    this.objectPropertiesView.show(this.element);\n  }\n\n  private setObjectInternal(\n      object: SDK.RemoteObject.RemoteObject, title: string|undefined,\n      callback: (arg0?: (string|null)|undefined) => void): void {\n    const objectPropertiesView = this.objectPropertiesView;\n    // This may only happen if setPage() was called while we were evaluating the expression.\n    if (!objectPropertiesView) {\n      callback('operation cancelled');\n      return;\n    }\n    objectPropertiesView.element.removeChildren();\n    void UI.UIUtils.Renderer.render(object, {title, editable: false}).then(result => {\n      if (!result) {\n        callback();\n        return;\n      }\n      const firstChild = result.tree && result.tree.firstChild();\n      if (firstChild) {\n        firstChild.expand();\n      }\n      objectPropertiesView.element.appendChild(result.node);\n      callback();\n    });\n  }\n}\n"]}
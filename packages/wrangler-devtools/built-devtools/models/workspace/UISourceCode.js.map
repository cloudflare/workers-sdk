{"version":3,"file":"UISourceCode.js","sourceRoot":"","sources":["../../../../../../front_end/models/workspace/UISourceCode.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2011 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as TextUtils from '../text_utils/text_utils.js';\n\nimport type {Project} from './WorkspaceImpl.js';\nimport {Events as WorkspaceImplEvents} from './WorkspaceImpl.js';\n\nconst UIStrings = {\n  /**\n  *@description Text for the index of something\n  */\n  index: '(index)',\n  /**\n  *@description Text in UISource Code of the DevTools local workspace\n  */\n  thisFileWasChangedExternally: 'This file was changed externally. Would you like to reload it?',\n};\nconst str_ = i18n.i18n.registerUIStrings('models/workspace/UISourceCode.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class UISourceCode extends Common.ObjectWrapper.ObjectWrapper<EventTypes> implements\n    TextUtils.ContentProvider.ContentProvider {\n  private projectInternal: Project;\n  private urlInternal: Platform.DevToolsPath.UrlString;\n  private readonly originInternal: Platform.DevToolsPath.UrlString;\n  private readonly parentURLInternal: Platform.DevToolsPath.UrlString;\n  private nameInternal: string;\n  private contentTypeInternal: Common.ResourceType.ResourceType;\n  private requestContentPromise: Promise<TextUtils.ContentProvider.DeferredContent>|null;\n  private decorations: Map<string, any> = new Map();\n  private hasCommitsInternal: boolean;\n  private messagesInternal: Set<Message>|null;\n  private contentLoadedInternal: boolean;\n  private contentInternal: TextUtils.ContentProvider.DeferredContent|null;\n  private forceLoadOnCheckContentInternal: boolean;\n  private checkingContent: boolean;\n  private lastAcceptedContent: string|null;\n  private workingCopyInternal: string|null;\n  private workingCopyGetter: (() => string)|null;\n  private disableEditInternal: boolean;\n  private contentEncodedInternal?: boolean;\n\n  constructor(project: Project, url: Platform.DevToolsPath.UrlString, contentType: Common.ResourceType.ResourceType) {\n    super();\n    this.projectInternal = project;\n    this.urlInternal = url;\n\n    const parsedURL = Common.ParsedURL.ParsedURL.fromString(url);\n    if (parsedURL) {\n      this.originInternal = parsedURL.securityOrigin();\n      this.parentURLInternal =\n          Common.ParsedURL.ParsedURL.concatenate(this.originInternal, parsedURL.folderPathComponents);\n      if (parsedURL.queryParams) {\n        // in case file name contains query params, it doesn't look like a normal file name anymore\n        // so it can as well remain encoded\n        this.nameInternal = parsedURL.lastPathComponent + '?' + parsedURL.queryParams;\n      } else {\n        // file name looks best decoded\n        this.nameInternal = decodeURIComponent(parsedURL.lastPathComponent);\n      }\n    } else {\n      this.originInternal = Platform.DevToolsPath.EmptyUrlString;\n      this.parentURLInternal = Platform.DevToolsPath.EmptyUrlString;\n      this.nameInternal = url;\n    }\n\n    this.contentTypeInternal = contentType;\n    this.requestContentPromise = null;\n    this.hasCommitsInternal = false;\n    this.messagesInternal = null;\n    this.contentLoadedInternal = false;\n    this.contentInternal = null;\n    this.forceLoadOnCheckContentInternal = false;\n    this.checkingContent = false;\n    this.lastAcceptedContent = null;\n    this.workingCopyInternal = null;\n    this.workingCopyGetter = null;\n    this.disableEditInternal = false;\n  }\n\n  requestMetadata(): Promise<UISourceCodeMetadata|null> {\n    return this.projectInternal.requestMetadata(this);\n  }\n\n  name(): string {\n    return this.nameInternal;\n  }\n\n  mimeType(): string {\n    return this.projectInternal.mimeType(this);\n  }\n\n  url(): Platform.DevToolsPath.UrlString {\n    return this.urlInternal;\n  }\n\n  // Identifier used for deduplicating scripts that are considered by the\n  // DevTools UI to be the same script. For now this is just the url but this\n  // is likely to change in the future.\n  canononicalScriptId(): string {\n    return `${this.contentTypeInternal.name()},${this.urlInternal}`;\n  }\n\n  parentURL(): Platform.DevToolsPath.UrlString {\n    return this.parentURLInternal;\n  }\n\n  origin(): Platform.DevToolsPath.UrlString {\n    return this.originInternal;\n  }\n\n  fullDisplayName(): string {\n    return this.projectInternal.fullDisplayName(this);\n  }\n\n  displayName(skipTrim?: boolean): string {\n    if (!this.nameInternal) {\n      return i18nString(UIStrings.index);\n    }\n    const name = this.nameInternal;\n    return skipTrim ? name : Platform.StringUtilities.trimEndWithMaxLength(name, 100);\n  }\n\n  canRename(): boolean {\n    return this.projectInternal.canRename();\n  }\n\n  rename(newName: Platform.DevToolsPath.RawPathString): Promise<boolean> {\n    let fulfill: (arg0: boolean) => void;\n    const promise = new Promise<boolean>(x => {\n      fulfill = x;\n    });\n    this.projectInternal.rename(this, newName, innerCallback.bind(this));\n    return promise;\n\n    function innerCallback(\n        this: UISourceCode, success: boolean, newName?: string, newURL?: Platform.DevToolsPath.UrlString,\n        newContentType?: Common.ResourceType.ResourceType): void {\n      if (success) {\n        this.updateName(\n            newName as Platform.DevToolsPath.RawPathString, newURL as Platform.DevToolsPath.UrlString,\n            newContentType as Common.ResourceType.ResourceType);\n      }\n      fulfill(success);\n    }\n  }\n\n  remove(): void {\n    this.projectInternal.deleteFile(this);\n  }\n\n  private updateName(\n      name: Platform.DevToolsPath.RawPathString, url: Platform.DevToolsPath.UrlString,\n      contentType?: Common.ResourceType.ResourceType): void {\n    const oldURL = this.urlInternal;\n    this.nameInternal = name;\n    if (url) {\n      this.urlInternal = url;\n    } else {\n      this.urlInternal = Common.ParsedURL.ParsedURL.relativePathToUrlString(name, oldURL);\n    }\n    if (contentType) {\n      this.contentTypeInternal = contentType;\n    }\n    this.dispatchEventToListeners(Events.TitleChanged, this);\n    this.project().workspace().dispatchEventToListeners(\n        WorkspaceImplEvents.UISourceCodeRenamed, {oldURL: oldURL, uiSourceCode: this});\n  }\n\n  contentURL(): Platform.DevToolsPath.UrlString {\n    return this.url();\n  }\n\n  contentType(): Common.ResourceType.ResourceType {\n    return this.contentTypeInternal;\n  }\n\n  async contentEncoded(): Promise<boolean> {\n    await this.requestContent();\n    return this.contentEncodedInternal || false;\n  }\n\n  project(): Project {\n    return this.projectInternal;\n  }\n\n  requestContent(): Promise<TextUtils.ContentProvider.DeferredContent> {\n    if (this.requestContentPromise) {\n      return this.requestContentPromise;\n    }\n\n    if (this.contentLoadedInternal) {\n      return Promise.resolve(this.contentInternal as TextUtils.ContentProvider.DeferredContent);\n    }\n\n    this.requestContentPromise = this.requestContentImpl();\n    return this.requestContentPromise;\n  }\n\n  private async requestContentImpl(): Promise<TextUtils.ContentProvider.DeferredContent> {\n    try {\n      const content = await this.projectInternal.requestFileContent(this);\n      if (!this.contentLoadedInternal) {\n        this.contentLoadedInternal = true;\n        this.contentInternal = content;\n        this.contentEncodedInternal = content.isEncoded;\n      }\n    } catch (err) {\n      this.contentLoadedInternal = true;\n      this.contentInternal = {content: null, error: err ? String(err) : '', isEncoded: false};\n    }\n\n    return this.contentInternal as TextUtils.ContentProvider.DeferredContent;\n  }\n\n  #decodeContent(content: TextUtils.ContentProvider.DeferredContent|null): string|null {\n    if (!content) {\n      return null;\n    }\n    return content.isEncoded && content.content ? window.atob(content.content) : content.content;\n  }\n\n  async checkContentUpdated(): Promise<void> {\n    if (!this.contentLoadedInternal && !this.forceLoadOnCheckContentInternal) {\n      return;\n    }\n\n    if (!this.projectInternal.canSetFileContent() || this.checkingContent) {\n      return;\n    }\n\n    this.checkingContent = true;\n    const updatedContent = await this.projectInternal.requestFileContent(this);\n    if ('error' in updatedContent) {\n      return;\n    }\n    this.checkingContent = false;\n    if (updatedContent.content === null) {\n      const workingCopy = this.workingCopy();\n      this.contentCommitted('', false);\n      this.setWorkingCopy(workingCopy);\n      return;\n    }\n    if (this.lastAcceptedContent === updatedContent.content) {\n      return;\n    }\n\n    if (this.#decodeContent(this.contentInternal) === this.#decodeContent(updatedContent)) {\n      this.lastAcceptedContent = null;\n      return;\n    }\n\n    if (!this.isDirty() || this.workingCopyInternal === updatedContent.content) {\n      this.contentCommitted(updatedContent.content as string, false);\n      return;\n    }\n\n    await Common.Revealer.reveal(this);\n\n    // Make sure we are in the next frame before stopping the world with confirm\n    await new Promise(resolve => window.setTimeout(resolve, 0));\n\n    const shouldUpdate = window.confirm(i18nString(UIStrings.thisFileWasChangedExternally));\n    if (shouldUpdate) {\n      this.contentCommitted(updatedContent.content as string, false);\n    } else {\n      this.lastAcceptedContent = updatedContent.content;\n    }\n  }\n\n  forceLoadOnCheckContent(): void {\n    this.forceLoadOnCheckContentInternal = true;\n  }\n\n  private commitContent(content: string): void {\n    if (this.projectInternal.canSetFileContent()) {\n      void this.projectInternal.setFileContent(this, content, false);\n    }\n    this.contentCommitted(content, true);\n  }\n\n  private contentCommitted(content: string, committedByUser: boolean): void {\n    this.lastAcceptedContent = null;\n    this.contentInternal = {content, isEncoded: false};\n    this.contentLoadedInternal = true;\n    this.requestContentPromise = null;\n\n    this.hasCommitsInternal = true;\n\n    this.innerResetWorkingCopy();\n    const data = {uiSourceCode: this, content, encoded: this.contentEncodedInternal};\n    this.dispatchEventToListeners(Events.WorkingCopyCommitted, data);\n    this.projectInternal.workspace().dispatchEventToListeners(WorkspaceImplEvents.WorkingCopyCommitted, data);\n    if (committedByUser) {\n      this.projectInternal.workspace().dispatchEventToListeners(WorkspaceImplEvents.WorkingCopyCommittedByUser, data);\n    }\n  }\n\n  addRevision(content: string): void {\n    this.commitContent(content);\n  }\n\n  hasCommits(): boolean {\n    return this.hasCommitsInternal;\n  }\n\n  workingCopy(): string {\n    if (this.workingCopyGetter) {\n      this.workingCopyInternal = this.workingCopyGetter();\n      this.workingCopyGetter = null;\n    }\n    if (this.isDirty()) {\n      return this.workingCopyInternal as string;\n    }\n    return this.contentInternal?.content || '';\n  }\n\n  resetWorkingCopy(): void {\n    this.innerResetWorkingCopy();\n    this.workingCopyChanged();\n  }\n\n  private innerResetWorkingCopy(): void {\n    this.workingCopyInternal = null;\n    this.workingCopyGetter = null;\n  }\n\n  setWorkingCopy(newWorkingCopy: string): void {\n    this.workingCopyInternal = newWorkingCopy;\n    this.workingCopyGetter = null;\n    this.workingCopyChanged();\n  }\n\n  setContent(content: string, isBase64: boolean): void {\n    this.contentEncodedInternal = isBase64;\n    if (this.projectInternal.canSetFileContent()) {\n      void this.projectInternal.setFileContent(this, content, isBase64);\n    }\n    this.contentCommitted(content, true);\n  }\n\n  setWorkingCopyGetter(workingCopyGetter: () => string): void {\n    this.workingCopyGetter = workingCopyGetter;\n    this.workingCopyChanged();\n  }\n\n  private workingCopyChanged(): void {\n    this.removeAllMessages();\n    this.dispatchEventToListeners(Events.WorkingCopyChanged, this);\n    this.projectInternal.workspace().dispatchEventToListeners(\n        WorkspaceImplEvents.WorkingCopyChanged, {uiSourceCode: this});\n  }\n\n  removeWorkingCopyGetter(): void {\n    if (!this.workingCopyGetter) {\n      return;\n    }\n    this.workingCopyInternal = this.workingCopyGetter();\n    this.workingCopyGetter = null;\n  }\n\n  commitWorkingCopy(): void {\n    if (this.isDirty()) {\n      this.commitContent(this.workingCopy());\n    }\n  }\n\n  isDirty(): boolean {\n    return this.workingCopyInternal !== null || this.workingCopyGetter !== null;\n  }\n\n  extension(): string {\n    return Common.ParsedURL.ParsedURL.extractExtension(this.nameInternal);\n  }\n\n  content(): string {\n    return this.contentInternal?.content || '';\n  }\n\n  loadError(): string|null {\n    return (this.contentInternal && 'error' in this.contentInternal && this.contentInternal.error) || null;\n  }\n\n  searchInContent(query: string, caseSensitive: boolean, isRegex: boolean):\n      Promise<TextUtils.ContentProvider.SearchMatch[]> {\n    const content = this.content();\n    if (!content) {\n      return this.projectInternal.searchInFileContent(this, query, caseSensitive, isRegex);\n    }\n    return Promise.resolve(TextUtils.TextUtils.performSearchInContent(content, query, caseSensitive, isRegex));\n  }\n\n  contentLoaded(): boolean {\n    return this.contentLoadedInternal;\n  }\n\n  uiLocation(lineNumber: number, columnNumber?: number): UILocation {\n    return new UILocation(this, lineNumber, columnNumber);\n  }\n\n  messages(): Set<Message> {\n    return this.messagesInternal ? new Set(this.messagesInternal) : new Set();\n  }\n\n  addLineMessage(\n      level: Message.Level, text: string, lineNumber: number, columnNumber?: number,\n      clickHandler?: (() => void)): Message {\n    const range = TextUtils.TextRange.TextRange.createFromLocation(lineNumber, columnNumber || 0);\n    const message = new Message(level, text, clickHandler, range);\n    this.addMessage(message);\n    return message;\n  }\n\n  addMessage(message: Message): void {\n    if (!this.messagesInternal) {\n      this.messagesInternal = new Set();\n    }\n    this.messagesInternal.add(message);\n    this.dispatchEventToListeners(Events.MessageAdded, message);\n  }\n\n  removeMessage(message: Message): void {\n    if (this.messagesInternal?.delete(message)) {\n      this.dispatchEventToListeners(Events.MessageRemoved, message);\n    }\n  }\n\n  private removeAllMessages(): void {\n    if (!this.messagesInternal) {\n      return;\n    }\n    for (const message of this.messagesInternal) {\n      this.dispatchEventToListeners(Events.MessageRemoved, message);\n    }\n    this.messagesInternal = null;\n  }\n\n  setDecorationData(type: string, data: any): void {\n    if (data !== this.decorations.get(type)) {\n      this.decorations.set(type, data);\n      this.dispatchEventToListeners(Events.DecorationChanged, type);\n    }\n  }\n\n  getDecorationData(type: string): any {\n    return this.decorations.get(type);\n  }\n\n  disableEdit(): void {\n    this.disableEditInternal = true;\n  }\n\n  editDisabled(): boolean {\n    return this.disableEditInternal;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  WorkingCopyChanged = 'WorkingCopyChanged',\n  WorkingCopyCommitted = 'WorkingCopyCommitted',\n  TitleChanged = 'TitleChanged',\n  MessageAdded = 'MessageAdded',\n  MessageRemoved = 'MessageRemoved',\n  DecorationChanged = 'DecorationChanged',\n}\n\nexport interface WorkingCopyCommitedEvent {\n  uiSourceCode: UISourceCode;\n  content: string;\n  encoded: boolean|undefined;\n}\n\nexport type EventTypes = {\n  [Events.WorkingCopyChanged]: UISourceCode,\n  [Events.WorkingCopyCommitted]: WorkingCopyCommitedEvent,\n  [Events.TitleChanged]: UISourceCode,\n  [Events.MessageAdded]: Message,\n  [Events.MessageRemoved]: Message,\n  [Events.DecorationChanged]: string,\n};\n\nexport class UILocation {\n  uiSourceCode: UISourceCode;\n  lineNumber: number;\n  columnNumber: number|undefined;\n  constructor(uiSourceCode: UISourceCode, lineNumber: number, columnNumber?: number) {\n    this.uiSourceCode = uiSourceCode;\n    this.lineNumber = lineNumber;\n    this.columnNumber = columnNumber;\n  }\n\n  linkText(skipTrim?: boolean, showColumnNumber?: boolean): string {\n    let linkText = this.uiSourceCode.displayName(skipTrim);\n    if (this.uiSourceCode.mimeType() === 'application/wasm') {\n      // For WebAssembly locations, we follow the conventions described in\n      // github.com/WebAssembly/design/blob/master/Web.md#developer-facing-display-conventions\n      if (typeof this.columnNumber === 'number') {\n        linkText += `:0x${this.columnNumber.toString(16)}`;\n      }\n    } else {\n      linkText += ':' + (this.lineNumber + 1);\n      if (showColumnNumber && typeof this.columnNumber === 'number') {\n        linkText += ':' + (this.columnNumber + 1);\n      }\n    }\n    return linkText;\n  }\n\n  id(): string {\n    if (typeof this.columnNumber === 'number') {\n      return this.uiSourceCode.project().id() + ':' + this.uiSourceCode.url() + ':' + this.lineNumber + ':' +\n          this.columnNumber;\n    }\n    return this.lineId();\n  }\n\n  lineId(): string {\n    return this.uiSourceCode.project().id() + ':' + this.uiSourceCode.url() + ':' + this.lineNumber;\n  }\n\n  toUIString(): string {\n    return this.uiSourceCode.url() + ':' + (this.lineNumber + 1);\n  }\n\n  static comparator(location1: UILocation, location2: UILocation): number {\n    return location1.compareTo(location2);\n  }\n\n  compareTo(other: UILocation): number {\n    if (this.uiSourceCode.url() !== other.uiSourceCode.url()) {\n      return this.uiSourceCode.url() > other.uiSourceCode.url() ? 1 : -1;\n    }\n    if (this.lineNumber !== other.lineNumber) {\n      return this.lineNumber - other.lineNumber;\n    }\n    // We consider `undefined` less than an actual column number, since\n    // UI location without a column number corresponds to the whole line.\n    if (this.columnNumber === other.columnNumber) {\n      return 0;\n    }\n    if (typeof this.columnNumber !== 'number') {\n      return -1;\n    }\n    if (typeof other.columnNumber !== 'number') {\n      return 1;\n    }\n    return this.columnNumber - other.columnNumber;\n  }\n}\n\n/**\n * A message associated with a range in a `UISourceCode`. The range will be\n * underlined starting at the range's start and ending at the line end (the\n * end of the range is currently disregarded).\n * An icon is going to appear at the end of the line according to the\n * `level` of the Message. This is only the model; displaying is handled\n * where UISourceCode displaying is handled.\n */\nexport class Message {\n  private readonly levelInternal: Message.Level;\n  private readonly textInternal: string;\n  range: TextUtils.TextRange.TextRange;\n  private readonly clickHandlerInternal?: (() => void);\n\n  constructor(level: Message.Level, text: string, clickHandler?: (() => void), range?: TextUtils.TextRange.TextRange) {\n    this.levelInternal = level;\n    this.textInternal = text;\n    this.range = range ?? new TextUtils.TextRange.TextRange(0, 0, 0, 0);\n    this.clickHandlerInternal = clickHandler;\n  }\n\n  level(): Message.Level {\n    return this.levelInternal;\n  }\n\n  text(): string {\n    return this.textInternal;\n  }\n\n  clickHandler(): (() => void)|undefined {\n    return this.clickHandlerInternal;\n  }\n\n  lineNumber(): number {\n    return this.range.startLine;\n  }\n\n  columnNumber(): number|undefined {\n    return this.range.startColumn;\n  }\n\n  isEqual(another: Message): boolean {\n    return this.text() === another.text() && this.level() === another.level() && this.range.equal(another.range);\n  }\n}\n\nexport namespace Message {\n  // TODO(crbug.com/1167717): Make this a const enum again\n  // eslint-disable-next-line rulesdir/const_enum\n  export enum Level {\n    Error = 'Error',\n    Issue = 'Issue',\n    Warning = 'Warning',\n  }\n}\n\nexport class LineMarker {\n  private readonly rangeInternal: TextUtils.TextRange.TextRange;\n  private readonly typeInternal: string;\n  private readonly dataInternal: any;\n\n  constructor(range: TextUtils.TextRange.TextRange, type: string, data: any) {\n    this.rangeInternal = range;\n    this.typeInternal = type;\n    this.dataInternal = data;\n  }\n\n  range(): TextUtils.TextRange.TextRange {\n    return this.rangeInternal;\n  }\n\n  type(): string {\n    return this.typeInternal;\n  }\n\n  data(): any {\n    return this.dataInternal;\n  }\n}\n\nexport class UISourceCodeMetadata {\n  modificationTime: Date|null;\n  contentSize: number|null;\n\n  constructor(modificationTime: Date|null, contentSize: number|null) {\n    this.modificationTime = modificationTime;\n    this.contentSize = contentSize;\n  }\n}\n"]}
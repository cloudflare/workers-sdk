{"version":3,"file":"NavigatorUserAgentIssue.js","sourceRoot":"","sources":["../../../../../../front_end/models/issues_manager/NavigatorUserAgentIssue.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,IAAI,MAAM,yBAAyB,CAAC;AAChD,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAG7C,OAAO,EAAC,KAAK,EAAE,aAAa,EAAE,SAAS,EAAC,MAAM,YAAY,CAAC;AAE3D,OAAO,EAAC,oBAAoB,EAAC,MAAM,kBAAkB,CAAC;AAEtD,MAAM,SAAS,GAAG;IAChB;;;OAGG;IACH,kBAAkB,EAAE,6BAA6B;CAClD,CAAC;AACF,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,kDAAkD,EAAE,SAAS,CAAC,CAAC;AACxG,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAEtE,wDAAwD;AACxD,+CAA+C;AAC/C,MAAM,CAAN,IAAY,SAEX;AAFD,WAAY,SAAS;IACnB,kFAAqE,CAAA;AACvE,CAAC,EAFW,SAAS,KAAT,SAAS,QAEpB;AAED,MAAM,OAAO,uBAAwB,SAAQ,KAAgB;IAC3D,aAAa,CAAiD;IAE9D,YAAY,YAA4D,EAAE,WAAwC;QAChH,KAAK,CAAC,SAAS,CAAC,uBAAuB,EAAE,WAAW,CAAC,CAAC;QACtD,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;IACpC,CAAC;IAED,WAAW;QACT,OAAO,aAAa,CAAC,KAAK,CAAC;IAC7B,CAAC;IAED,OAAO;QACL,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED,cAAc;QACZ,OAAO;YACL,IAAI,EAAE,kCAAkC;YACxC,KAAK,EAAE,CAAC;oBACN,IAAI,EAAE,oFAAoF;oBAC1F,SAAS,EAAE,UAAU,CAAC,SAAS,CAAC,kBAAkB,CAAC;iBACpD,CAAC;SACH,CAAC;IACJ,CAAC;IAED,OAAO;QACL,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE;YAC/B,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;SACtC;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,UAAU;QACR,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAC5C,CAAC;IAED,OAAO;QACL,OAAO,SAAS,CAAC,WAAW,CAAC;IAC/B,CAAC;IAED,oBAAoB;QAClB,MAAM,QAAQ,GAAG,GAAG,CAAC,YAAY,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,CAAC;QACxE,OAAO,oBAAoB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;IAChE,CAAC;IAED,MAAM,CAAC,kBAAkB,CAAC,WAAwC,EAAE,cAA8C;QAEhH,MAAM,OAAO,GAAG,cAAc,CAAC,OAAO,CAAC,8BAA8B,CAAC;QACtE,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC;YACnE,OAAO,EAAE,CAAC;SACX;QACD,OAAO,CAAC,IAAI,uBAAuB,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC,CAAC;IAC7D,CAAC;CACF","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport {Issue, IssueCategory, IssueKind} from './Issue.js';\nimport type {MarkdownIssueDescription} from './MarkdownIssueDescription.js';\nimport {isCausedByThirdParty} from './CookieIssue.js';\n\nconst UIStrings = {\n  /**\n   * @description Label for the link for User-Agent String reduction issues, that is, issues that are related to an\n   * upcoming reduction of information content in the user-agent string.\n   */\n  userAgentReduction: 'User-Agent String Reduction',\n};\nconst str_ = i18n.i18n.registerUIStrings('models/issues_manager/NavigatorUserAgentIssue.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum IssueCode {\n  NavigatorUserAgentIssue = 'DeprecationIssue::NavigatorUserAgentIssue',\n}\n\nexport class NavigatorUserAgentIssue extends Issue<IssueCode> {\n  #issueDetails: Protocol.Audits.NavigatorUserAgentIssueDetails;\n\n  constructor(issueDetails: Protocol.Audits.NavigatorUserAgentIssueDetails, issuesModel: SDK.IssuesModel.IssuesModel) {\n    super(IssueCode.NavigatorUserAgentIssue, issuesModel);\n    this.#issueDetails = issueDetails;\n  }\n\n  getCategory(): IssueCategory {\n    return IssueCategory.Other;\n  }\n\n  details(): Protocol.Audits.NavigatorUserAgentIssueDetails {\n    return this.#issueDetails;\n  }\n\n  getDescription(): MarkdownIssueDescription|null {\n    return {\n      file: 'deprecationNavigatorUserAgent.md',\n      links: [{\n        link: 'https://blog.chromium.org/2021/09/user-agent-reduction-origin-trial-and-dates.html',\n        linkTitle: i18nString(UIStrings.userAgentReduction),\n      }],\n    };\n  }\n\n  sources(): Iterable<Protocol.Audits.SourceCodeLocation> {\n    if (this.#issueDetails.location) {\n      return [this.#issueDetails.location];\n    }\n    return [];\n  }\n\n  primaryKey(): string {\n    return JSON.stringify(this.#issueDetails);\n  }\n\n  getKind(): IssueKind {\n    return IssueKind.Improvement;\n  }\n\n  isCausedByThirdParty(): boolean {\n    const topFrame = SDK.FrameManager.FrameManager.instance().getTopFrame();\n    return isCausedByThirdParty(topFrame, this.#issueDetails.url);\n  }\n\n  static fromInspectorIssue(issuesModel: SDK.IssuesModel.IssuesModel, inspectorIssue: Protocol.Audits.InspectorIssue):\n      NavigatorUserAgentIssue[] {\n    const details = inspectorIssue.details.navigatorUserAgentIssueDetails;\n    if (!details) {\n      console.warn('NavigatorUserAgent issue without details received.');\n      return [];\n    }\n    return [new NavigatorUserAgentIssue(details, issuesModel)];\n  }\n}\n"]}
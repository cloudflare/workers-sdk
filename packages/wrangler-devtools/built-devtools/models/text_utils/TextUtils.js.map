{"version":3,"file":"TextUtils.js","sourceRoot":"","sources":["../../../../../../front_end/models/text_utils/TextUtils.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2013 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Platform from '../../core/platform/platform.js';\n\nimport {SearchMatch} from './ContentProvider.js';\nimport {Text} from './Text.js';\n\nexport const Utils = {\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  get _keyValueFilterRegex(): RegExp {\n    return /(?:^|\\s)(\\-)?([\\w\\-]+):([^\\s]+)/;\n  },\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  get _regexFilterRegex(): RegExp {\n    return /(?:^|\\s)(\\-)?\\/([^\\s]+)\\//;\n  },\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  get _textFilterRegex(): RegExp {\n    return /(?:^|\\s)(\\-)?([^\\s]+)/;\n  },\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  get _SpaceCharRegex(): RegExp {\n    return /\\s/;\n  },\n  /**\n   * @enum {string}\n   */\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  get Indent(): {TwoSpaces: '  ', FourSpaces: '    ', EightSpaces: '        ', TabCharacter: '\\t'} {\n    return {TwoSpaces: '  ', FourSpaces: '    ', EightSpaces: '        ', TabCharacter: '\\t'};\n  },\n\n  isStopChar: function(char: string): boolean {\n    return (char > ' ' && char < '0') || (char > '9' && char < 'A') || (char > 'Z' && char < '_') ||\n        (char > '_' && char < 'a') || (char > 'z' && char <= '~');\n  },\n\n  isWordChar: function(char: string): boolean {\n    return !Utils.isStopChar(char) && !Utils.isSpaceChar(char);\n  },\n\n  isSpaceChar: function(char: string): boolean {\n    return Utils._SpaceCharRegex.test(char);\n  },\n\n  isWord: function(word: string): boolean {\n    for (let i = 0; i < word.length; ++i) {\n      if (!Utils.isWordChar(word.charAt(i))) {\n        return false;\n      }\n    }\n    return true;\n  },\n\n  isOpeningBraceChar: function(char: string): boolean {\n    return char === '(' || char === '{';\n  },\n\n  isClosingBraceChar: function(char: string): boolean {\n    return char === ')' || char === '}';\n  },\n\n  isBraceChar: function(char: string): boolean {\n    return Utils.isOpeningBraceChar(char) || Utils.isClosingBraceChar(char);\n  },\n\n  textToWords: function(text: string, isWordChar: (arg0: string) => boolean, wordCallback: (arg0: string) => void):\n      void {\n        let startWord = -1;\n        for (let i = 0; i < text.length; ++i) {\n          if (!isWordChar(text.charAt(i))) {\n            if (startWord !== -1) {\n              wordCallback(text.substring(startWord, i));\n            }\n            startWord = -1;\n          } else if (startWord === -1) {\n            startWord = i;\n          }\n        }\n        if (startWord !== -1) {\n          wordCallback(text.substring(startWord));\n        }\n      },\n\n  lineIndent: function(line: string): string {\n    let indentation = 0;\n    while (indentation < line.length && Utils.isSpaceChar(line.charAt(indentation))) {\n      ++indentation;\n    }\n    return line.substr(0, indentation);\n  },\n\n  isUpperCase: function(text: string): boolean {\n    return text === text.toUpperCase();\n  },\n\n  isLowerCase: function(text: string): boolean {\n    return text === text.toLowerCase();\n  },\n\n  splitStringByRegexes(text: string, regexes: RegExp[]): {\n    value: string,\n    position: number,\n    regexIndex: number,\n    captureGroups: Array<string|undefined>,\n  }[] {\n    const matches: {\n      value: string,\n      position: number,\n      regexIndex: number,\n      captureGroups: (string|undefined)[],\n    }[] = [];\n    const globalRegexes: RegExp[] = [];\n    for (let i = 0; i < regexes.length; i++) {\n      const regex = regexes[i];\n      if (!regex.global) {\n        globalRegexes.push(new RegExp(regex.source, regex.flags ? regex.flags + 'g' : 'g'));\n      } else {\n        globalRegexes.push(regex);\n      }\n    }\n    doSplit(text, 0, 0);\n    return matches;\n\n    function doSplit(text: string, regexIndex: number, startIndex: number): void {\n      if (regexIndex >= globalRegexes.length) {\n        // Set regexIndex as -1 if text did not match with any regular expression\n        matches.push({value: text, position: startIndex, regexIndex: -1, captureGroups: []});\n        return;\n      }\n      const regex = globalRegexes[regexIndex];\n      let currentIndex = 0;\n      let result;\n      regex.lastIndex = 0;\n      while ((result = regex.exec(text)) !== null) {\n        const stringBeforeMatch = text.substring(currentIndex, result.index);\n        if (stringBeforeMatch) {\n          doSplit(stringBeforeMatch, regexIndex + 1, startIndex + currentIndex);\n        }\n        const match = result[0];\n        matches.push({\n          value: match,\n          position: startIndex + result.index,\n          regexIndex: regexIndex,\n          captureGroups: result.slice(1),\n        });\n        currentIndex = result.index + match.length;\n      }\n      const stringAfterMatches = text.substring(currentIndex);\n      if (stringAfterMatches) {\n        doSplit(stringAfterMatches, regexIndex + 1, startIndex + currentIndex);\n      }\n    }\n  },\n};\n\nexport class FilterParser {\n  private readonly keys: string[];\n  constructor(keys: string[]) {\n    this.keys = keys;\n  }\n\n  static cloneFilter(filter: ParsedFilter): ParsedFilter {\n    return {key: filter.key, text: filter.text, regex: filter.regex, negative: filter.negative};\n  }\n\n  parse(query: string): ParsedFilter[] {\n    const splitFilters = Utils.splitStringByRegexes(\n        query, [Utils._keyValueFilterRegex, Utils._regexFilterRegex, Utils._textFilterRegex]);\n    const parsedFilters: ParsedFilter[] = [];\n    for (const {regexIndex, captureGroups} of splitFilters) {\n      if (regexIndex === -1) {\n        continue;\n      }\n      if (regexIndex === 0) {\n        const startsWithMinus = captureGroups[0];\n        const parsedKey = captureGroups[1];\n        const parsedValue = captureGroups[2];\n        if (this.keys.indexOf((parsedKey as string)) !== -1) {\n          parsedFilters.push({\n            key: parsedKey,\n            regex: undefined,\n            text: parsedValue,\n            negative: Boolean(startsWithMinus),\n          });\n        } else {\n          parsedFilters.push({\n            key: undefined,\n            regex: undefined,\n            text: `${parsedKey}:${parsedValue}`,\n            negative: Boolean(startsWithMinus),\n          });\n        }\n      } else if (regexIndex === 1) {\n        const startsWithMinus = captureGroups[0];\n        const parsedRegex = captureGroups[1];\n        try {\n          parsedFilters.push({\n            key: undefined,\n            regex: new RegExp((parsedRegex as string), 'i'),\n            text: undefined,\n            negative: Boolean(startsWithMinus),\n          });\n        } catch (e) {\n          parsedFilters.push({\n            key: undefined,\n            regex: undefined,\n            text: `/${parsedRegex}/`,\n            negative: Boolean(startsWithMinus),\n          });\n        }\n      } else if (regexIndex === 2) {\n        const startsWithMinus = captureGroups[0];\n        const parsedText = captureGroups[1];\n        parsedFilters.push({\n          key: undefined,\n          regex: undefined,\n          text: parsedText,\n          negative: Boolean(startsWithMinus),\n        });\n      }\n    }\n    return parsedFilters;\n  }\n}\n\nexport class BalancedJSONTokenizer {\n  private readonly callback: (arg0: string) => void;\n  private index: number;\n  private balance: number;\n  private buffer: string;\n  private findMultiple: boolean;\n  private closingDoubleQuoteRegex: RegExp;\n  private lastBalancedIndex?: number;\n  constructor(callback: (arg0: string) => void, findMultiple?: boolean) {\n    this.callback = callback;\n    this.index = 0;\n    this.balance = 0;\n    this.buffer = '';\n    this.findMultiple = findMultiple || false;\n    this.closingDoubleQuoteRegex = /[^\\\\](?:\\\\\\\\)*\"/g;\n  }\n\n  write(chunk: string): boolean {\n    this.buffer += chunk;\n    const lastIndex = this.buffer.length;\n    const buffer = this.buffer;\n    let index;\n    for (index = this.index; index < lastIndex; ++index) {\n      const character = buffer[index];\n      if (character === '\"') {\n        this.closingDoubleQuoteRegex.lastIndex = index;\n        if (!this.closingDoubleQuoteRegex.test(buffer)) {\n          break;\n        }\n        index = this.closingDoubleQuoteRegex.lastIndex - 1;\n      } else if (character === '{') {\n        ++this.balance;\n      } else if (character === '}') {\n        --this.balance;\n        if (this.balance < 0) {\n          this.reportBalanced();\n          return false;\n        }\n        if (!this.balance) {\n          this.lastBalancedIndex = index + 1;\n          if (!this.findMultiple) {\n            break;\n          }\n        }\n      } else if (character === ']' && !this.balance) {\n        this.reportBalanced();\n        return false;\n      }\n    }\n    this.index = index;\n    this.reportBalanced();\n    return true;\n  }\n\n  private reportBalanced(): void {\n    if (!this.lastBalancedIndex) {\n      return;\n    }\n    this.callback(this.buffer.slice(0, this.lastBalancedIndex));\n    this.buffer = this.buffer.slice(this.lastBalancedIndex);\n    this.index -= this.lastBalancedIndex;\n    this.lastBalancedIndex = 0;\n  }\n\n  remainder(): string {\n    return this.buffer;\n  }\n}\n\nexport interface TokenizerFactory {\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  createTokenizer(mimeType: string):\n      (arg0: string, arg1: (arg0: string, arg1: string|null, arg2: number, arg3: number) => void) => void;\n}\n\nexport function isMinified(text: string): boolean {\n  const kMaxNonMinifiedLength = 500;\n  let linesToCheck = 10;\n  let lastPosition = 0;\n  do {\n    let eolIndex = text.indexOf('\\n', lastPosition);\n    if (eolIndex < 0) {\n      eolIndex = text.length;\n    }\n    if (eolIndex - lastPosition > kMaxNonMinifiedLength && text.substr(lastPosition, 3) !== '//#') {\n      return true;\n    }\n    lastPosition = eolIndex + 1;\n  } while (--linesToCheck >= 0 && lastPosition < text.length);\n\n  // Check the end of the text as well\n  linesToCheck = 10;\n  lastPosition = text.length;\n  do {\n    let eolIndex = text.lastIndexOf('\\n', lastPosition);\n    if (eolIndex < 0) {\n      eolIndex = 0;\n    }\n    if (lastPosition - eolIndex > kMaxNonMinifiedLength && text.substr(lastPosition, 3) !== '//#') {\n      return true;\n    }\n    lastPosition = eolIndex - 1;\n  } while (--linesToCheck >= 0 && lastPosition > 0);\n  return false;\n}\n\nexport const performSearchInContent = function(\n    content: string, query: string, caseSensitive: boolean, isRegex: boolean): SearchMatch[] {\n  const regex = Platform.StringUtilities.createSearchRegex(query, caseSensitive, isRegex);\n\n  const text = new Text(content);\n  const result = [];\n  for (let i = 0; i < text.lineCount(); ++i) {\n    const lineContent = text.lineAt(i);\n    regex.lastIndex = 0;\n    const match = regex.exec(lineContent);\n    if (match) {\n      result.push(new SearchMatch(i, lineContent, match.index));\n    }\n  }\n  return result;\n};\nexport interface ParsedFilter {\n  key?: string;\n  text?: string|null;\n  regex?: RegExp;\n  negative: boolean;\n}\n"]}
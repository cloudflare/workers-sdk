{"version":3,"file":"TimelineLayersView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineLayersView.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAK7B,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAChD,OAAO,KAAK,WAAW,MAAM,iCAAiC,CAAC;AAE/D,MAAM,OAAO,kBAAmB,SAAQ,EAAE,CAAC,WAAW,CAAC,WAAW;IAC/C,KAAK,CAAgD;IACrD,yBAAyB,CAA0D;IACnF,gBAAgB,CAA6B;IAC7C,aAAa,CAA0C;IACvD,YAAY,CAAwC;IAC7D,cAAc,CAA0D;IACxE,iBAAiB,CAAW;IACpC,YACI,KAAoD,EACpD,yBAAkF;QACpF,KAAK,CAAC,IAAI,EAAE,KAAK,EAAE,oBAAoB,CAAC,CAAC;QACzC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;QAE3D,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;QACnD,IAAI,CAAC,gBAAgB,GAAG,IAAI,EAAE,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,2BAA2B,CAAC,CAAC;QAChG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,iCAAiC,CAAC,CAAC;QAC/E,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAE1C,MAAM,IAAI,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;QAClC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;QAE5B,IAAI,CAAC,aAAa,GAAG,IAAI,WAAW,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC;QAEnE,MAAM,gBAAgB,GAAG,IAAI,WAAW,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAC/F,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;QAEnD,IAAI,CAAC,YAAY,GAAG,IAAI,WAAW,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAClF,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAC9B,WAAW,CAAC,YAAY,CAAC,MAAM,CAAC,sBAAsB,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;QACjG,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAEvD,MAAM,gBAAgB,GAAG,IAAI,WAAW,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAC/F,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC;QACzD,gBAAgB,CAAC,gBAAgB,CAC7B,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,sBAAsB,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;IACvG,CAAC;IAED,aAAa,CAAC,cAAsE;QAClF,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;QACrC,IAAI,IAAI,CAAC,SAAS,EAAE,EAAE;YACpB,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;aAAM;YACL,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;SAC/B;IACH,CAAC;IAED,QAAQ;QACN,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;YAC/B,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;IACH,CAAC;IAEO,KAAK,CAAC,wBAAwB,CAClC,KAA+E;QACjF,MAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC;QAC7B,MAAM,gBAAgB,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;QACjF,IAAI,gBAAgB,EAAE;YACpB,IAAI,CAAC,yBAAyB,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;SAC3D;IACH,CAAC;IAEO,MAAM;QACZ,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,KAAK,IAAI,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC;SAC3G;IACH,CAAC;CACF","sourcesContent":["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Common from '../../core/common/common.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport type * as TimelineModel from '../../models/timeline_model/timeline_model.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as LayerViewer from '../layer_viewer/layer_viewer.js';\n\nexport class TimelineLayersView extends UI.SplitWidget.SplitWidget {\n  private readonly model: TimelineModel.TimelineModel.TimelineModelImpl;\n  private readonly showPaintProfilerCallback: (arg0: SDK.PaintProfiler.PaintProfilerSnapshot) => void;\n  private readonly rightSplitWidget: UI.SplitWidget.SplitWidget;\n  private readonly layerViewHost: LayerViewer.LayerViewHost.LayerViewHost;\n  private readonly layers3DView: LayerViewer.Layers3DView.Layers3DView;\n  private frameLayerTree?: TimelineModel.TimelineFrameModel.TracingFrameLayerTree;\n  private updateWhenVisible?: boolean;\n  constructor(\n      model: TimelineModel.TimelineModel.TimelineModelImpl,\n      showPaintProfilerCallback: (arg0: SDK.PaintProfiler.PaintProfilerSnapshot) => void) {\n    super(true, false, 'timelineLayersView');\n    this.model = model;\n    this.showPaintProfilerCallback = showPaintProfilerCallback;\n\n    this.element.classList.add('timeline-layers-view');\n    this.rightSplitWidget = new UI.SplitWidget.SplitWidget(true, true, 'timelineLayersViewDetails');\n    this.rightSplitWidget.element.classList.add('timeline-layers-view-properties');\n    this.setMainWidget(this.rightSplitWidget);\n\n    const vbox = new UI.Widget.VBox();\n    this.setSidebarWidget(vbox);\n\n    this.layerViewHost = new LayerViewer.LayerViewHost.LayerViewHost();\n\n    const layerTreeOutline = new LayerViewer.LayerTreeOutline.LayerTreeOutline(this.layerViewHost);\n    vbox.element.appendChild(layerTreeOutline.element);\n\n    this.layers3DView = new LayerViewer.Layers3DView.Layers3DView(this.layerViewHost);\n    this.layers3DView.addEventListener(\n        LayerViewer.Layers3DView.Events.PaintProfilerRequested, this.onPaintProfilerRequested, this);\n    this.rightSplitWidget.setMainWidget(this.layers3DView);\n\n    const layerDetailsView = new LayerViewer.LayerDetailsView.LayerDetailsView(this.layerViewHost);\n    this.rightSplitWidget.setSidebarWidget(layerDetailsView);\n    layerDetailsView.addEventListener(\n        LayerViewer.LayerDetailsView.Events.PaintProfilerRequested, this.onPaintProfilerRequested, this);\n  }\n\n  showLayerTree(frameLayerTree: TimelineModel.TimelineFrameModel.TracingFrameLayerTree): void {\n    this.frameLayerTree = frameLayerTree;\n    if (this.isShowing()) {\n      this.update();\n    } else {\n      this.updateWhenVisible = true;\n    }\n  }\n\n  wasShown(): void {\n    if (this.updateWhenVisible) {\n      this.updateWhenVisible = false;\n      this.update();\n    }\n  }\n\n  private async onPaintProfilerRequested(\n      event: Common.EventTarget.EventTargetEvent<LayerViewer.LayerViewHost.Selection>): Promise<void> {\n    const selection = event.data;\n    const snapshotWithRect = await this.layers3DView.snapshotForSelection(selection);\n    if (snapshotWithRect) {\n      this.showPaintProfilerCallback(snapshotWithRect.snapshot);\n    }\n  }\n\n  private update(): void {\n    if (this.frameLayerTree) {\n      void this.frameLayerTree.layerTreePromise().then(layerTree => this.layerViewHost.setLayerTree(layerTree));\n    }\n  }\n}\n"]}
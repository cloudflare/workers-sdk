{"version":3,"file":"ReportsGrid.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/ReportsGrid.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as DataGrid from '../../../ui/components/data_grid/data_grid.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nimport type * as Protocol from '../../../generated/protocol.js';\nimport * as Root from '../../../core/root/root.js';\n\nimport reportingApiGridStyles from './reportingApiGrid.css.js';\n\nconst UIStrings = {\n  /**\n  *@description Placeholder text when there are no Reporting API reports.\n  *(https://developers.google.com/web/updates/2018/09/reportingapi#sending)\n  */\n  noReportsToDisplay: 'No reports to display',\n  /**\n  *@description Column header for a table displaying Reporting API reports.\n  *Status is one of 'Queued', 'Pending', 'MarkedForRemoval' or 'Success'.\n  */\n  status: 'Status',\n  /**\n  *@description Column header for a table displaying Reporting API reports.\n  *Destination is the name of the endpoint the report is being sent to.\n  */\n  destination: 'Destination',\n  /**\n  *@description Column header for a table displaying Reporting API reports.\n  *The column contains the timestamp of when a report was generated.\n  */\n  generatedAt: 'Generated at',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/application/components/ReportsGrid.ts', UIStrings);\nexport const i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst {render, html} = LitHtml;\n\nexport class ReportsGridStatusHeader extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-reports-grid-status-header`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [reportingApiGridStyles];\n    this.#render();\n  }\n\n  #render(): void {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      ${i18nString(UIStrings.status)}\n      <x-link href=\"https://web.dev/reporting-api/#report-status\">\n        <${IconButton.Icon.Icon.litTagName} class=\"inline-icon\" .data=${{\n          iconName: 'help_outline',\n          color: 'var(--color-primary)',\n          width: '16px',\n          height: '16px',\n          } as IconButton.Icon.IconData}></${IconButton.Icon.Icon.litTagName}>\n      </x-link>\n    `, this.#shadow, {host: this});\n    // clang-format on\n  }\n}\n\nexport interface ReportsGridData {\n  reports: Protocol.Network.ReportingApiReport[];\n}\n\nexport class ReportsGrid extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-reports-grid`;\n\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #reports: Protocol.Network.ReportingApiReport[] = [];\n  #protocolMonitorExperimentEnabled = false;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [reportingApiGridStyles];\n    this.#protocolMonitorExperimentEnabled = Root.Runtime.experiments.isEnabled('protocolMonitor');\n    this.#render();\n  }\n\n  set data(data: ReportsGridData) {\n    this.#reports = data.reports;\n    this.#render();\n  }\n\n  #render(): void {\n    const reportsGridData: DataGrid.DataGridController.DataGridControllerData = {\n      columns: [\n        {\n          id: 'url',\n          title: i18n.i18n.lockedString('URL'),\n          widthWeighting: 30,\n          hideable: false,\n          visible: true,\n        },\n        {\n          id: 'type',\n          title: i18n.i18n.lockedString('Type'),\n          widthWeighting: 20,\n          hideable: false,\n          visible: true,\n        },\n        {\n          id: 'status',\n          title: i18nString(UIStrings.status),\n          widthWeighting: 20,\n          hideable: false,\n          visible: true,\n          titleElement: html`\n          <${ReportsGridStatusHeader.litTagName}></${ReportsGridStatusHeader.litTagName}>\n          `,\n        },\n        {\n          id: 'destination',\n          title: i18nString(UIStrings.destination),\n          widthWeighting: 20,\n          hideable: false,\n          visible: true,\n        },\n        {\n          id: 'timestamp',\n          title: i18nString(UIStrings.generatedAt),\n          widthWeighting: 20,\n          hideable: false,\n          visible: true,\n        },\n        {\n          id: 'body',\n          title: i18n.i18n.lockedString('Body'),\n          widthWeighting: 20,\n          hideable: false,\n          visible: true,\n        },\n      ],\n      rows: this.#buildReportRows(),\n    };\n\n    if (this.#protocolMonitorExperimentEnabled) {\n      reportsGridData.columns.unshift(\n          {id: 'id', title: 'ID', widthWeighting: 30, hideable: false, visible: true},\n      );\n    }\n\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <div class=\"reporting-container\">\n        <div class=\"reporting-header\">${i18n.i18n.lockedString('Reports')}</div>\n        ${this.#reports.length > 0 ? html`\n          <${DataGrid.DataGridController.DataGridController.litTagName} .data=${\n              reportsGridData as DataGrid.DataGridController.DataGridControllerData}>\n          </${DataGrid.DataGridController.DataGridController.litTagName}>\n        ` : html`\n          <div class=\"reporting-placeholder\">\n            <div>${i18nString(UIStrings.noReportsToDisplay)}</div>\n          </div>\n        `}\n      </div>\n    `, this.#shadow, {host: this});\n    // clang-format on\n  }\n\n  #buildReportRows(): DataGrid.DataGridUtils.Row[] {\n    return this.#reports.map(report => ({\n                               cells: [\n                                 {columnId: 'id', value: report.id},\n                                 {columnId: 'url', value: report.initiatorUrl},\n                                 {columnId: 'type', value: report.type},\n                                 {columnId: 'status', value: report.status},\n                                 {columnId: 'destination', value: report.destination},\n                                 {columnId: 'timestamp', value: new Date(report.timestamp * 1000).toLocaleString()},\n                                 {columnId: 'body', value: JSON.stringify(report.body)},\n                               ],\n                             }));\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent(\n    'devtools-resources-reports-grid-status-header', ReportsGridStatusHeader);\nComponentHelpers.CustomElements.defineComponent('devtools-resources-reports-grid', ReportsGrid);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-resources-reports-grid-status-header': ReportsGridStatusHeader;\n    'devtools-resources-reports-grid': ReportsGrid;\n  }\n}\n"]}
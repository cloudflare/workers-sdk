{"version":3,"file":"OriginTrialTreeView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/OriginTrialTreeView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport * as Adorners from '../../../ui/components/adorners/adorners.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as TreeOutline from '../../../ui/components/tree_outline/tree_outline.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nimport badgeStyles from './badge.css.js';\nimport originTrialTokenRowsStyles from './originTrialTokenRows.css.js';\nimport originTrialTreeViewStyles from './originTrialTreeView.css.js';\n\nconst UIStrings = {\n  /**\n  *@description Label for the 'origin' field in a parsed Origin Trial Token.\n  */\n  origin: 'Origin',\n  /**\n   *@description Label for `trialName` field in a parsed Origin Trial Token.\n   * This field is only shown when token has unknown trial name as the token\n   * will be put into 'UNKNOWN' group.\n   */\n  trialName: 'Trial Name',\n  /**\n   *@description Label for `expiryTime` field in a parsed Origin Trial Token.\n   */\n  expiryTime: 'Expiry Time',\n  /**\n   *@description Label for `usageRestriction` field in a parsed Origin Trial Token.\n   */\n  usageRestriction: 'Usage Restriction',\n  /**\n   *@description Label for `isThirdParty` field in a parsed Origin Trial Token.\n   */\n  isThirdParty: 'Third Party',\n  /**\n   *@description Label for a field containing info about an Origin Trial Token's `matchSubDomains` field.\n   *An Origin Trial Token contains an origin URL. The `matchSubDomains` field describes whether the token\n   *only applies to the origin URL or to all subdomains of the origin URL as well.\n   *The field contains either 'true' or 'false'.\n   */\n  matchSubDomains: 'Subdomain Matching',\n  /**\n   *@description Label for the raw(= encoded / not human-readable) Origin Trial Token.\n   */\n  rawTokenText: 'Raw Token',\n  /**\n   *@description Label for `status` field in an Origin Trial Token.\n   */\n  status: 'Token Status',\n  /**\n   *@description Label for tokenWithStatus node.\n   */\n  token: 'Token',\n  /**\n   *@description Label for a badge showing the number of Origin Trial Tokens. This number is always greater than 1.\n   *@example {2} PH1\n   */\n  tokens: '{PH1} tokens',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/application/components/OriginTrialTreeView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface BadgeData {\n  badgeContent: string;\n  style: 'error'|'success'|'secondary';\n}\n\nexport class Badge extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-origin-trial-tree-view-badge`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #adorner = new Adorners.Adorner.Adorner();\n\n  set data(data: BadgeData) {\n    this.#render(data);\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [badgeStyles];\n  }\n\n  #render(data: BadgeData): void {\n    const adornerContent = document.createElement('span');\n    adornerContent.textContent = data.badgeContent;\n    this.#adorner.data = {\n      name: 'badge',\n      content: adornerContent,\n    };\n    this.#adorner.classList.add(`badge-${data.style}`);\n\n    LitHtml.render(\n        LitHtml.html`\n      ${this.#adorner}\n    `,\n        this.#shadow, {host: this});\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-resources-origin-trial-tree-view-badge', Badge);\n\ntype TreeNode<DataType> = TreeOutline.TreeOutlineUtils.TreeNode<DataType>;\n\n// The Origin Trial Tree has 4 levels of content:\n// - Origin Trial (has multiple Origin Trial tokens)\n// - Origin Trial Token (has only 1 raw token text)\n// - Fields in Origin Trial Token\n// - Raw Origin Trial Token text (folded because the content is long)\nexport type OriginTrialTreeNodeData = Protocol.Page.OriginTrial|Protocol.Page.OriginTrialTokenWithStatus|string;\n\nfunction constructOriginTrialTree(originTrial: Protocol.Page.OriginTrial): TreeNode<OriginTrialTreeNodeData> {\n  return {\n    treeNodeData: originTrial,\n    id: 'OriginTrialTreeNode#' + originTrial.trialName,\n    children: async(): Promise<TreeNode<OriginTrialTreeNodeData>[]> => originTrial.tokensWithStatus.length > 1 ?\n        originTrial.tokensWithStatus.map(constructTokenNode) :\n        constructTokenDetailsNodes(originTrial.tokensWithStatus[0]),\n    renderer: (node: TreeNode<OriginTrialTreeNodeData>): LitHtml.TemplateResult => {\n      const trial = node.treeNodeData as Protocol.Page.OriginTrial;\n      const tokenCountBadge = LitHtml.html`\n        <${Badge.litTagName} .data=${{\n        badgeContent: i18nString(UIStrings.tokens, {PH1: trial.tokensWithStatus.length}),\n        style: 'secondary',\n      } as BadgeData}></${Badge.litTagName}>\n      `;\n\n      return LitHtml.html`\n        ${trial.trialName}\n        <${Badge.litTagName} .data=${{\n        badgeContent: trial.status,\n        style: trial.status === Protocol.Page.OriginTrialStatus.Enabled ? 'success' : 'error',\n      } as BadgeData}></${Badge.litTagName}>\n        ${trial.tokensWithStatus.length > 1 ? tokenCountBadge : LitHtml.nothing}\n      `;\n    },\n  };\n}\n\nfunction constructTokenNode(token: Protocol.Page.OriginTrialTokenWithStatus): TreeNode<OriginTrialTreeNodeData> {\n  return {\n    treeNodeData: token.status,\n    id: 'TokenNode#' + token.rawTokenText,\n    children: async(): Promise<TreeNode<OriginTrialTreeNodeData>[]> => constructTokenDetailsNodes(token),\n    renderer: (node: TreeNode<OriginTrialTreeNodeData>, state: {isExpanded: boolean}): LitHtml.TemplateResult => {\n      const tokenStatus = node.treeNodeData as string;\n      const statusBadge = LitHtml.html`\n        <${Badge.litTagName} .data=${{\n        badgeContent: tokenStatus,\n        style: tokenStatus === Protocol.Page.OriginTrialTokenStatus.Success ? 'success' : 'error',\n      } as BadgeData}></${Badge.litTagName}>\n      `;\n      // Only display token status for convenience when the node is not expanded.\n      return LitHtml.html`${i18nString(UIStrings.token)} ${state.isExpanded ? LitHtml.nothing : statusBadge}`;\n    },\n  };\n}\n\ninterface TokenField {\n  name: string;\n  value: LitHtml.TemplateResult;\n}\n\nfunction renderTokenDetails(node: TreeNode<OriginTrialTreeNodeData>): LitHtml.TemplateResult {\n  return LitHtml.html`\n    <${OriginTrialTokenRows.litTagName} .data=${{node: node} as OriginTrialTokenRowsData}>\n    </${OriginTrialTokenRows.litTagName}>\n    `;\n}\n\nfunction constructTokenDetailsNodes(token: Protocol.Page.OriginTrialTokenWithStatus):\n    TreeNode<OriginTrialTreeNodeData>[] {\n  return [\n    {\n      treeNodeData: token,\n      id: 'TokenDetailsNode#' + token.rawTokenText,\n      renderer: renderTokenDetails,\n    },\n    constructRawTokenTextNode(token.rawTokenText),\n  ];\n}\n\nfunction constructRawTokenTextNode(tokenText: string): TreeNode<OriginTrialTreeNodeData> {\n  return {\n    treeNodeData: i18nString(UIStrings.rawTokenText),\n    id: 'TokenRawTextContainerNode#' + tokenText,\n    children: async(): Promise<TreeNode<OriginTrialTreeNodeData>[]> => [{\n      treeNodeData: tokenText,\n      id: 'TokenRawTextNode#' + tokenText,\n      renderer: (data: TreeNode<OriginTrialTreeNodeData>): LitHtml.TemplateResult => {\n        const tokenText = data.treeNodeData as string;\n        return LitHtml.html`\n        <div style=\"overflow-wrap: break-word;\">\n          ${tokenText}\n        </div>\n        `;\n      },\n    }],\n  };\n}\n\nfunction defaultRenderer(node: TreeNode<OriginTrialTreeNodeData>): LitHtml.TemplateResult {\n  return LitHtml.html`${String(node.treeNodeData)}`;\n}\n\nexport interface OriginTrialTokenRowsData {\n  node: TreeNode<OriginTrialTreeNodeData>;\n}\n\nexport class OriginTrialTokenRows extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-origin-trial-token-rows`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #tokenWithStatus: Protocol.Page.OriginTrialTokenWithStatus|null = null;\n  #parsedTokenDetails: TokenField[] = [];\n  #dateFormatter: Intl.DateTimeFormat = new Intl.DateTimeFormat(\n      i18n.DevToolsLocale.DevToolsLocale.instance().locale,\n      {dateStyle: 'long', timeStyle: 'long'},\n  );\n\n  set data(data: OriginTrialTokenRowsData) {\n    this.#tokenWithStatus = data.node.treeNodeData as Protocol.Page.OriginTrialTokenWithStatus;\n    this.#setTokenFields();\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [originTrialTokenRowsStyles];\n    this.#render();\n  }\n\n  #renderTokenField = (fieldValue: string, hasError?: boolean): LitHtml.TemplateResult => LitHtml.html`\n        <div class=${LitHtml.Directives.ifDefined(hasError ? 'error-text' : undefined)}>\n          ${fieldValue}\n        </div>`;\n\n  #setTokenFields(): void {\n    if (!this.#tokenWithStatus?.parsedToken) {\n      return;\n    }\n    this.#parsedTokenDetails = [\n      {\n        name: i18nString(UIStrings.origin),\n        value: this.#renderTokenField(\n            this.#tokenWithStatus.parsedToken.origin,\n            this.#tokenWithStatus.status === Protocol.Page.OriginTrialTokenStatus.WrongOrigin),\n      },\n      {\n        name: i18nString(UIStrings.expiryTime),\n        value: this.#renderTokenField(\n            this.#dateFormatter.format(this.#tokenWithStatus.parsedToken.expiryTime * 1000),\n            this.#tokenWithStatus.status === Protocol.Page.OriginTrialTokenStatus.Expired),\n      },\n      {\n        name: i18nString(UIStrings.usageRestriction),\n        value: this.#renderTokenField(this.#tokenWithStatus.parsedToken.usageRestriction),\n      },\n      {\n        name: i18nString(UIStrings.isThirdParty),\n        value: this.#renderTokenField(this.#tokenWithStatus.parsedToken.isThirdParty.toString()),\n      },\n      {\n        name: i18nString(UIStrings.matchSubDomains),\n        value: this.#renderTokenField(this.#tokenWithStatus.parsedToken.matchSubDomains.toString()),\n      },\n    ];\n\n    if (this.#tokenWithStatus.status === Protocol.Page.OriginTrialTokenStatus.UnknownTrial) {\n      this.#parsedTokenDetails = [\n        {\n          name: i18nString(UIStrings.trialName),\n          value: this.#renderTokenField(this.#tokenWithStatus.parsedToken.trialName),\n        },\n        ...this.#parsedTokenDetails,\n      ];\n    }\n  }\n\n  #render(): void {\n    if (!this.#tokenWithStatus) {\n      return;\n    }\n\n    const tokenDetails: TokenField[] = [\n      {\n        name: i18nString(UIStrings.status),\n        value: LitHtml.html`\n          <${Badge.litTagName} .data=${{\n          badgeContent: this.#tokenWithStatus.status,\n          style: this.#tokenWithStatus.status === Protocol.Page.OriginTrialTokenStatus.Success ? 'success' : 'error',\n        } as BadgeData}></${Badge.litTagName}>`,\n      },\n      ...this.#parsedTokenDetails,\n    ];\n\n    const tokenDetailRows = tokenDetails.map((field: TokenField): LitHtml.TemplateResult => {\n      return LitHtml.html`\n          <div class=\"key\">${field.name}</div>\n          <div class=\"value\">${field.value}</div>\n          `;\n    });\n\n    LitHtml.render(\n        LitHtml.html`\n      <div class=\"content\">\n        ${tokenDetailRows}\n      </div>\n    `,\n        this.#shadow, {host: this});\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-resources-origin-trial-token-rows', OriginTrialTokenRows);\n\nexport interface OriginTrialTreeViewData {\n  trials: Protocol.Page.OriginTrial[];\n}\n\nexport class OriginTrialTreeView extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-origin-trial-tree-view`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  set data(data: OriginTrialTreeViewData) {\n    this.#render(data.trials);\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [originTrialTreeViewStyles];\n  }\n\n  #render(trials: Protocol.Page.OriginTrial[]): void {\n    if (!trials.length) {\n      return;\n    }\n\n    LitHtml.render(\n        LitHtml.html`\n      <${TreeOutline.TreeOutline.TreeOutline.litTagName} .data=${{\n          tree: trials.map(constructOriginTrialTree),\n          defaultRenderer,\n        } as TreeOutline.TreeOutline.TreeOutlineData<OriginTrialTreeNodeData>}>\n      </${TreeOutline.TreeOutline.TreeOutline.litTagName}>\n    `,\n        this.#shadow, {host: this});\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-resources-origin-trial-tree-view', OriginTrialTreeView);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-resources-origin-trial-tree-view': OriginTrialTreeView;\n    'devtools-resources-origin-trial-token-rows': OriginTrialTokenRows;\n    'devtools-resources-origin-trial-tree-view-badge': Badge;\n  }\n}\n"]}
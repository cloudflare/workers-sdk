{"version":3,"file":"AnimationGroupPreviewUI.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationGroupPreviewUI.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as UI from '../../ui/legacy/legacy.js';\nimport type {AnimationGroup} from './AnimationModel.js';\nimport {AnimationUI} from './AnimationUI.js';\n\nexport class AnimationGroupPreviewUI {\n  #model: AnimationGroup;\n  element: HTMLDivElement;\n  readonly #removeButtonInternal: HTMLElement;\n  readonly #replayOverlayElement: HTMLElement;\n  readonly #svg: Element;\n  readonly #viewBoxHeight: number;\n\n  constructor(model: AnimationGroup) {\n    this.#model = model;\n    this.element = document.createElement('div');\n    this.element.classList.add('animation-buffer-preview');\n    this.element.createChild('div', 'animation-paused fill');\n    this.#removeButtonInternal = this.element.createChild('div', 'animation-remove-button');\n    this.#removeButtonInternal.textContent = '\\u2715';\n    this.#replayOverlayElement = this.element.createChild('div', 'animation-buffer-preview-animation');\n    this.#svg = UI.UIUtils.createSVGChild(this.element, 'svg');\n    this.#svg.setAttribute('width', '100%');\n    this.#svg.setAttribute('preserveAspectRatio', 'none');\n    this.#svg.setAttribute('height', '100%');\n    this.#viewBoxHeight = 32;\n    this.#svg.setAttribute('viewBox', '0 0 100 ' + this.#viewBoxHeight);\n    this.#svg.setAttribute('shape-rendering', 'crispEdges');\n    this.render();\n  }\n\n  private groupDuration(): number {\n    let duration = 0;\n    for (const anim of this.#model.animations()) {\n      const animDuration = anim.source().delay() + anim.source().duration();\n      if (animDuration > duration) {\n        duration = animDuration;\n      }\n    }\n    return duration;\n  }\n\n  removeButton(): Element {\n    return this.#removeButtonInternal;\n  }\n\n  replay(): void {\n    this.#replayOverlayElement.animate(\n        [\n          {offset: 0, width: '0%', opacity: 1},\n          {offset: 0.9, width: '100%', opacity: 1},\n          {offset: 1, width: '100%', opacity: 0},\n        ],\n        {duration: 200, easing: 'cubic-bezier(0, 0, 0.2, 1)'});\n  }\n\n  private render(): void {\n    this.#svg.removeChildren();\n    const maxToShow = 10;\n    const numberOfAnimations = Math.min(this.#model.animations().length, maxToShow);\n    const timeToPixelRatio = 100 / Math.max(this.groupDuration(), 750);\n    for (let i = 0; i < numberOfAnimations; i++) {\n      const effect = this.#model.animations()[i].source();\n      const line = UI.UIUtils.createSVGChild(this.#svg, 'line') as SVGLineElement;\n      line.setAttribute('x1', String(effect.delay() * timeToPixelRatio));\n      line.setAttribute('x2', String((effect.delay() + effect.duration()) * timeToPixelRatio));\n      const y = String(Math.floor(this.#viewBoxHeight / Math.max(6, numberOfAnimations) * i + 1));\n      line.setAttribute('y1', y);\n      line.setAttribute('y2', y);\n      line.style.stroke = AnimationUI.colorForAnimation(this.#model.animations()[i]);\n    }\n  }\n}\n"]}
{"version":3,"file":"AnimationModel.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationModel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nexport class AnimationModel extends SDK.SDKModel.SDKModel<EventTypes> {\n  readonly runtimeModel: SDK.RuntimeModel.RuntimeModel;\n  readonly agent: ProtocolProxyApi.AnimationApi;\n  #animationsById: Map<string, AnimationImpl>;\n  readonly animationGroups: Map<string, AnimationGroup>;\n  #pendingAnimations: Set<string>;\n  playbackRate: number;\n  readonly #screenshotCapture?: ScreenshotCapture;\n  #enabled?: boolean;\n\n  constructor(target: SDK.Target.Target) {\n    super(target);\n    this.runtimeModel = (target.model(SDK.RuntimeModel.RuntimeModel) as SDK.RuntimeModel.RuntimeModel);\n    this.agent = target.animationAgent();\n    target.registerAnimationDispatcher(new AnimationDispatcher(this));\n    this.#animationsById = new Map();\n    this.animationGroups = new Map();\n    this.#pendingAnimations = new Set();\n    this.playbackRate = 1;\n    const resourceTreeModel =\n        (target.model(SDK.ResourceTreeModel.ResourceTreeModel) as SDK.ResourceTreeModel.ResourceTreeModel);\n    resourceTreeModel.addEventListener(SDK.ResourceTreeModel.Events.MainFrameNavigated, this.reset, this);\n    const screenCaptureModel = target.model(SDK.ScreenCaptureModel.ScreenCaptureModel);\n    if (screenCaptureModel) {\n      this.#screenshotCapture = new ScreenshotCapture(this, screenCaptureModel);\n    }\n  }\n\n  private reset(): void {\n    this.#animationsById.clear();\n    this.animationGroups.clear();\n    this.#pendingAnimations.clear();\n    this.dispatchEventToListeners(Events.ModelReset);\n  }\n\n  animationCreated(id: string): void {\n    this.#pendingAnimations.add(id);\n  }\n\n  animationCanceled(id: string): void {\n    this.#pendingAnimations.delete(id);\n    this.flushPendingAnimationsIfNeeded();\n  }\n\n  animationStarted(payload: Protocol.Animation.Animation): void {\n    // We are not interested in animations without effect or target.\n    if (!payload.source || !payload.source.backendNodeId) {\n      return;\n    }\n\n    const animation = AnimationImpl.parsePayload(this, payload);\n    if (!animation) {\n      return;\n    }\n\n    // Ignore Web Animations custom effects & groups.\n    const keyframesRule = animation.source().keyframesRule();\n    if (animation.type() === 'WebAnimation' && keyframesRule && keyframesRule.keyframes().length === 0) {\n      this.#pendingAnimations.delete(animation.id());\n    } else {\n      this.#animationsById.set(animation.id(), animation);\n      this.#pendingAnimations.add(animation.id());\n    }\n\n    this.flushPendingAnimationsIfNeeded();\n  }\n\n  private flushPendingAnimationsIfNeeded(): void {\n    for (const id of this.#pendingAnimations) {\n      if (!this.#animationsById.get(id)) {\n        return;\n      }\n    }\n\n    while (this.#pendingAnimations.size) {\n      this.matchExistingGroups(this.createGroupFromPendingAnimations());\n    }\n  }\n\n  private matchExistingGroups(incomingGroup: AnimationGroup): boolean {\n    let matchedGroup: AnimationGroup|null = null;\n    for (const group of this.animationGroups.values()) {\n      if (group.matches(incomingGroup)) {\n        matchedGroup = group;\n        group.update(incomingGroup);\n        break;\n      }\n    }\n\n    if (!matchedGroup) {\n      this.animationGroups.set(incomingGroup.id(), incomingGroup);\n      if (this.#screenshotCapture) {\n        this.#screenshotCapture.captureScreenshots(incomingGroup.finiteDuration(), incomingGroup.screenshotsInternal);\n      }\n    }\n    this.dispatchEventToListeners(Events.AnimationGroupStarted, matchedGroup || incomingGroup);\n    return Boolean(matchedGroup);\n  }\n\n  private createGroupFromPendingAnimations(): AnimationGroup {\n    console.assert(this.#pendingAnimations.size > 0);\n    const firstAnimationId = this.#pendingAnimations.values().next().value;\n    this.#pendingAnimations.delete(firstAnimationId);\n\n    const firstAnimation = this.#animationsById.get(firstAnimationId);\n    if (!firstAnimation) {\n      throw new Error('Unable to locate first animation');\n    }\n\n    const groupedAnimations = [firstAnimation];\n    const groupStartTime = firstAnimation.startTime();\n    const remainingAnimations = new Set<string>();\n    for (const id of this.#pendingAnimations) {\n      const anim = (this.#animationsById.get(id) as AnimationImpl);\n      if (anim.startTime() === groupStartTime) {\n        groupedAnimations.push(anim);\n      } else {\n        remainingAnimations.add(id);\n      }\n    }\n    this.#pendingAnimations = remainingAnimations;\n    return new AnimationGroup(this, firstAnimationId, groupedAnimations);\n  }\n\n  setPlaybackRate(playbackRate: number): void {\n    this.playbackRate = playbackRate;\n    void this.agent.invoke_setPlaybackRate({playbackRate});\n  }\n\n  releaseAnimations(animations: string[]): void {\n    void this.agent.invoke_releaseAnimations({animations});\n  }\n\n  async suspendModel(): Promise<void> {\n    this.reset();\n    await this.agent.invoke_disable();\n  }\n\n  async resumeModel(): Promise<void> {\n    if (!this.#enabled) {\n      return;\n    }\n    await this.agent.invoke_enable();\n  }\n\n  async ensureEnabled(): Promise<void> {\n    if (this.#enabled) {\n      return;\n    }\n    await this.agent.invoke_enable();\n    this.#enabled = true;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  AnimationGroupStarted = 'AnimationGroupStarted',\n  ModelReset = 'ModelReset',\n}\n\nexport type EventTypes = {\n  [Events.AnimationGroupStarted]: AnimationGroup,\n  [Events.ModelReset]: void,\n};\n\nexport class AnimationImpl {\n  readonly #animationModel: AnimationModel;\n  readonly #payloadInternal: Protocol.Animation.Animation;\n  #sourceInternal: AnimationEffect;\n  #playStateInternal?: string;\n  constructor(animationModel: AnimationModel, payload: Protocol.Animation.Animation) {\n    this.#animationModel = animationModel;\n    this.#payloadInternal = payload;\n    this.#sourceInternal =\n        new AnimationEffect(animationModel, (this.#payloadInternal.source as Protocol.Animation.AnimationEffect));\n  }\n\n  static parsePayload(animationModel: AnimationModel, payload: Protocol.Animation.Animation): AnimationImpl {\n    return new AnimationImpl(animationModel, payload);\n  }\n\n  payload(): Protocol.Animation.Animation {\n    return this.#payloadInternal;\n  }\n\n  id(): string {\n    return this.#payloadInternal.id;\n  }\n\n  name(): string {\n    return this.#payloadInternal.name;\n  }\n\n  paused(): boolean {\n    return this.#payloadInternal.pausedState;\n  }\n\n  playState(): string {\n    return this.#playStateInternal || this.#payloadInternal.playState;\n  }\n\n  setPlayState(playState: string): void {\n    this.#playStateInternal = playState;\n  }\n\n  playbackRate(): number {\n    return this.#payloadInternal.playbackRate;\n  }\n\n  startTime(): number {\n    return this.#payloadInternal.startTime;\n  }\n\n  endTime(): number {\n    if (!this.source().iterations) {\n      return Infinity;\n    }\n    return this.startTime() + this.source().delay() + this.source().duration() * this.source().iterations() +\n        this.source().endDelay();\n  }\n\n  finiteDuration(): number {\n    const iterations = Math.min(this.source().iterations(), 3);\n    return this.source().delay() + this.source().duration() * iterations;\n  }\n\n  currentTime(): number {\n    return this.#payloadInternal.currentTime;\n  }\n\n  source(): AnimationEffect {\n    return this.#sourceInternal;\n  }\n\n  type(): Protocol.Animation.AnimationType {\n    return this.#payloadInternal.type;\n  }\n\n  overlaps(animation: AnimationImpl): boolean {\n    // Infinite animations\n    if (!this.source().iterations() || !animation.source().iterations()) {\n      return true;\n    }\n\n    const firstAnimation = this.startTime() < animation.startTime() ? this : animation;\n    const secondAnimation = firstAnimation === this ? animation : this;\n    return firstAnimation.endTime() >= secondAnimation.startTime();\n  }\n\n  setTiming(duration: number, delay: number): void {\n    void this.#sourceInternal.node().then(node => {\n      if (!node) {\n        throw new Error('Unable to find node');\n      }\n      this.updateNodeStyle(duration, delay, node);\n    });\n    this.#sourceInternal.durationInternal = duration;\n    this.#sourceInternal.delayInternal = delay;\n    void this.#animationModel.agent.invoke_setTiming({animationId: this.id(), duration, delay});\n  }\n\n  private updateNodeStyle(duration: number, delay: number, node: SDK.DOMModel.DOMNode): void {\n    let animationPrefix;\n    if (this.type() === Protocol.Animation.AnimationType.CSSTransition) {\n      animationPrefix = 'transition-';\n    } else if (this.type() === Protocol.Animation.AnimationType.CSSAnimation) {\n      animationPrefix = 'animation-';\n    } else {\n      return;\n    }\n\n    if (!node.id) {\n      throw new Error('Node has no id');\n    }\n\n    const cssModel = node.domModel().cssModel();\n    cssModel.setEffectivePropertyValueForNode(node.id, animationPrefix + 'duration', duration + 'ms');\n    cssModel.setEffectivePropertyValueForNode(node.id, animationPrefix + 'delay', delay + 'ms');\n  }\n\n  async remoteObjectPromise(): Promise<SDK.RemoteObject.RemoteObject|null> {\n    const payload = await this.#animationModel.agent.invoke_resolveAnimation({animationId: this.id()});\n    if (!payload) {\n      return null;\n    }\n\n    return this.#animationModel.runtimeModel.createRemoteObject(payload.remoteObject);\n  }\n\n  cssId(): string {\n    return this.#payloadInternal.cssId || '';\n  }\n}\n\nexport class AnimationEffect {\n  #animationModel: AnimationModel;\n  readonly #payload: Protocol.Animation.AnimationEffect;\n  readonly #keyframesRuleInternal: KeyframesRule|undefined;\n  delayInternal: number;\n  durationInternal: number;\n  #deferredNodeInternal?: SDK.DOMModel.DeferredDOMNode;\n  constructor(animationModel: AnimationModel, payload: Protocol.Animation.AnimationEffect) {\n    this.#animationModel = animationModel;\n    this.#payload = payload;\n    if (payload.keyframesRule) {\n      this.#keyframesRuleInternal = new KeyframesRule(payload.keyframesRule);\n    }\n    this.delayInternal = this.#payload.delay;\n    this.durationInternal = this.#payload.duration;\n  }\n\n  delay(): number {\n    return this.delayInternal;\n  }\n\n  endDelay(): number {\n    return this.#payload.endDelay;\n  }\n\n  iterationStart(): number {\n    return this.#payload.iterationStart;\n  }\n\n  iterations(): number {\n    // Animations with zero duration, zero delays and infinite iterations can't be shown.\n    if (!this.delay() && !this.endDelay() && !this.duration()) {\n      return 0;\n    }\n    return this.#payload.iterations || Infinity;\n  }\n\n  duration(): number {\n    return this.durationInternal;\n  }\n\n  direction(): string {\n    return this.#payload.direction;\n  }\n\n  fill(): string {\n    return this.#payload.fill;\n  }\n\n  node(): Promise<SDK.DOMModel.DOMNode|null> {\n    if (!this.#deferredNodeInternal) {\n      this.#deferredNodeInternal =\n          new SDK.DOMModel.DeferredDOMNode(this.#animationModel.target(), this.backendNodeId());\n    }\n    return this.#deferredNodeInternal.resolvePromise();\n  }\n\n  deferredNode(): SDK.DOMModel.DeferredDOMNode {\n    return new SDK.DOMModel.DeferredDOMNode(this.#animationModel.target(), this.backendNodeId());\n  }\n\n  backendNodeId(): Protocol.DOM.BackendNodeId {\n    return this.#payload.backendNodeId as Protocol.DOM.BackendNodeId;\n  }\n\n  keyframesRule(): KeyframesRule|null {\n    return this.#keyframesRuleInternal || null;\n  }\n\n  easing(): string {\n    return this.#payload.easing;\n  }\n}\n\nexport class KeyframesRule {\n  readonly #payload: Protocol.Animation.KeyframesRule;\n  #keyframesInternal: KeyframeStyle[];\n  constructor(payload: Protocol.Animation.KeyframesRule) {\n    this.#payload = payload;\n    this.#keyframesInternal = this.#payload.keyframes.map(function(keyframeStyle) {\n      return new KeyframeStyle(keyframeStyle);\n    });\n  }\n\n  private setKeyframesPayload(payload: Protocol.Animation.KeyframeStyle[]): void {\n    this.#keyframesInternal = payload.map(function(keyframeStyle) {\n      return new KeyframeStyle(keyframeStyle);\n    });\n  }\n\n  name(): string|undefined {\n    return this.#payload.name;\n  }\n\n  keyframes(): KeyframeStyle[] {\n    return this.#keyframesInternal;\n  }\n}\n\nexport class KeyframeStyle {\n  readonly #payload: Protocol.Animation.KeyframeStyle;\n  #offsetInternal: string;\n  constructor(payload: Protocol.Animation.KeyframeStyle) {\n    this.#payload = payload;\n    this.#offsetInternal = this.#payload.offset;\n  }\n\n  offset(): string {\n    return this.#offsetInternal;\n  }\n\n  setOffset(offset: number): void {\n    this.#offsetInternal = offset * 100 + '%';\n  }\n\n  offsetAsNumber(): number {\n    return parseFloat(this.#offsetInternal) / 100;\n  }\n\n  easing(): string {\n    return this.#payload.easing;\n  }\n}\n\nexport class AnimationGroup {\n  readonly #animationModel: AnimationModel;\n  readonly #idInternal: string;\n  #animationsInternal: AnimationImpl[];\n  #pausedInternal: boolean;\n  screenshotsInternal: string[];\n  readonly #screenshotImages: HTMLImageElement[];\n  constructor(animationModel: AnimationModel, id: string, animations: AnimationImpl[]) {\n    this.#animationModel = animationModel;\n    this.#idInternal = id;\n    this.#animationsInternal = animations;\n    this.#pausedInternal = false;\n    this.screenshotsInternal = [];\n\n    this.#screenshotImages = [];\n  }\n\n  id(): string {\n    return this.#idInternal;\n  }\n\n  animations(): AnimationImpl[] {\n    return this.#animationsInternal;\n  }\n\n  release(): void {\n    this.#animationModel.animationGroups.delete(this.id());\n    this.#animationModel.releaseAnimations(this.animationIds());\n  }\n\n  private animationIds(): string[] {\n    function extractId(animation: AnimationImpl): string {\n      return animation.id();\n    }\n\n    return this.#animationsInternal.map(extractId);\n  }\n\n  startTime(): number {\n    return this.#animationsInternal[0].startTime();\n  }\n\n  finiteDuration(): number {\n    let maxDuration = 0;\n    for (let i = 0; i < this.#animationsInternal.length; ++i) {\n      maxDuration = Math.max(maxDuration, this.#animationsInternal[i].finiteDuration());\n    }\n    return maxDuration;\n  }\n\n  seekTo(currentTime: number): void {\n    void this.#animationModel.agent.invoke_seekAnimations({animations: this.animationIds(), currentTime});\n  }\n\n  paused(): boolean {\n    return this.#pausedInternal;\n  }\n\n  togglePause(paused: boolean): void {\n    if (paused === this.#pausedInternal) {\n      return;\n    }\n    this.#pausedInternal = paused;\n    void this.#animationModel.agent.invoke_setPaused({animations: this.animationIds(), paused});\n  }\n\n  currentTimePromise(): Promise<number> {\n    let longestAnim: AnimationImpl|null = null;\n    for (const anim of this.#animationsInternal) {\n      if (!longestAnim || anim.endTime() > longestAnim.endTime()) {\n        longestAnim = anim;\n      }\n    }\n    if (!longestAnim) {\n      throw new Error('No longest animation found');\n    }\n\n    return this.#animationModel.agent.invoke_getCurrentTime({id: longestAnim.id()})\n        .then(({currentTime}) => currentTime || 0);\n  }\n\n  matches(group: AnimationGroup): boolean {\n    function extractId(anim: AnimationImpl): string {\n      if (anim.type() === Protocol.Animation.AnimationType.WebAnimation) {\n        return anim.type() + anim.id();\n      }\n      return anim.cssId();\n    }\n\n    if (this.#animationsInternal.length !== group.#animationsInternal.length) {\n      return false;\n    }\n    const left = this.#animationsInternal.map(extractId).sort();\n    const right = group.#animationsInternal.map(extractId).sort();\n    for (let i = 0; i < left.length; i++) {\n      if (left[i] !== right[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  update(group: AnimationGroup): void {\n    this.#animationModel.releaseAnimations(this.animationIds());\n    this.#animationsInternal = group.#animationsInternal;\n  }\n\n  screenshots(): HTMLImageElement[] {\n    for (let i = 0; i < this.screenshotsInternal.length; ++i) {\n      const image = new Image();\n      image.src = 'data:image/jpeg;base64,' + this.screenshotsInternal[i];\n      this.#screenshotImages.push(image);\n    }\n    this.screenshotsInternal = [];\n    return this.#screenshotImages;\n  }\n}\n\nexport class AnimationDispatcher implements ProtocolProxyApi.AnimationDispatcher {\n  readonly #animationModel: AnimationModel;\n  constructor(animationModel: AnimationModel) {\n    this.#animationModel = animationModel;\n  }\n\n  animationCreated({id}: Protocol.Animation.AnimationCreatedEvent): void {\n    this.#animationModel.animationCreated(id);\n  }\n\n  animationCanceled({id}: Protocol.Animation.AnimationCanceledEvent): void {\n    this.#animationModel.animationCanceled(id);\n  }\n\n  animationStarted({animation}: Protocol.Animation.AnimationStartedEvent): void {\n    this.#animationModel.animationStarted(animation);\n  }\n}\n\nexport class ScreenshotCapture {\n  #requests: Request[];\n  readonly #screenCaptureModel: SDK.ScreenCaptureModel.ScreenCaptureModel;\n  readonly #animationModel: AnimationModel;\n  #stopTimer?: number;\n  #endTime?: number;\n  #capturing?: boolean;\n  constructor(animationModel: AnimationModel, screenCaptureModel: SDK.ScreenCaptureModel.ScreenCaptureModel) {\n    this.#requests = [];\n    this.#screenCaptureModel = screenCaptureModel;\n    this.#animationModel = animationModel;\n    this.#animationModel.addEventListener(Events.ModelReset, this.stopScreencast, this);\n  }\n\n  captureScreenshots(duration: number, screenshots: string[]): void {\n    const screencastDuration = Math.min(duration / this.#animationModel.playbackRate, 3000);\n    const endTime = screencastDuration + window.performance.now();\n    this.#requests.push({endTime: endTime, screenshots: screenshots});\n\n    if (!this.#endTime || endTime > this.#endTime) {\n      clearTimeout(this.#stopTimer);\n      this.#stopTimer = window.setTimeout(this.stopScreencast.bind(this), screencastDuration);\n      this.#endTime = endTime;\n    }\n\n    if (this.#capturing) {\n      return;\n    }\n    this.#capturing = true;\n    this.#screenCaptureModel.startScreencast(\n        Protocol.Page.StartScreencastRequestFormat.Jpeg, 80, undefined, 300, 2, this.screencastFrame.bind(this),\n        _visible => {});\n  }\n\n  private screencastFrame(base64Data: string, _metadata: Protocol.Page.ScreencastFrameMetadata): void {\n    function isAnimating(request: Request): boolean {\n      return request.endTime >= now;\n    }\n\n    if (!this.#capturing) {\n      return;\n    }\n\n    const now = window.performance.now();\n    this.#requests = this.#requests.filter(isAnimating);\n    for (const request of this.#requests) {\n      request.screenshots.push(base64Data);\n    }\n  }\n\n  private stopScreencast(): void {\n    if (!this.#capturing) {\n      return;\n    }\n\n    this.#stopTimer = undefined;\n    this.#endTime = undefined;\n    this.#requests = [];\n    this.#capturing = false;\n    this.#screenCaptureModel.stopScreencast();\n  }\n}\n\nSDK.SDKModel.SDKModel.register(AnimationModel, {capabilities: SDK.Target.Capability.DOM, autostart: false});\nexport interface Request {\n  endTime: number;\n  screenshots: string[];\n}\n"]}
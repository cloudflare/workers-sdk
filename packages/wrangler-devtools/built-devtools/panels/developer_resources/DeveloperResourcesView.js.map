{"version":3,"file":"DeveloperResourcesView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/developer_resources/DeveloperResourcesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport {DeveloperResourcesListView} from './DeveloperResourcesListView.js';\nimport developerResourcesViewStyles from './developerResourcesView.css.js';\n\nconst UIStrings = {\n  /**\n  *@description Placeholder for a search field in a toolbar\n  */\n  enterTextToSearchTheUrlAndError: 'Enter text to search the URL and Error columns',\n  /**\n  * @description Tooltip for a checkbox in the toolbar of the developer resources view. The\n  * inspected target is the webpage that DevTools is debugging/inspecting/attached to.\n  */\n  loadHttpsDeveloperResources: 'Load `HTTP(S)` developer resources through the inspected target',\n  /**\n  * @description Text for a checkbox in the toolbar of the developer resources view. The target is\n  * the webpage that DevTools is debugging/inspecting/attached to. This setting makes it so\n  * developer resources are requested from the webpage itself, and not from the DevTools\n  * application.\n  */\n  enableLoadingThroughTarget: 'Enable loading through target',\n  /**\n   *@description Text for resources load status\n   *@example {1} PH1\n   *@example {1} PH2\n   */\n  resourcesCurrentlyLoading: '{PH1} resources, {PH2} currently loading',\n  /**\n   * @description Status text that appears to tell the developer how many resources were loaded in\n   * total. Resources are files related to the webpage.\n   */\n  resources: '{n, plural, =1 {# resource} other {# resources}}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/developer_resources/DeveloperResourcesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nlet developerResourcesViewInstance: DeveloperResourcesView;\n\nexport class DeveloperResourcesView extends UI.Widget.VBox {\n  private textFilterRegExp: RegExp|null;\n  private readonly filterInput: UI.Toolbar.ToolbarInput;\n  private readonly coverageResultsElement: HTMLElement;\n  private listView: DeveloperResourcesListView;\n  private readonly statusToolbarElement: HTMLElement;\n  private statusMessageElement: HTMLElement;\n  private readonly throttler: Common.Throttler.Throttler;\n  private readonly loader: SDK.PageResourceLoader.PageResourceLoader;\n  private constructor() {\n    super(true);\n\n    const toolbarContainer = this.contentElement.createChild('div', 'developer-resource-view-toolbar-container');\n    const toolbar = new UI.Toolbar.Toolbar('developer-resource-view-toolbar', toolbarContainer);\n\n    this.textFilterRegExp = null;\n    const accessiblePlaceholder = '';  // Indicates that ToobarInput should use the placeholder as ARIA label.\n    this.filterInput =\n        new UI.Toolbar.ToolbarInput(i18nString(UIStrings.enterTextToSearchTheUrlAndError), accessiblePlaceholder, 1);\n    this.filterInput.addEventListener(UI.Toolbar.ToolbarInput.Event.TextChanged, this.onFilterChanged, this);\n    toolbar.appendToolbarItem(this.filterInput);\n\n    const loadThroughTarget = SDK.PageResourceLoader.getLoadThroughTargetSetting();\n    const loadThroughTargetCheckbox = new UI.Toolbar.ToolbarSettingCheckbox(\n        loadThroughTarget, i18nString(UIStrings.loadHttpsDeveloperResources),\n        i18nString(UIStrings.enableLoadingThroughTarget));\n    toolbar.appendToolbarItem(loadThroughTargetCheckbox);\n\n    this.coverageResultsElement = this.contentElement.createChild('div', 'developer-resource-view-results');\n    this.listView = new DeveloperResourcesListView(this.isVisible.bind(this));\n    this.listView.show(this.coverageResultsElement);\n    this.statusToolbarElement = this.contentElement.createChild('div', 'developer-resource-view-toolbar-summary');\n    this.statusMessageElement = this.statusToolbarElement.createChild('div', 'developer-resource-view-message');\n\n    this.throttler = new Common.Throttler.Throttler(100);\n    this.loader = SDK.PageResourceLoader.PageResourceLoader.instance();\n    this.loader.addEventListener(SDK.PageResourceLoader.Events.Update, this.onUpdate, this);\n    this.onUpdate();\n  }\n\n  static instance(): DeveloperResourcesView {\n    if (!developerResourcesViewInstance) {\n      developerResourcesViewInstance = new DeveloperResourcesView();\n    }\n    return developerResourcesViewInstance;\n  }\n\n  private onUpdate(): void {\n    void this.throttler.schedule(this.update.bind(this));\n  }\n\n  private async update(): Promise<void> {\n    this.listView.reset();\n    this.listView.update(this.loader.getResourcesLoaded().values());\n    this.updateStats();\n  }\n\n  private updateStats(): void {\n    const {loading, resources} = this.loader.getNumberOfResources();\n    if (loading > 0) {\n      this.statusMessageElement.textContent =\n          i18nString(UIStrings.resourcesCurrentlyLoading, {PH1: resources, PH2: loading});\n    } else {\n      this.statusMessageElement.textContent = i18nString(UIStrings.resources, {n: resources});\n    }\n  }\n\n  private isVisible(item: SDK.PageResourceLoader.PageResource): boolean {\n    return !this.textFilterRegExp || this.textFilterRegExp.test(item.url) ||\n        this.textFilterRegExp.test(item.errorMessage || '');\n  }\n\n  /**\n   *\n   */\n  private onFilterChanged(): void {\n    if (!this.listView) {\n      return;\n    }\n\n    const text = this.filterInput.value();\n    this.textFilterRegExp = text ? Platform.StringUtilities.createPlainTextSearchRegex(text, 'i') : null;\n    this.listView.updateFilterAndHighlight(this.textFilterRegExp);\n    this.updateStats();\n  }\n  wasShown(): void {\n    super.wasShown();\n    this.registerCSSFiles([developerResourcesViewStyles]);\n  }\n}\n"]}